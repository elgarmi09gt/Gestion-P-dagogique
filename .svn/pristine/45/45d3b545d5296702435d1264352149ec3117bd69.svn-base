package view.beans.maquette;

import java.io.IOException;
import java.io.InputStream;

import java.text.DateFormat;

import java.text.ParseException;
import java.text.SimpleDateFormat;

import java.util.ArrayList;
import java.util.Map;

import javax.faces.application.FacesMessage;
import javax.faces.application.ViewHandler;
import javax.faces.component.UIViewRoot;
import javax.faces.context.FacesContext;
import javax.faces.event.ActionEvent;
import javax.faces.event.ValueChangeEvent;

import oracle.adf.model.BindingContext;
import oracle.adf.model.binding.DCIteratorBinding;
import oracle.adf.share.ADFContext;
import oracle.adf.view.rich.component.rich.RichPopup;
import oracle.adf.view.rich.component.rich.data.RichTable;
import oracle.adf.view.rich.component.rich.layout.RichPanelGroupLayout;
import oracle.adf.view.rich.component.rich.layout.RichPanelHeader;
import oracle.adf.view.rich.context.AdfFacesContext;
import oracle.adf.view.rich.event.DialogEvent;
import oracle.adf.view.rich.event.DialogEvent.Outcome;
import oracle.adf.view.rich.render.ClientEvent;

import oracle.binding.AttributeBinding;
import oracle.binding.BindingContainer;
import oracle.binding.OperationBinding;

import oracle.jbo.Key;
import oracle.jbo.Row;

import oracle.jbo.RowSetIterator;

import oracle.jbo.uicli.binding.JUCtrlHierBinding;
import oracle.jbo.uicli.binding.JUCtrlHierNodeBinding;

import org.apache.myfaces.trinidad.event.SelectionEvent;
import org.apache.myfaces.trinidad.model.CollectionModel;
import org.apache.myfaces.trinidad.model.UploadedFile;
import org.apache.poi.ss.usermodel.Cell;
import org.apache.poi.xssf.usermodel.XSSFSheet;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;

import view.beans.jsfutils.JSFUtils;

public class MaquetteBean {
    final String OLD_CURR_KEY_VIEWSCOPE_ATTR = "__oldCurrentRowKey__";
    private RichTable ueTable;
    private RichTable ecTable;
    private RichTable maquetteTable;
    private RichTable filiereUeSemestreTable;
    private RichTable filiereUeSemestreEcTable;
    private RichPopup popupNewUe;
    private RichPopup popupEditUe;
    private RichPopup popupNewEc;
    private RichPopup popupEditEc;
    private RichPopup popupNewMaquette;
    private RichPopup popupEditMaquette;
    private RichPopup popupNewFiliereUeSemestre;
    private RichPopup popupEditFiliereUeSemestre;
    private RichPopup popupNewFiliereUeSemestreEc;
    private RichPopup popupEditFiliereUeSemestreEc;
    private RichTable nivFormTable;
    private RichPopup popupNewNivForm;
    private RichPopup popupEditNivForm;
    private RichPopup popupDeleteNivForm;
    private UploadedFile uploadedFile;
    private UploadedFile uploadEtuFile;
    Map sessionScope = ADFContext.getCurrent().getSessionScope();
    private Integer semestre = Integer.parseInt(sessionScope.get("id_smstre").toString());
    private Integer utilisateur = Integer.parseInt(sessionScope.get("id_user").toString());
    private Integer annee = Integer.parseInt(sessionScope.get("id_annee").toString());
    private Integer parcours = Integer.parseInt(sessionScope.get("id_niv_form_parcours").toString());
    private RichTable modaliteCntrlTable;
    private RichPopup popupEditMdCntrl;
    private RichPopup popupDeleteMdCntrl;
    private RichPopup popupNewParcMaqAnnee;
    private RichTable parcrsMaqAnTable;
    private RichPopup popupEditParcMaqAnnee;
    private RichPopup popupMaquetteUsed;
    private RichPopup popupImport;
    private RichPanelGroupLayout maqpage;
    private RichPopup popupImportEtu;
    private RichPanelGroupLayout panimport;
    private RichPopup popupFilUeExist;
    private RichPopup popupFilEcExist;
    private RichPopup popupNivFormMaqAnMaquetteExist;
    private RichPopup popupParcMaqAnMaquetteExist;
    private RichPopup popupFilUeMaquetteExist;
    private RichPopup popupValideFilUeExist;
    private RichPopup popupResFilUeExist;
    private RichPopup popupInsPedFilUeExist;
    private RichPopup popupFilEcFilUeExist;
    private RichPopup popupValideFilEcExist;
    private RichPopup popupResFilEcExist;
    private RichPopup popupModeCntrlFilEcExist;
    private RichPopup popupAccessFilUeExist;
    private RichPopup popupAccessFilEcExist;
    private RichPopup popupNoParcours;
    private RichTable maqPrcrsTable;
    private RichPopup popupNewNivFormMaqAnn;
    private RichPopup popupNivFormMaqAnnExist;
    private RichPanelHeader maqNivPan;


    public MaquetteBean() {
    }

    public void setUeTable(RichTable ueTable) {
        this.ueTable = ueTable;
    }

    public RichTable getUeTable() {
        return ueTable;
    }

    public void setEcTable(RichTable ecTable) {
        this.ecTable = ecTable;
    }

    public RichTable getEcTable() {
        return ecTable;
    }

    public void setMaquetteTable(RichTable maquetteTable) {
        this.maquetteTable = maquetteTable;
    }

    public RichTable getMaquetteTable() {
        return maquetteTable;
    }

    public void setFiliereUeSemestreTable(RichTable filiereUeSemestreTable) {
        this.filiereUeSemestreTable = filiereUeSemestreTable;
    }

    public RichTable getFiliereUeSemestreTable() {
        return filiereUeSemestreTable;
    }

    public void setFiliereUeSemestreEcTable(RichTable filiereUeSemestreEcTable) {
        this.filiereUeSemestreEcTable = filiereUeSemestreEcTable;
    }

    public RichTable getFiliereUeSemestreEcTable() {
        return filiereUeSemestreEcTable;
    }

    public void setPopupNewUe(RichPopup popupNewUe) {
        this.popupNewUe = popupNewUe;
    }

    public RichPopup getPopupNewUe() {
        return popupNewUe;
    }

    public void setPopupEditUe(RichPopup popupEditUe) {
        this.popupEditUe = popupEditUe;
    }

    public RichPopup getPopupEditUe() {
        return popupEditUe;
    }

    public void setPopupNewEc(RichPopup popupNewEc) {
        this.popupNewEc = popupNewEc;
    }

    public RichPopup getPopupNewEc() {
        return popupNewEc;
    }

    public void setPopupEditEc(RichPopup popupEditEc) {
        this.popupEditEc = popupEditEc;
    }

    public RichPopup getPopupEditEc() {
        return popupEditEc;
    }

    public void setPopupNewMaquette(RichPopup popupNewMaquette) {
        this.popupNewMaquette = popupNewMaquette;
    }

    public RichPopup getPopupNewMaquette() {
        return popupNewMaquette;
    }

    public void setPopupEditMaquette(RichPopup popupEditMaquette) {
        this.popupEditMaquette = popupEditMaquette;
    }

    public RichPopup getPopupEditMaquette() {
        return popupEditMaquette;
    }

    public void setPopupNewFiliereUeSemestre(RichPopup popupNewFiliereUeSemestre) {
        this.popupNewFiliereUeSemestre = popupNewFiliereUeSemestre;
    }

    public RichPopup getPopupNewFiliereUeSemestre() {
        return popupNewFiliereUeSemestre;
    }

    public void setPopupEditFiliereUeSemestre(RichPopup popupEditFiliereUeSemestre) {
        this.popupEditFiliereUeSemestre = popupEditFiliereUeSemestre;
    }

    public RichPopup getPopupEditFiliereUeSemestre() {
        return popupEditFiliereUeSemestre;
    }

    public void setPopupNewFiliereUeSemestreEc(RichPopup popupNewFiliereUeSemestreEc) {
        this.popupNewFiliereUeSemestreEc = popupNewFiliereUeSemestreEc;
    }

    public RichPopup getPopupNewFiliereUeSemestreEc() {
        return popupNewFiliereUeSemestreEc;
    }

    public void setPopupEditFiliereUeSemestreEc(RichPopup popupEditFiliereUeSemestreEc) {
        this.popupEditFiliereUeSemestreEc = popupEditFiliereUeSemestreEc;
    }

    public RichPopup getPopupEditFiliereUeSemestreEc() {
        return popupEditFiliereUeSemestreEc;
    }

    public BindingContainer getBindings() {
        return BindingContext.getCurrent().getCurrentBindingsEntry();
    }

    public void OnNewUeClicked(ActionEvent actionEvent) {
        // Add event code here...
        BindingContainer bindings = getBindings();
        //UtiCree
        AttributeBinding uticre = (AttributeBinding) getBindings().getControlBinding("UtiCree");
        DCIteratorBinding dciter = (DCIteratorBinding) bindings.get("UesIterator");
        Row oldCcurrentRow = dciter.getCurrentRow();
        if (oldCcurrentRow != null) {
            ADFContext adfCtx = ADFContext.getCurrent();
            adfCtx.getViewScope().put(OLD_CURR_KEY_VIEWSCOPE_ATTR, oldCcurrentRow.getKey().toStringFormat(true));
        }
        //perform row create
        OperationBinding operationBinding = bindings.getOperationBinding("CreateUe");
        operationBinding.execute();
        if (!operationBinding.getErrors().isEmpty()) {
            return;
        }
        uticre.setInputValue(getUtilisateur());
        RichPopup popup = this.getPopupNewUe();
        RichPopup.PopupHints hints = new RichPopup.PopupHints();
        //empty hints renders dialog in center of screen
        popup.show(hints);
        return;
    }

    public void OnEditUeClicked(ActionEvent actionEvent) {
        // Add event code here...
        AttributeBinding utimodif = (AttributeBinding) getBindings().getControlBinding("UtiModifie");
        utimodif.setInputValue(getUtilisateur());
        RichPopup popup = this.getPopupEditUe();
        RichPopup.PopupHints hints = new RichPopup.PopupHints();
        //empty hints renders dialog in center of screen
        popup.show(hints);
    }

    @SuppressWarnings("unchecked")
    public void OnDeleteUeAction(DialogEvent dialogEvent) {
        // Add event code here...
        if (dialogEvent.getOutcome().equals(Outcome.yes)) {
            BindingContainer bindings = getBindings();
            AttributeBinding ueIdBinding = (AttributeBinding) bindings.getControlBinding("IdUe1");
            Integer ue_id = (Integer.parseInt(ueIdBinding.getInputValue().toString()));
            OperationBinding isFilUeExist = bindings.getOperationBinding("IsFilUeExist");
            isFilUeExist.getParamsMap().put("ue_id", ue_id);
            isFilUeExist.execute();
            DCIteratorBinding iterFilUe = (DCIteratorBinding) bindings.get("IsFilUeExistIterator");
            Row crntfue = iterFilUe.getCurrentRow();
            if (crntfue == null) {
                OnDeleteUeClicked();
            } else {
                //popup uti exist
                RichPopup popup = this.getPopupFilUeExist();
                RichPopup.PopupHints hints = new RichPopup.PopupHints();
                //empty hints renders dialog in center of screen
                popup.show(hints);
            }
        }
    }

    public void OnNewEcClicked(ActionEvent actionEvent) {
        // Add event code here...
        BindingContainer bindings = getBindings();
        AttributeBinding uticre = (AttributeBinding) bindings.getControlBinding("UtiCree1");
        DCIteratorBinding dciter = (DCIteratorBinding) bindings.get("EcsIterator");
        Row oldCcurrentRow = dciter.getCurrentRow();
        if (oldCcurrentRow != null) {
            ADFContext adfCtx = ADFContext.getCurrent();
            adfCtx.getViewScope().put(OLD_CURR_KEY_VIEWSCOPE_ATTR, oldCcurrentRow.getKey().toStringFormat(true));
        }
        //perform row create
        OperationBinding operationBinding = bindings.getOperationBinding("CreateEc");
        operationBinding.execute();
        if (!operationBinding.getErrors().isEmpty()) {
            return;
        }
        uticre.setInputValue(getUtilisateur());
        RichPopup popup = this.getPopupNewEc();
        RichPopup.PopupHints hints = new RichPopup.PopupHints();
        //empty hints renders dialog in center of screen
        popup.show(hints);
        return;
    }

    public void OnEditEcClicked(ActionEvent actionEvent) {
        // Add event code here...
        AttributeBinding utimodif = (AttributeBinding) getBindings().getControlBinding("UtiModifie1");
        utimodif.setInputValue(getUtilisateur());
        RichPopup popup = this.getPopupEditEc();
        RichPopup.PopupHints hints = new RichPopup.PopupHints();
        //empty hints renders dialog in center of screen
        popup.show(hints);
    }

    @SuppressWarnings("unchecked")
    public void OnDeleteEcClicked(DialogEvent dialogEvent) {
        // Add event code here...
        if (dialogEvent.getOutcome().equals(Outcome.yes)) {
            BindingContainer bindings = getBindings();
            AttributeBinding ecIdBinding = (AttributeBinding) bindings.getControlBinding("IdEc1");
            Integer ec_id = (Integer.parseInt(ecIdBinding.getInputValue().toString()));
            OperationBinding isFilEcExist = bindings.getOperationBinding("IsFilEcExist");
            isFilEcExist.getParamsMap().put("ec_id", ec_id);
            isFilEcExist.execute();
            DCIteratorBinding iterFilEc = (DCIteratorBinding) bindings.get("IsFilEcExistIterator");
            Row crntfec = iterFilEc.getCurrentRow();
            if (crntfec == null) {
                OnDeleteEcClick();
            } else {
                //popup uti exist
                RichPopup popup = this.getPopupFilEcExist();
                RichPopup.PopupHints hints = new RichPopup.PopupHints();
                //empty hints renders dialog in center of screen
                popup.show(hints);
            }
        }
    }

    public void OnNewMaquetteClicked(ActionEvent actionEvent) {
        // Add event code here...
        BindingContainer bindings = getBindings();
        AttributeBinding uticre = (AttributeBinding) bindings.getControlBinding("UtiCree2");
        DCIteratorBinding dciter = (DCIteratorBinding) bindings.get("MaquettesIterator");
        Row oldCcurrentRow = dciter.getCurrentRow();
        if (oldCcurrentRow != null) {
            ADFContext adfCtx = ADFContext.getCurrent();
            adfCtx.getViewScope().put(OLD_CURR_KEY_VIEWSCOPE_ATTR, oldCcurrentRow.getKey().toStringFormat(true));
        }
        //perform row create
        OperationBinding operationBinding = bindings.getOperationBinding("CreateMaquette");
        Object result = operationBinding.execute();
        if (!operationBinding.getErrors().isEmpty()) {
            return;
        }
        uticre.setInputValue(getUtilisateur());
        RichPopup popup = this.getPopupNewMaquette();
        RichPopup.PopupHints hints = new RichPopup.PopupHints();
        //empty hints renders dialog in center of screen
        popup.show(hints);
        return;
    }

    public void OnEditMaquetteClicked(ActionEvent actionEvent) {
        // Add event code here...
        AttributeBinding utimodif = (AttributeBinding) getBindings().getControlBinding("UtiModifie2");
        utimodif.setInputValue(getUtilisateur());
        RichPopup popup = this.getPopupEditMaquette();
        RichPopup.PopupHints hints = new RichPopup.PopupHints();
        //empty hints renders dialog in center of screen
        popup.show(hints);
    }


    @SuppressWarnings("unchecked")
    public void OnDeleteMaquetteAction(DialogEvent dialogEvent) {
        // Add event code here...
        if (dialogEvent.getOutcome().equals(Outcome.yes)) {
            BindingContainer bindings = getBindings();
            AttributeBinding mqIdBinding = (AttributeBinding) bindings.getControlBinding("IdMaquette1");
            Integer mq_id = (Integer.parseInt(mqIdBinding.getInputValue().toString()));
            OperationBinding isFilUeMaquetteExist = bindings.getOperationBinding("IsFilUeMaquetteExist");
            isFilUeMaquetteExist.getParamsMap().put("mq_id", mq_id);
            isFilUeMaquetteExist.execute();
            DCIteratorBinding iterFilUeMaq = (DCIteratorBinding) bindings.get("IsFilUeMaquetteExistIterator");
            Row crntfilUe = iterFilUeMaq.getCurrentRow();
            if (crntfilUe == null) {
                OperationBinding isParcoursMaquetteExist = bindings.getOperationBinding("IsPercMaqAnnMaquetteExist");
                isParcoursMaquetteExist.getParamsMap().put("mq_id", mq_id);
                isParcoursMaquetteExist.execute();
                DCIteratorBinding iterParcMaqAnMaq =
                    (DCIteratorBinding) bindings.get("IsPercMaqAnnMaquetteExistIterator");
                Row crntParcMaqAn = iterParcMaqAnMaq.getCurrentRow();
                if (crntParcMaqAn == null) {
                    OperationBinding isNivMaquetteExist = bindings.getOperationBinding("IsNivFromMaqAnnMaquetteExist");
                    isNivMaquetteExist.getParamsMap().put("mq_id", mq_id);
                    isNivMaquetteExist.execute();
                    DCIteratorBinding iterNivMaqAnMaq =
                        (DCIteratorBinding) bindings.get("IsNivFromMaqAnnMaquetteExistIterator");
                    Row crntNivMaqAn = iterNivMaqAnMaq.getCurrentRow();
                    if (crntNivMaqAn == null) {
                        OnDeleteMaquetteCliced();
                    } else {
                        RichPopup popup = this.getPopupNivFormMaqAnMaquetteExist();
                        RichPopup.PopupHints hints = new RichPopup.PopupHints();
                        //empty hints renders dialog in center of screen
                        popup.show(hints);
                    }
                } else {
                    RichPopup popup = this.getPopupParcMaqAnMaquetteExist();
                    RichPopup.PopupHints hints = new RichPopup.PopupHints();
                    //empty hints renders dialog in center of screen
                    popup.show(hints);
                }
            } else {
                RichPopup popup = this.getPopupFilUeMaquetteExist();
                RichPopup.PopupHints hints = new RichPopup.PopupHints();
                //empty hints renders dialog in center of screen
                popup.show(hints);
            }
        }
    }

    public void OnNewFiliereUeSemestreClicked(ActionEvent actionEvent) {
        // Add event code here...
        BindingContainer bindings = getBindings();
        AttributeBinding uticre = (AttributeBinding) getBindings().getControlBinding("UtiCree3");
        DCIteratorBinding dciter = (DCIteratorBinding) bindings.get("FiliereUeSemstresIterator");
        Row oldCcurrentRow = dciter.getCurrentRow();
        if (oldCcurrentRow != null) {
            ADFContext adfCtx = ADFContext.getCurrent();
            adfCtx.getViewScope().put(OLD_CURR_KEY_VIEWSCOPE_ATTR, oldCcurrentRow.getKey().toStringFormat(true));
        }
        // adfCtx.getViewScope().put(OLD_CURR_KEY_VIEWSCOPE_ATTR, oldCcurrentRow.getKey().toStringFormat(true));
        //perform row create
        OperationBinding operationBinding = bindings.getOperationBinding("CreateFiliereUeSemestre");
        operationBinding.execute();
        if (!operationBinding.getErrors().isEmpty()) {
            return;
        }
        uticre.setInputValue(getUtilisateur());
        RichPopup popup = this.getPopupNewFiliereUeSemestre();
        RichPopup.PopupHints hints = new RichPopup.PopupHints();
        //empty hints renders dialog in center of screen
        popup.show(hints);
        return;
    }

    public void OnEditFiliereUeSemestreClicked(ActionEvent actionEvent) {
        // Add event code here...
        AttributeBinding utimodif = (AttributeBinding) getBindings().getControlBinding("UtiModifie4");
        utimodif.setInputValue(getUtilisateur());
        RichPopup popup = this.getPopupEditFiliereUeSemestre();
        RichPopup.PopupHints hints = new RichPopup.PopupHints();
        //empty hints renders dialog in center of screen
        popup.show(hints);
    }

    @SuppressWarnings("unchecked")
    public void OnDeleteFilUeAction(DialogEvent dialogEvent) {
        // Add event code here...
        if (dialogEvent.getOutcome().equals(Outcome.yes)) {
            BindingContainer bindings = getBindings();
            AttributeBinding fsIdBinding = (AttributeBinding) bindings.getControlBinding("IdFiliereUeSemstre1");
            Integer fs_id = (Integer.parseInt(fsIdBinding.getInputValue().toString()));
            OperationBinding isFilUeSemEcFilUEExist = bindings.getOperationBinding("IsFilUeSemEcFilUeExist");
            isFilUeSemEcFilUEExist.getParamsMap().put("fs_id", fs_id);
            isFilUeSemEcFilUEExist.execute();
            DCIteratorBinding iterFilEcFilUe = (DCIteratorBinding) bindings.get("IsFilUeSemEcFilUeExistIterator");
            Row crntfilEc = iterFilEcFilUe.getCurrentRow();
            if (crntfilEc == null) {
                OperationBinding isInsPedSemUEFilUeExist = bindings.getOperationBinding("IsInsPedSemUeFilUeExist");
                isInsPedSemUEFilUeExist.getParamsMap().put("fs_id", fs_id);
                isInsPedSemUEFilUeExist.execute();
                DCIteratorBinding iterInsPedSemUe = (DCIteratorBinding) bindings.get("IsInsPedSemUeFilUeExistIterator");
                Row crntInsPedSemUe = iterInsPedSemUe.getCurrentRow();
                if (crntInsPedSemUe == null) {
                    OperationBinding isValideFilUeExist = bindings.getOperationBinding("IsValidationFilUeExist");
                    isValideFilUeExist.getParamsMap().put("fs_id", fs_id);
                    isValideFilUeExist.execute();
                    DCIteratorBinding iterValidFilUe =
                        (DCIteratorBinding) bindings.get("IsValidationFilUeExistIterator");
                    Row crntValFilUe = iterValidFilUe.getCurrentRow();
                    if (crntValFilUe == null) {
                        OperationBinding isAccessFilUeExist = bindings.getOperationBinding("IsAccessFilUeExist");
                        isAccessFilUeExist.getParamsMap().put("fs_id", fs_id);
                        isAccessFilUeExist.execute();
                        DCIteratorBinding iterAccessFilUe =
                            (DCIteratorBinding) bindings.get("IsAccessFilUeExistIterator");
                        Row crntAccessFilUe = iterAccessFilUe.getCurrentRow();
                        if (crntAccessFilUe == null) {
                            OperationBinding operationBinding = bindings.getOperationBinding("DeleteFiliereUeSemestre");
                            Object result = operationBinding.execute();
                            if (!operationBinding.getErrors().isEmpty()) {
                            } else {
                                OperationBinding operationCommit = bindings.getOperationBinding("Commit");
                                Object commitResult = operationCommit.execute();
                                AdfFacesContext.getCurrentInstance().addPartialTarget(this.getMaquetteTable());

                            }
                        } else {
                            RichPopup popup = this.getPopupAccessFilUeExist();
                            RichPopup.PopupHints hints = new RichPopup.PopupHints();
                            //empty hints renders dialog in center of screen
                            popup.show(hints);
                        }
                    } else {
                        RichPopup popup = this.getPopupValideFilUeExist();
                        RichPopup.PopupHints hints = new RichPopup.PopupHints();
                        //empty hints renders dialog in center of screen
                        popup.show(hints);
                    }
                } else {
                    //popup uti exist
                    RichPopup popup = this.getPopupInsPedFilUeExist();
                    RichPopup.PopupHints hints = new RichPopup.PopupHints();
                    //empty hints renders dialog in center of screen
                    popup.show(hints);
                }
            } else {
                //popup uti exist
                RichPopup popup = this.getPopupFilEcFilUeExist();
                RichPopup.PopupHints hints = new RichPopup.PopupHints();
                //empty hints renders dialog in center of screen
                popup.show(hints);
            }
        }
    }

    public void OnNewFiliereUeSemestreEcClicked(ActionEvent actionEvent) {
        // Add event code here...
        BindingContainer bindings = getBindings();
        AttributeBinding uticre = (AttributeBinding) getBindings().getControlBinding("UtiCree4");
        DCIteratorBinding dciter = (DCIteratorBinding) bindings.get("FiliereUeSemstreEcIterator");
        Row oldCcurrentRow = dciter.getCurrentRow();
        if (oldCcurrentRow != null) {
            ADFContext adfCtx = ADFContext.getCurrent();
            adfCtx.getViewScope().put(OLD_CURR_KEY_VIEWSCOPE_ATTR, oldCcurrentRow.getKey().toStringFormat(true));
        }
        //perform row create
        OperationBinding operationBinding = bindings.getOperationBinding("CreateFiliereUeSemestreEc");
        Object result = operationBinding.execute();
        if (!operationBinding.getErrors().isEmpty()) {
            return;
        }
        uticre.setInputValue(getUtilisateur());
        RichPopup popup = this.getPopupNewFiliereUeSemestreEc();
        RichPopup.PopupHints hints = new RichPopup.PopupHints();
        //empty hints renders dialog in center of screen
        popup.show(hints);
        return;
    }

    public void OnEditFiliereUeSemestreEcClicked(ActionEvent actionEvent) {
        // Add event code here...
        AttributeBinding utimodif = (AttributeBinding) getBindings().getControlBinding("UtiModifie5");
        utimodif.setInputValue(getUtilisateur());
        RichPopup popup = this.getPopupEditFiliereUeSemestreEc();
        RichPopup.PopupHints hints = new RichPopup.PopupHints();
        //empty hints renders dialog in center of screen
        popup.show(hints);
    }

    @SuppressWarnings("unchecked")
    public void OnDeleteFilEcAction(DialogEvent dialogEvent) {
        // Add event code here...
        if (dialogEvent.getOutcome().equals(Outcome.yes)) {
            BindingContainer bindings = getBindings();
            AttributeBinding fecIdBinding = (AttributeBinding) bindings.getControlBinding("IdFiliereUeSemstreEc");
            Integer fec_id = (Integer.parseInt(fecIdBinding.getInputValue().toString()));
            OperationBinding isModeCntrlEcFilEcExist = bindings.getOperationBinding("IsModeCntrlEcFilEcExist");
            isModeCntrlEcFilEcExist.getParamsMap().put("fec_id", fec_id);
            isModeCntrlEcFilEcExist.execute();
            DCIteratorBinding iterModeCntrlEc = (DCIteratorBinding) bindings.get("IsModeCntrlEcFilEcExistIterator");
            Row crntmodCntrlEc = iterModeCntrlEc.getCurrentRow();
            if (crntmodCntrlEc == null) {
                OperationBinding isResFilEcExist = bindings.getOperationBinding("IsResultatFilEcExist");
                isResFilEcExist.getParamsMap().put("fec_id", fec_id);
                isResFilEcExist.execute();
                DCIteratorBinding iterResFilEc = (DCIteratorBinding) bindings.get("IsResultatFilEcExistIterator");
                Row crntResFilUe = iterResFilEc.getCurrentRow();
                if (crntResFilUe == null) {
                    OperationBinding isValideFilEcExist = bindings.getOperationBinding("IsValidationFilEcExist");
                    isValideFilEcExist.getParamsMap().put("fec_id", fec_id);
                    isValideFilEcExist.execute();
                    DCIteratorBinding iterValidFilEc =
                        (DCIteratorBinding) bindings.get("IsValidationFilEcExistIterator");
                    Row crntValFilEc = iterValidFilEc.getCurrentRow();
                    if (crntValFilEc == null) {
                        OperationBinding isNoteModeEnsFilEcExist =
                            bindings.getOperationBinding("IsNoteModeEnsFilEcExist");
                        isNoteModeEnsFilEcExist.getParamsMap().put("fec_id", fec_id);
                        isNoteModeEnsFilEcExist.execute();
                        DCIteratorBinding iterNoteFilEc =
                            (DCIteratorBinding) bindings.get("IsNoteModeEnsFilEcExistIterator");
                        Row crntNoteFilEc = iterNoteFilEc.getCurrentRow();
                        if (crntNoteFilEc == null) {
                            OperationBinding isAccesFilEcExist = bindings.getOperationBinding("IsAccesFilEcExist");
                            isAccesFilEcExist.getParamsMap().put("fec_id", fec_id);
                            isAccesFilEcExist.execute();
                            DCIteratorBinding iterAccesFilEc =
                                (DCIteratorBinding) bindings.get("IsAccesFilEcExistIterator");
                            Row crntAccesFilEc = iterAccesFilEc.getCurrentRow();
                            if (crntAccesFilEc == null) {
                                OperationBinding operationBinding =
                                    bindings.getOperationBinding("DeleteFiliereUeSemestreEc");
                                Object result = operationBinding.execute();
                                if (!operationBinding.getErrors().isEmpty()) {
                                } else {
                                    OperationBinding operationCommit = bindings.getOperationBinding("Commit");
                                    Object commitResult = operationCommit.execute();
                                    AdfFacesContext.getCurrentInstance().addPartialTarget(this.getMaquetteTable());

                                }
                            } else {
                                RichPopup popup = this.getPopupAccessFilEcExist();
                                RichPopup.PopupHints hints = new RichPopup.PopupHints();
                                //empty hints renders dialog in center of screen
                                popup.show(hints);
                            }
                        } else {
                            RichPopup popup = this.getPopupResFilEcExist();
                            RichPopup.PopupHints hints = new RichPopup.PopupHints();
                            //empty hints renders dialog in center of screen
                            popup.show(hints);
                        }
                    } else {
                        //popup nivformMaqAn exist
                        RichPopup popup = this.getPopupValideFilEcExist();
                        RichPopup.PopupHints hints = new RichPopup.PopupHints();
                        //empty hints renders dialog in center of screen
                        popup.show(hints);
                    }
                } else {
                    //popup nivformMaqAn exist
                    RichPopup popup = this.getPopupResFilEcExist();
                    RichPopup.PopupHints hints = new RichPopup.PopupHints();
                    //empty hints renders dialog in center of screen
                    popup.show(hints);
                }

            } else {
                //popup uti exist
                RichPopup popup = this.getPopupModeCntrlFilEcExist();
                RichPopup.PopupHints hints = new RichPopup.PopupHints();
                //empty hints renders dialog in center of screen
                popup.show(hints);
            }
        }
    }

    public void OnDialogAction(DialogEvent dialogEvent) {
        // Add event code here...
        Outcome outcome = dialogEvent.getOutcome();
        if (outcome == Outcome.ok) {
            //commit
            System.out.println("Commiting new fil_ec");
            BindingContainer bindings = getBindings();
            //JSFUtils.setExpressionValue("#{bindings.UtiCree4.inputValue}", getUtilisateur());
            OperationBinding operationBinding = bindings.getOperationBinding("Commit");
            operationBinding.execute();
            if (!operationBinding.getErrors().isEmpty()) {
                //handle errors if any
                //...
                return;
            }
            this.getPopupNewUe().hide();
            this.getPopupNewEc().hide();
            this.getPopupEditUe().hide();
            this.getPopupEditEc().hide();
            this.getPopupNewMaquette().hide();
            this.getPopupNewFiliereUeSemestre().hide();
            this.getPopupEditMaquette().hide();
            this.getPopupEditFiliereUeSemestre().hide();
            this.getPopupNewFiliereUeSemestreEc().hide();
            this.getPopupEditFiliereUeSemestreEc().hide();
            this.getPopupNewNivForm().hide();
            this.getPopupEditNivForm().hide();
            AdfFacesContext.getCurrentInstance().addPartialTarget(this.getUeTable());
            AdfFacesContext.getCurrentInstance().addPartialTarget(this.getEcTable());
            AdfFacesContext.getCurrentInstance().addPartialTarget(this.getMaquetteTable());
            AdfFacesContext.getCurrentInstance().addPartialTarget(this.getFiliereUeSemestreTable());
            AdfFacesContext.getCurrentInstance().addPartialTarget(this.getFiliereUeSemestreEcTable());
            AdfFacesContext.getCurrentInstance().addPartialTarget(this.getNivFormTable());
        }
    }

    public void OnUeDialogCancel(ClientEvent clientEvent) {
        // Add event code here...
        BindingContainer bindings = getBindings();
        this.getPopupNewUe().hide();
        this.getPopupEditUe().hide();
        DCIteratorBinding dciter = (DCIteratorBinding) bindings.get("UesIterator");
        Row currentRow = dciter.getCurrentRow();
        dciter.removeCurrentRow();
        //set current row back to original row
        ADFContext adfCtx = ADFContext.getCurrent();
        String oldCurrentRowKey = (String) adfCtx.getViewScope().get(OLD_CURR_KEY_VIEWSCOPE_ATTR);
        if (oldCurrentRowKey != null) {
            dciter.setCurrentRowWithKey(oldCurrentRowKey);
        }
        AdfFacesContext.getCurrentInstance().addPartialTarget(this.getUeTable());
        FacesContext fctx = FacesContext.getCurrentInstance();
        fctx.renderResponse();
    }

    public void OnEcDialogCancel(ClientEvent clientEvent) {
        // Add event code here...
        BindingContainer bindings = getBindings();
        this.getPopupNewEc().hide();
        this.getPopupEditEc().hide();
        DCIteratorBinding dciter = (DCIteratorBinding) bindings.get("EcsIterator");
        Row currentRow = dciter.getCurrentRow();
        dciter.removeCurrentRow();
        //set current row back to original row
        ADFContext adfCtx = ADFContext.getCurrent();
        String oldCurrentRowKey = (String) adfCtx.getViewScope().get(OLD_CURR_KEY_VIEWSCOPE_ATTR);
        if (oldCurrentRowKey != null) {
            dciter.setCurrentRowWithKey(oldCurrentRowKey);
        }
        AdfFacesContext.getCurrentInstance().addPartialTarget(this.getEcTable());
        FacesContext fctx = FacesContext.getCurrentInstance();
        fctx.renderResponse();
    }

    public void OnMaquetteDialogCancel(ClientEvent clientEvent) {
        // Add event code here...
        BindingContainer bindings = getBindings();
        RichPopup popup = this.getPopupNewMaquette();
        popup.hide();
        DCIteratorBinding dciter = (DCIteratorBinding) bindings.get("MaquettesIterator");
        Row currentRow = dciter.getCurrentRow();
        dciter.removeCurrentRow();
        //set current row back to original row
        ADFContext adfCtx = ADFContext.getCurrent();
        String oldCurrentRowKey = (String) adfCtx.getViewScope().get(OLD_CURR_KEY_VIEWSCOPE_ATTR);
        if (oldCurrentRowKey != null) {
            dciter.setCurrentRowWithKey(oldCurrentRowKey);
        }
        AdfFacesContext.getCurrentInstance().addPartialTarget(this.getMaquetteTable());
        FacesContext fctx = FacesContext.getCurrentInstance();
        //we don't want to continue with the remainder of the lifecycle and
        //thus skip the rest
        fctx.renderResponse();
    }

    public void OnFiliereUeSemestreDialogCancel(ClientEvent clientEvent) {
        // Add event code here...
        BindingContainer bindings = getBindings();
        RichPopup popup = this.getPopupNewFiliereUeSemestre();
        popup.hide();
        DCIteratorBinding dciter = (DCIteratorBinding) bindings.get("FiliereUeSemstresIterator");
        Row currentRow = dciter.getCurrentRow();
        dciter.removeCurrentRow();
        //set current row back to original row
        ADFContext adfCtx = ADFContext.getCurrent();
        String oldCurrentRowKey = (String) adfCtx.getViewScope().get(OLD_CURR_KEY_VIEWSCOPE_ATTR);
        if (oldCurrentRowKey != null) {
            dciter.setCurrentRowWithKey(oldCurrentRowKey);
        }
        AdfFacesContext.getCurrentInstance().addPartialTarget(this.getFiliereUeSemestreTable());
        FacesContext fctx = FacesContext.getCurrentInstance();
        //we don't want to continue with the remainder of the lifecycle and
        //thus skip the rest
        fctx.renderResponse();
    }

    public void OnFiliereUeSemEcDialogCancel(ClientEvent clientEvent) {
        // Add event code here...
        BindingContainer bindings = getBindings();
        RichPopup popup = this.getPopupNewFiliereUeSemestreEc();
        popup.hide();
        DCIteratorBinding dciter = (DCIteratorBinding) bindings.get("FiliereUeSemstreEcIterator");
        Row currentRow = dciter.getCurrentRow();
        dciter.removeCurrentRow();
        //set current row back to original row
        ADFContext adfCtx = ADFContext.getCurrent();
        String oldCurrentRowKey = (String) adfCtx.getViewScope().get(OLD_CURR_KEY_VIEWSCOPE_ATTR);
        if (oldCurrentRowKey != null) {
            dciter.setCurrentRowWithKey(oldCurrentRowKey);
        }
        AdfFacesContext.getCurrentInstance().addPartialTarget(this.getFiliereUeSemestreEcTable());
        FacesContext fctx = FacesContext.getCurrentInstance();
        //we don't want to continue with the remainder of the lifecycle and
        //thus skip the rest
        fctx.renderResponse();
    }

    public String OnDeleteUeClicked() {
        // Add event code here...
        BindingContainer bindings = getBindings();
        OperationBinding operationBinding = bindings.getOperationBinding("DeleteUe");
        Object result = operationBinding.execute();
        if (!operationBinding.getErrors().isEmpty()) {
            return null;
        } else {
            OperationBinding operationCommit = bindings.getOperationBinding("Commit");
            Object commitResult = operationCommit.execute();
            AdfFacesContext.getCurrentInstance().addPartialTarget(this.getUeTable());
            return null;
        }
    }

    public String OnDeleteEcClick() {
        // Add event code here...
        BindingContainer bindings = getBindings();
        OperationBinding operationBinding = bindings.getOperationBinding("DeleteEc");
        Object result = operationBinding.execute();
        if (!operationBinding.getErrors().isEmpty()) {
            return null;
        } else {
            OperationBinding operationCommit = bindings.getOperationBinding("Commit");
            Object commitResult = operationCommit.execute();
            AdfFacesContext.getCurrentInstance().addPartialTarget(this.getEcTable());
            return null;
        }
    }

    @SuppressWarnings("unchecked")
    public void OnDeleteMaquetteCliced() {
        BindingContainer bindings = getBindings();
        DCIteratorBinding dciter = (DCIteratorBinding) bindings.get("MaquettesIterator");
        Row currentRow = dciter.getCurrentRow();
        //Verify if maquette is used and if fil_ue exist in maquette before deleting maquette
        OperationBinding is_used = bindings.getOperationBinding("IsMaquetteUsed");
        is_used.getParamsMap().put("maquette", Integer.parseInt(currentRow.getAttribute("IdMaquette").toString()));
        is_used.execute();
        DCIteratorBinding dciterused = (DCIteratorBinding) bindings.get("IsMaquetteUsedROVOIterator");
        if (dciterused.getEstimatedRowCount() > 0) {
            RichPopup popup = this.getPopupMaquetteUsed();
            RichPopup.PopupHints hints = new RichPopup.PopupHints();
            //empty hints renders dialog in center of screen
            popup.show(hints);
        } else {
            OperationBinding operationBinding = bindings.getOperationBinding("DeleteMaquette");
            Object result = operationBinding.execute();
            if (!operationBinding.getErrors().isEmpty()) {
            } else {
                OperationBinding operationCommit = bindings.getOperationBinding("Commit");
                Object commitResult = operationCommit.execute();
                AdfFacesContext.getCurrentInstance().addPartialTarget(this.getMaquetteTable());

            }
        }
    }

    public void setNivFormTable(RichTable nivFormTable) {
        this.nivFormTable = nivFormTable;
    }

    public RichTable getNivFormTable() {
        return nivFormTable;
    }

    public void OnNewNivFormClicked(ActionEvent actionEvent) {
        // Add event code here...
        BindingContainer bindings = getBindings();
        //AttributeBinding uticre = (AttributeBinding) getBindings().getControlBinding("UtiCree6");
        DCIteratorBinding dciter = (DCIteratorBinding) bindings.get("NiveauFormationMaquetteAnnesIterator");
        Row oldCcurrentRow = dciter.getCurrentRow();
        if (oldCcurrentRow != null) {
            ADFContext adfCtx = ADFContext.getCurrent();
            adfCtx.getViewScope().put(OLD_CURR_KEY_VIEWSCOPE_ATTR, oldCcurrentRow.getKey().toStringFormat(true));
        }
        //perform row create
        OperationBinding operationBinding = bindings.getOperationBinding("CreateNivForm");
        Object result = operationBinding.execute();
        if (!operationBinding.getErrors().isEmpty()) {
            return;
        }
        JSFUtils.setExpressionValue("#{bindings.IdAnneesUnivers.inputValue}", getAnnee());
        RichPopup popup = this.getPopupNewNivForm();
        RichPopup.PopupHints hints = new RichPopup.PopupHints();
        //empty hints renders dialog in center of screen
        popup.show(hints);
        return;
    }

    public void setPopupNewNivForm(RichPopup popupNewNivForm) {
        this.popupNewNivForm = popupNewNivForm;
    }

    public RichPopup getPopupNewNivForm() {
        return popupNewNivForm;
    }

    public void OnNivFormDialogCancel(ClientEvent clientEvent) {
        // Add event code here...
        BindingContainer bindings = getBindings();
        RichPopup popup = this.getPopupNewNivForm();
        popup.hide();
        //the cancel operation is executed with immediate=true to bypass the
        //model update. Therefore we manually delete the new row from the
        //iterator
        DCIteratorBinding dciter = (DCIteratorBinding) bindings.get("NiveauFormationMaquetteAnnesIterator");
        Row currentRow = dciter.getCurrentRow();
        dciter.removeCurrentRow();
        //set current row back to original row
        ADFContext adfCtx = ADFContext.getCurrent();
        String oldCurrentRowKey = (String) adfCtx.getViewScope().get(OLD_CURR_KEY_VIEWSCOPE_ATTR);
        if (oldCurrentRowKey != null) {
            dciter.setCurrentRowWithKey(oldCurrentRowKey);
        }
        AdfFacesContext.getCurrentInstance().addPartialTarget(this.getNivFormTable());
        FacesContext fctx = FacesContext.getCurrentInstance();
        //we don't want to continue with the remainder of the lifecycle and
        //thus skip the rest
        fctx.renderResponse();
    }

    public void setPopupEditNivForm(RichPopup popupEditNivForm) {
        this.popupEditNivForm = popupEditNivForm;
    }

    public RichPopup getPopupEditNivForm() {
        return popupEditNivForm;
    }

    public void OnEditNivFormClicked(ActionEvent actionEvent) {
        // Add event code here...
        RichPopup popup = this.getPopupEditNivForm();
        RichPopup.PopupHints hints = new RichPopup.PopupHints();
        //empty hints renders dialog in center of screen
        popup.show(hints);
    }

    public String OnDeleteNivFormClicked() {
        // Add event code here...
        BindingContainer bindings = getBindings();
        OperationBinding operationBinding = bindings.getOperationBinding("DeleteNivForm");
        Object result = operationBinding.execute();
        if (!operationBinding.getErrors().isEmpty()) {
            return null;
        } else {
            OperationBinding operationCommit = bindings.getOperationBinding("Commit");
            Object commitResult = operationCommit.execute();
            AdfFacesContext.getCurrentInstance().addPartialTarget(this.getMaquetteTable());
            return null;
        }
    }

    public void setPopupDeleteNivForm(RichPopup popupDeleteNivForm) {
        this.popupDeleteNivForm = popupDeleteNivForm;
    }

    public RichPopup getPopupDeleteNivForm() {
        return popupDeleteNivForm;
    }

    public void OnDeleteNivFormAction(DialogEvent dialogEvent) {
        // Add event code here...
        if (dialogEvent.getOutcome().equals(Outcome.yes)) {
            OnDeleteNivFormClicked();
        }
    }

    public void setUtilisateur(Integer utilisateur) {
        this.utilisateur = utilisateur;
    }

    public Integer getUtilisateur() {
        return utilisateur;
    }

    public void onSaveUeAction(DialogEvent dialogEvent) {
        Outcome outcome = dialogEvent.getOutcome();
        if (outcome == Outcome.ok) {
            BindingContainer bindings = getBindings();
            //JSFUtils.setExpressionValue("#{bindings.UtiCree.inputValue}", getUtilisateur());
            OperationBinding operationBinding = bindings.getOperationBinding("Commit");
            Object result = operationBinding.execute();
            if (!operationBinding.getErrors().isEmpty()) {
                return;
            }
            this.getPopupNewUe().hide();
            AdfFacesContext.getCurrentInstance().addPartialTarget(this.getUeTable());
        }
    }

    public void onUpdateUeAction(DialogEvent dialogEvent) {
        Outcome outcome = dialogEvent.getOutcome();
        if (outcome == Outcome.ok) {
            BindingContainer bindings = getBindings();
            //JSFUtils.setExpressionValue("#{bindings.UtiModifie.inputValue}", getUtilisateur());
            OperationBinding operationBinding = bindings.getOperationBinding("Commit");
            Object result = operationBinding.execute();
            if (!operationBinding.getErrors().isEmpty()) {
                //handle errors if any
                //...
                return;
            }
            this.getPopupEditUe().hide();
            AdfFacesContext.getCurrentInstance().addPartialTarget(this.getUeTable());
        }
    }

    public void onSaveEcAction(DialogEvent dialogEvent) {
        Outcome outcome = dialogEvent.getOutcome();
        if (outcome == Outcome.ok) {
            BindingContainer bindings = getBindings();
            //JSFUtils.setExpressionValue("#{bindings.UtiCree1.inputValue}", getUtilisateur());
            OperationBinding operationBinding = bindings.getOperationBinding("Commit");
            Object result = operationBinding.execute();
            if (!operationBinding.getErrors().isEmpty()) {
                //handle errors if any
                //...
                return;
            }
            this.getPopupNewEc().hide();
            AdfFacesContext.getCurrentInstance().addPartialTarget(this.getEcTable());
        }
    }

    public void onUpdateEcAction(DialogEvent dialogEvent) {
        Outcome outcome = dialogEvent.getOutcome();
        if (outcome == Outcome.ok) {
            BindingContainer bindings = getBindings();
            //JSFUtils.setExpressionValue("#{bindings.UtiModifie1.inputValue}", getUtilisateur());
            OperationBinding operationBinding = bindings.getOperationBinding("Commit");
            Object result = operationBinding.execute();
            if (!operationBinding.getErrors().isEmpty()) {
                //handle errors if any
                //...
                return;
            }
            this.getPopupEditEc().hide();
            AdfFacesContext.getCurrentInstance().addPartialTarget(this.getEcTable());
        }
    }

    public void onSaveMaquetteAction(DialogEvent dialogEvent) {
        Outcome outcome = dialogEvent.getOutcome();
        if (outcome == Outcome.ok) {
            BindingContainer bindings = getBindings();
            //JSFUtils.setExpressionValue("#{bindings.UtiCree2.inputValue}", getUtilisateur());
            OperationBinding operationBinding = bindings.getOperationBinding("Commit");
            Object result = operationBinding.execute();
            if (!operationBinding.getErrors().isEmpty()) {
                //...
                return;
            }
            this.getPopupNewMaquette().hide();
            AdfFacesContext.getCurrentInstance().addPartialTarget(this.getMaquetteTable());
        }
    }

    public void onUpdateMaquetteAction(DialogEvent dialogEvent) {
        Outcome outcome = dialogEvent.getOutcome();
        if (outcome == Outcome.ok) {
            BindingContainer bindings = getBindings();
            //JSFUtils.setExpressionValue("#{bindings.UtiModifie2.inputValue}", getUtilisateur());
            OperationBinding operationBinding = bindings.getOperationBinding("Commit");
            Object result = operationBinding.execute();
            if (!operationBinding.getErrors().isEmpty()) {
                //handle errors if any
                //...
                return;
            }
            this.getPopupEditMaquette().hide();
            AdfFacesContext.getCurrentInstance().addPartialTarget(this.getMaquetteTable());
        }
    }

    public void onSaveFilUeAction(DialogEvent dialogEvent) {
        Outcome outcome = dialogEvent.getOutcome();
        if (outcome == Outcome.ok) {
            BindingContainer bindings = getBindings();
            //JSFUtils.setExpressionValue("#{bindings.UtiCree6.inputValue}", getUtilisateur());
            OperationBinding operationBinding = bindings.getOperationBinding("Commit");
            Object result = operationBinding.execute();
            if (!operationBinding.getErrors().isEmpty()) {
                //handle errors if any
                //...
                return;
            }
            this.getPopupNewFiliereUeSemestre().hide();
            AdfFacesContext.getCurrentInstance().addPartialTarget(this.getFiliereUeSemestreTable());
        }
    }

    public void onUpdateFilUeAction(DialogEvent dialogEvent) {
        Outcome outcome = dialogEvent.getOutcome();
        if (outcome == Outcome.ok) {
            BindingContainer bindings = getBindings();
            //JSFUtils.setExpressionValue("#{bindings.UtiModifie4.inputValue}", getUtilisateur());
            OperationBinding operationBinding = bindings.getOperationBinding("Commit");
            Object result = operationBinding.execute();
            if (!operationBinding.getErrors().isEmpty()) {
                //handle errors if any
                //...
                return;
            }
            this.getPopupEditFiliereUeSemestre().hide();
            AdfFacesContext.getCurrentInstance().addPartialTarget(this.getFiliereUeSemestreTable());
        }
    }

    public void onSaveFilUeSemEcAction(DialogEvent dialogEvent) {
        Outcome outcome = dialogEvent.getOutcome();
        if (outcome == Outcome.ok) {
            BindingContainer bindings = getBindings();
            //JSFUtils.setExpressionValue("#{bindings.UtiCree4.inputValue}", getUtilisateur());
            OperationBinding operationBinding = bindings.getOperationBinding("Commit");
            Object result = operationBinding.execute();
            if (!operationBinding.getErrors().isEmpty()) {
                //handle errors if any
                //...
                return;
            }
            this.getPopupNewFiliereUeSemestreEc().hide();
            AdfFacesContext.getCurrentInstance().addPartialTarget(this.getFiliereUeSemestreEcTable());
        }
    }

    public void onUpdateFilUeSemEcAction(DialogEvent dialogEvent) {
        Outcome outcome = dialogEvent.getOutcome();
        if (outcome == Outcome.ok) {
            BindingContainer bindings = getBindings();
            //JSFUtils.setExpressionValue("#{bindings.UtiModifie5.inputValue}", getUtilisateur());
            OperationBinding operationBinding = bindings.getOperationBinding("Commit");
            Object result = operationBinding.execute();
            if (!operationBinding.getErrors().isEmpty()) {
                //handle errors if any
                //...
                return;
            }
            this.getPopupEditFiliereUeSemestreEc().hide();
            AdfFacesContext.getCurrentInstance().addPartialTarget(this.getFiliereUeSemestreEcTable());
        }
    }

    public void OnNewNivFormAction(DialogEvent dialogEvent) {
        Outcome outcome = dialogEvent.getOutcome();
        if (outcome == Outcome.ok) {
            BindingContainer bindings = getBindings();
            //JSFUtils.setExpressionValue("#{bindings.UtiCree5.inputValue}", getUtilisateur());
            OperationBinding operationBinding = bindings.getOperationBinding("Commit");
            Object result = operationBinding.execute();
            if (!operationBinding.getErrors().isEmpty()) {
                //handle errors if any
                //...
                return;
            }
            this.getPopupNewNivForm().hide();
            AdfFacesContext.getCurrentInstance().addPartialTarget(this.getNivFormTable());
        }
    }

    public void OnEditNivFormAction(DialogEvent dialogEvent) {
        Outcome outcome = dialogEvent.getOutcome();
        if (outcome == Outcome.ok) {
            BindingContainer bindings = getBindings();
            //JSFUtils.setExpressionValue("#{bindings.UtiModifie3.inputValue}", getUtilisateur());
            OperationBinding operationBinding = bindings.getOperationBinding("Commit");
            Object result = operationBinding.execute();
            if (!operationBinding.getErrors().isEmpty()) {
                //handle errors if any
                //...
                return;
            }
            this.getPopupNewNivForm().hide();
            AdfFacesContext.getCurrentInstance().addPartialTarget(this.getNivFormTable());
        }
    }

    public String onNewModaliteCntrlClicked() {
        System.out.println("New Modalite");
        return null;
    }

    public String onCommitClicked() {
        BindingContainer bindings = getBindings();
        //JSFUtils.setExpressionValue("#{bindings.UtiCree7.inputValue}", getUtilisateur());
        OperationBinding operationBinding = bindings.getOperationBinding("Commit");
        Object result = operationBinding.execute();
        if (!operationBinding.getErrors().isEmpty()) {
            return null;
        }
        return null;
    }

    public String onRollbackClicked() {
        System.out.println("Rolling back");
        //AdfFacesContext.getCurrentInstance().addPartialTarget(this.getModaliteCntrlTable());
        return null;
    }

    public void setModaliteCntrlTable(RichTable modaliteCntrlTable) {
        this.modaliteCntrlTable = modaliteCntrlTable;
    }

    public RichTable getModaliteCntrlTable() {
        return modaliteCntrlTable;
    }

    public String deleteModeCntrl() {
        BindingContainer bindings = getBindings();
        OperationBinding operationBinding = bindings.getOperationBinding("DeleteModeCntrl");
        Object result = operationBinding.execute();
        if (!operationBinding.getErrors().isEmpty()) {
            return null;
        } else {
            OperationBinding operationCommit = bindings.getOperationBinding("Commit");
            Object commitResult = operationCommit.execute();
            AdfFacesContext.getCurrentInstance().addPartialTarget(this.getUeTable());
            return null;
        }
    }

    public void onDeleteModeCntrlAction(DialogEvent dialogEvent) {
        if (dialogEvent.getOutcome().equals(Outcome.yes)) {
            deleteModeCntrl();
        }
    }

    public void onEditMdCntrlAction(DialogEvent dialogEvent) {
        Outcome outcome = dialogEvent.getOutcome();
        if (outcome == Outcome.ok) {
            BindingContainer bindings = getBindings();
            //JSFUtils.setExpressionValue("#{bindings.UtiModifie6.inputValue}", getUtilisateur());
            OperationBinding operationBinding = bindings.getOperationBinding("Commit");
            Object result = operationBinding.execute();
            if (!operationBinding.getErrors().isEmpty()) {
                //handle errors if any
                //...
                return;
            }
            this.getPopupEditMdCntrl().hide();
            AdfFacesContext.getCurrentInstance().addPartialTarget(this.getModaliteCntrlTable());
        }
    }

    public void setPopupEditMdCntrl(RichPopup popupEditMdCntrl) {
        this.popupEditMdCntrl = popupEditMdCntrl;
    }

    public RichPopup getPopupEditMdCntrl() {
        return popupEditMdCntrl;
    }

    public void setPopupDeleteMdCntrl(RichPopup popupDeleteMdCntrl) {
        this.popupDeleteMdCntrl = popupDeleteMdCntrl;
    }

    public RichPopup getPopupDeleteMdCntrl() {
        return popupDeleteMdCntrl;
    }

    public String onEditMdCntrlClicked() {
        RichPopup popup = this.getPopupEditMdCntrl();
        RichPopup.PopupHints hints = new RichPopup.PopupHints();
        popup.show(hints);
        return null;
    }

    public void OnNewParcoursMaqAnnClicked(ActionEvent actionEvent) {

        BindingContainer bindings = getBindings();
        //get current row and save its rowKey in view scope for later use
        DCIteratorBinding dciter = (DCIteratorBinding) bindings.get("MaquettesIterator");
        Row currentMaquette = dciter.getCurrentRow();
        if (currentMaquette != null) {
            AttributeBinding uticre = (AttributeBinding) getBindings().getControlBinding("UtiCree8");
            AttributeBinding maq = (AttributeBinding) getBindings().getControlBinding("IdMaquette3");
            DCIteratorBinding dciterParc = (DCIteratorBinding) bindings.get("MaquettesIterator");
            Row oldCcurrentRow = dciterParc.getCurrentRow();
            if (oldCcurrentRow != null) {
                ADFContext adfCtx = ADFContext.getCurrent();
                adfCtx.getViewScope().put(OLD_CURR_KEY_VIEWSCOPE_ATTR, oldCcurrentRow.getKey().toStringFormat(true));
            }
            //perform row create
            OperationBinding operationBinding = bindings.getOperationBinding("CreateParcousMaqAnn");
            Object result = operationBinding.execute();
            if (!operationBinding.getErrors().isEmpty()) {
                return;
            }
            uticre.setInputValue(getUtilisateur());
            maq.setInputValue(Long.parseLong(currentMaquette.getAttribute("IdMaquette").toString()));
            //IdAnneesUnivers2
            JSFUtils.setExpressionValue("#{bindings.IdAnneesUnivers2.inputValue}", getAnnee());
            RichPopup popup = this.getPopupNewParcMaqAnnee();
            RichPopup.PopupHints hints = new RichPopup.PopupHints();
            //empty hints renders dialog in center of screen
            popup.show(hints);
            return;
        }
    }

    public void OnEditPrcsMaqAnnClicked(ActionEvent actionEvent) {
        BindingContainer bindings = getBindings();
        AttributeBinding utimodif = (AttributeBinding) getBindings().getControlBinding("UtiModifie7");
        utimodif.setInputValue(getUtilisateur());
        RichPopup popup = this.getPopupEditParcMaqAnnee();
        RichPopup.PopupHints hints = new RichPopup.PopupHints();
        //empty hints renders dialog in center of screen
        popup.show(hints);

    }

    public void setPopupNewParcMaqAnnee(RichPopup popupNewParcMaqAnnee) {
        this.popupNewParcMaqAnnee = popupNewParcMaqAnnee;
    }

    public RichPopup getPopupNewParcMaqAnnee() {
        return popupNewParcMaqAnnee;
    }

    public void OnSaveAction(DialogEvent dialogEvent) {
        Outcome outcome = dialogEvent.getOutcome();
        if (outcome == Outcome.ok) {
            BindingContainer bindings = getBindings();
            OperationBinding operationBinding = bindings.getOperationBinding("Commit");
            Object result = operationBinding.execute();
            if (!operationBinding.getErrors().isEmpty()) {
                //handle errors if any
                //...
                return;
            }
            this.getPopupNewParcMaqAnnee().hide();
            this.getPopupEditParcMaqAnnee().hide();
            AdfFacesContext.getCurrentInstance().addPartialTarget(this.getParcrsMaqAnTable());
        }
    }

    public void OnParcrsMaqAnnDialogCancel(ClientEvent clientEvent) {
        BindingContainer bindings = getBindings();
        this.getPopupNewParcMaqAnnee().hide();
        this.getPopupEditParcMaqAnnee().hide();
        DCIteratorBinding dciter = (DCIteratorBinding) bindings.get("ParcoursMaquetteAnneeVOIterator");
        Row currentRow = dciter.getCurrentRow();
        dciter.removeCurrentRow();
        //set current row back to original row
        ADFContext adfCtx = ADFContext.getCurrent();
        String oldCurrentRowKey = (String) adfCtx.getViewScope().get(OLD_CURR_KEY_VIEWSCOPE_ATTR);
        if (oldCurrentRowKey != null) {
            dciter.setCurrentRowWithKey(oldCurrentRowKey);
        }
        AdfFacesContext.getCurrentInstance().addPartialTarget(this.getParcrsMaqAnTable());
        FacesContext fctx = FacesContext.getCurrentInstance();
        fctx.renderResponse();
    }

    public void setParcrsMaqAnTable(RichTable parcrsMaqAnTable) {
        this.parcrsMaqAnTable = parcrsMaqAnTable;
    }

    public RichTable getParcrsMaqAnTable() {
        return parcrsMaqAnTable;
    }

    public void setPopupEditParcMaqAnnee(RichPopup popupEditParcMaqAnnee) {
        this.popupEditParcMaqAnnee = popupEditParcMaqAnnee;
    }

    public RichPopup getPopupEditParcMaqAnnee() {
        return popupEditParcMaqAnnee;
    }

    public void setPopupMaquetteUsed(RichPopup popupMaquetteUsed) {
        this.popupMaquetteUsed = popupMaquetteUsed;
    }

    public RichPopup getPopupMaquetteUsed() {
        return popupMaquetteUsed;
    }

    public void setPopupImport(RichPopup popupImport) {
        this.popupImport = popupImport;
    }

    public RichPopup getPopupImport() {
        return popupImport;
    }

    public void onImportInputValueChanged(ValueChangeEvent valueChangeEvent) {
        // Add event code here...
        System.out.println("Value Changed !!!");
    }

    public void OnImportAction(DialogEvent dialogEvent) {
        // Add event code here...
        Outcome outcome = dialogEvent.getOutcome();
        if (outcome == Outcome.ok) {

        }
    }

    public void OnImportValideAction(ActionEvent actionEvent) {
        // Add event code here...
        UploadedFile file = uploadedFile;

        try {
            //Check if file is XLSX
            if (file.getContentType()
                .equalsIgnoreCase("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet") ||
                file.getContentType().equalsIgnoreCase("application/xlsx")) {
                System.out.println("File type : " + file.getContentType());
                readNProcessExcelx(file.getInputStream()); //for xlsx
            }
            //Check if file is XLS
            else if (file.getContentType().equalsIgnoreCase("application/vnd.ms-excel")) {
                if (file.getFilename()
                        .toUpperCase()
                        .endsWith(".XLS")) {
                    System.out.println("File type : " + file.getContentType());
                    //readNProcessExcel(file.getInputStream()); //for xls
                }

            } else {
                FacesMessage msg = new FacesMessage("File format not supported.-- Upload XLS or XLSX file");
                msg.setSeverity(FacesMessage.SEVERITY_WARN);
                FacesContext.getCurrentInstance().addMessage(null, msg);
            }
            file.getInputStream().close();
            AdfFacesContext.getCurrentInstance().addPartialTarget(getMaqpage());

        } catch (IOException e) {
            // TODO
        }
        // finally{
        this.getPopupImport().hide();
        this.getPopupImport().clearInitialState();
        //  }
    }

    public void OnCancelImport(ActionEvent actionEvent) {
        // Add event code here...
        this.getPopupImport().hide();
        this.getPopupImport().clearInitialState();
    }

    public void setUploadedFile(UploadedFile uploadedFile) {
        this.uploadedFile = uploadedFile;
    }

    public UploadedFile getUploadedFile() {
        return uploadedFile;
    }

    /**Method to get Binding Container of current view port
     * @return
     */
    public BindingContainer getBindingsCont() {
        return BindingContext.getCurrent().getCurrentBindingsEntry();
    }

    /**
     * Generic Method to execute operation
     * */
    public OperationBinding executeOperation(String operation) {
        OperationBinding createParam = getBindingsCont().getOperationBinding(operation);
        return createParam;
    }
    //readNProcessEtuExcelx

    /**
     * Method to read xlsx file and upload to table.
     * @param myxls
     * @throws IOException
     */
    @SuppressWarnings({ "oracle.jdeveloper.java.insufficient-catch-block", "unchecked" })
    public void readNProcessEtuExcelx(InputStream xlsx) throws IOException {
        DCIteratorBinding iterPers = (DCIteratorBinding) BindingContext.getCurrent()
                                                                       .getCurrentBindingsEntry()
                                                                       .get("PersonnesIterator");
        DCIteratorBinding iterEtu = (DCIteratorBinding) BindingContext.getCurrent()
                                                                      .getCurrentBindingsEntry()
                                                                      .get("EtudiantsIterator");

        DCIteratorBinding iterInsAdmin = (DCIteratorBinding) BindingContext.getCurrent()
                                                                           .getCurrentBindingsEntry()
                                                                           .get("InscriptionsAdminIterator");
        DCIteratorBinding iterInsPed = (DCIteratorBinding) BindingContext.getCurrent()
                                                                         .getCurrentBindingsEntry()
                                                                         .get("InscriptionsPedagogiquesIterator");
        DCIteratorBinding iterInsPedSem = (DCIteratorBinding) BindingContext.getCurrent()
                                                                            .getCurrentBindingsEntry()
                                                                            .get("InscriptionPedSemestreIterator");
        DCIteratorBinding iterInsPedSemUe = (DCIteratorBinding) BindingContext.getCurrent()
                                                                              .getCurrentBindingsEntry()
                                                                              .get("InscriptionPedSemUeIterator");

        XSSFWorkbook WorkBook = null;
        int sheetIndex = 0;
        ArrayList<Long> listfilUeSem = new ArrayList<Long>();
        try {
            WorkBook = new XSSFWorkbook(xlsx);
        } catch (IOException e) {

        }
        System.out.println("Nombre de feuille : " + WorkBook.getNumberOfSheets());
        OperationBinding op_get_fil_ue = BindingContext.getCurrent()
                                                       .getCurrentBindingsEntry()
                                                       .getOperationBinding("getFilUeSem");
        op_get_fil_ue.getParamsMap().put("a_id", getAnnee());
        op_get_fil_ue.getParamsMap().put("s_id", getSemestre());
        op_get_fil_ue.getParamsMap().put("p_id", getParcours());
        op_get_fil_ue.execute();
        DCIteratorBinding iterfilue = (DCIteratorBinding) BindingContext.getCurrent()
                                                                        .getCurrentBindingsEntry()
                                                                        .get("getFilUeSemestre1Iterator");
        RowSetIterator rsi = iterfilue.getViewObject().createRowSetIterator(null);
        //getFilEcInspedSemUeEtudiant
        while (rsi.hasNext()) {
            Row nextRow = rsi.next();
            if (!(listfilUeSem.contains(Long.parseLong(nextRow.getAttribute("IdFiliereUeSemstre").toString())))) {
                listfilUeSem.add(Long.parseLong(nextRow.getAttribute("IdFiliereUeSemstre").toString()));
            }
        }
        rsi.closeRowSetIterator();

        //####################################### Personnes
        for (sheetIndex = 0; sheetIndex < WorkBook.getNumberOfSheets(); sheetIndex++) {
            System.out.println("Sheet : " + sheetIndex);
            XSSFSheet sheet = WorkBook.getSheetAt(sheetIndex);
            Integer skipRw = 1;
            Integer skipcnt = 1;
            //Personne
            if (sheetIndex == 0) {
                System.out.println("Titre feuille : " + WorkBook.getSheetAt(sheetIndex).getSheetName());
                for (org.apache.poi.ss.usermodel.Row tempRow : sheet) {
                    if (skipcnt > skipRw) { //skip first n row for labels.
                        //Create new row in table
                        OperationBinding op_new_ts = BindingContext.getCurrent()
                                                                   .getCurrentBindingsEntry()
                                                                   .getOperationBinding("CreatePersonne");
                        op_new_ts.execute();
                        Row rowPers = iterPers.getCurrentRow();
                        int Index = 0;
                        //Iterate over row's columns
                        for (int column = 0; column < tempRow.getLastCellNum(); column++) {
                            Cell MytempCell = tempRow.getCell(column);
                            if (MytempCell != null) {
                                Index = MytempCell.getColumnIndex();
                                if (Index == 0) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        rowPers.setAttribute("Nom", MytempCell.getStringCellValue());
                                        //UtiCree
                                        rowPers.setAttribute("UtiCree", getUtilisateur());
                                    }
                                } else if (Index == 1) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        rowPers.setAttribute("Prenoms", MytempCell.getStringCellValue());
                                    }
                                } else if (Index == 2) {
                                    rowPers.setAttribute("NomMarital", MytempCell.getStringCellValue());
                                } else if (Index == 3) {
                                    if (MytempCell.getDateCellValue() != null) {
                                        java.util.Date date = MytempCell.getDateCellValue();
                                        DateFormat dateFormat = new SimpleDateFormat("MM/dd/yy");
                                        String date1 = dateFormat.format(date);
                                        try {
                                            date = dateFormat.parse(date1);
                                        } catch (ParseException e) {
                                        }
                                        //System.out.println("Date Format : " + date);
                                        java.sql.Date sqlDate = new java.sql.Date(date.getTime());
                                        oracle.jbo.domain.Date jboDate = new oracle.jbo.domain.Date(sqlDate);
                                        rowPers.setAttribute("DateNaissance", date);
                                    }
                                } else if (Index == 4) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        rowPers.setAttribute("LieuNaissance", MytempCell.getStringCellValue());
                                    }
                                } else if (Index == 5) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        rowPers.setAttribute("Adresse", MytempCell.getStringCellValue());
                                    }
                                } else if (Index == 6) {
                                    rowPers.setAttribute("EmailInstitutionnel", MytempCell.getStringCellValue());
                                } else if (Index == 7) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        rowPers.setAttribute("EmailPersonnel", MytempCell.getStringCellValue());
                                    }
                                } else if (Index == 8) {
                                    rowPers.setAttribute("Telephone", MytempCell.getStringCellValue());
                                } else if (Index == 9) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        rowPers.setAttribute("Portable", MytempCell.getStringCellValue());
                                    }
                                } else if (Index == 10) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        OperationBinding op_pay = BindingContext.getCurrent()
                                                                                .getCurrentBindingsEntry()
                                                                                .getOperationBinding("getPays");
                                        op_pay.getParamsMap().put("lib", MytempCell.getStringCellValue());
                                        op_pay.execute();
                                        DCIteratorBinding iterExist =
                                            (DCIteratorBinding) BindingContext.getCurrent()
                                                                                                        .getCurrentBindingsEntry()
                                                                                                        .get("getPays1Iterator");
                                        if (iterExist.getEstimatedRowCount() > 0) {
                                            rowPers.setAttribute("IdPays", Long.parseLong(iterExist.getCurrentRow()
                                                                                                   .getAttribute("IdPays")
                                                                                                   .toString()));
                                        }
                                    }
                                } else if (Index == 11) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        OperationBinding op_pay = BindingContext.getCurrent()
                                                                                .getCurrentBindingsEntry()
                                                                                .getOperationBinding("getPays");
                                        op_pay.getParamsMap().put("lib", MytempCell.getStringCellValue());
                                        op_pay.execute();
                                        DCIteratorBinding iterExist =
                                            (DCIteratorBinding) BindingContext.getCurrent()
                                                                                                        .getCurrentBindingsEntry()
                                                                                                        .get("getPays1Iterator");
                                        if (iterExist.getEstimatedRowCount() > 0) {
                                            rowPers.setAttribute("IdPaysNationalite",
                                                                 Long.parseLong(iterExist.getCurrentRow()
                                                                                                              .getAttribute("IdPays")
                                                                                                              .toString()));
                                        }
                                    }
                                } else if (Index == 12) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        OperationBinding op_pay = BindingContext.getCurrent()
                                                                                .getCurrentBindingsEntry()
                                                                                .getOperationBinding("getCivilite");
                                        op_pay.getParamsMap().put("lib", MytempCell.getStringCellValue());
                                        op_pay.execute();
                                        DCIteratorBinding iterExist =
                                            (DCIteratorBinding) BindingContext.getCurrent()
                                                                                                        .getCurrentBindingsEntry()
                                                                                                        .get("getCivilite1Iterator");
                                        if (iterExist.getEstimatedRowCount() > 0) {
                                            rowPers.setAttribute("IdCivilite", Long.parseLong(iterExist.getCurrentRow()
                                                                                                       .getAttribute("IdCivilite")
                                                                                                       .toString()));
                                        }
                                    }
                                } else if (Index == 13) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        OperationBinding op_pay = BindingContext.getCurrent()
                                                                                .getCurrentBindingsEntry()
                                                                                .getOperationBinding("getSexe");
                                        op_pay.getParamsMap().put("lib", MytempCell.getStringCellValue());
                                        op_pay.execute();
                                        DCIteratorBinding iterExist =
                                            (DCIteratorBinding) BindingContext.getCurrent()
                                                                                                        .getCurrentBindingsEntry()
                                                                                                        .get("getSexe1Iterator");
                                        if (iterExist.getEstimatedRowCount() > 0) {
                                            rowPers.setAttribute("IdSexe", Long.parseLong(iterExist.getCurrentRow()
                                                                                                   .getAttribute("IdSexe")
                                                                                                   .toString()));
                                        }
                                    }
                                } else if (Index == 14) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        rowPers.setAttribute("PieceIdentification", MytempCell.getStringCellValue());
                                    }
                                } else if (Index == 15) {
                                    rowPers.setAttribute("Ine", MytempCell.getStringCellValue());
                                } else if (Index == 16) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        rowPers.setAttribute("DateEstimee", MytempCell.getStringCellValue());
                                    }
                                } else if (Index == 17) {
                                    rowPers.setAttribute("NombreEpouses", MytempCell.getStringCellValue());
                                } else if (Index == 18) {
                                    rowPers.setAttribute("Photo", MytempCell.getStringCellValue());
                                } else if (Index == 19) {
                                    rowPers.setAttribute("CodeBarre", MytempCell.getStringCellValue());
                                } else if (Index == 20) {
                                    rowPers.setAttribute("ImageCodeBarre", MytempCell.getStringCellValue());
                                } else if (Index == 21) {
                                    rowPers.setAttribute("CodeEmail", MytempCell.getStringCellValue());
                                } else if (Index == 22) {
                                    rowPers.setAttribute("PassWord", MytempCell.getStringCellValue());
                                }
                            } else {
                                Index++;
                            }
                        }
                        if (rowPers.getAttribute("Nom") == null || rowPers.getAttribute("Prenoms") == null ||
                            rowPers.getAttribute("DateNaissance") == null ||
                            rowPers.getAttribute("LieuNaissance") == null ||
                            rowPers.getAttribute("EmailPersonnel") == null || rowPers.getAttribute("Adresse") == null ||
                            rowPers.getAttribute("Portable") == null || rowPers.getAttribute("IdPays") == null ||
                            rowPers.getAttribute("IdPaysNationalite") == null ||
                            rowPers.getAttribute("IdCivilite") == null ||
                            rowPers.getAttribute("PieceIdentification") == null) {
                            rowPers.removeAndRetain();
                            System.out.println("Des champs obligatoires manques !!!");
                            OperationBinding op_rlbk = BindingContext.getCurrent()
                                                                     .getCurrentBindingsEntry()
                                                                     .getOperationBinding("Rollback");
                            op_rlbk.execute();
                        } else {
                            OperationBinding is_pers_exist = BindingContext.getCurrent()
                                                                           .getCurrentBindingsEntry()
                                                                           .getOperationBinding("isPersExist");
                            is_pers_exist.getParamsMap().put("nom", rowPers.getAttribute("Nom"));
                            is_pers_exist.getParamsMap().put("p_nom", rowPers.getAttribute("Prenoms"));
                            is_pers_exist.getParamsMap().put("email", rowPers.getAttribute("EmailPersonnel"));
                            is_pers_exist.getParamsMap().put("tel", rowPers.getAttribute("Portable"));
                            is_pers_exist.getParamsMap().put("nin", rowPers.getAttribute("PieceIdentification"));
                            is_pers_exist.execute();
                            DCIteratorBinding iterExist =
                                (DCIteratorBinding) BindingContext.getCurrent()
                                                                                            .getCurrentBindingsEntry()
                                                                                            .get("isPersExist1Iterator");
                            if (iterExist.getEstimatedRowCount() > 0) {
                                System.out.println("Utilisateur existant !");
                                rowPers.removeAndRetain();
                                OperationBinding op_rlbk = BindingContext.getCurrent()
                                                                         .getCurrentBindingsEntry()
                                                                         .getOperationBinding("Rollback");
                                op_rlbk.execute();
                            } else
                                try {
                                    System.out.println("Commiting ...");
                                    OperationBinding op_commit = BindingContext.getCurrent()
                                                                               .getCurrentBindingsEntry()
                                                                               .getOperationBinding("Commit");
                                    op_commit.execute();
                                    System.out.println("Commited");

                                } catch (Exception e) {
                                    System.out.println(e.getMessage());
                                }
                        }
                    }
                    skipcnt++;
                }
            }
        }
        //####################################### Etudiant et Inscription Administratif
        for (sheetIndex = 0; sheetIndex < WorkBook.getNumberOfSheets(); sheetIndex++) {
            System.out.println("Sheet : " + sheetIndex);
            XSSFSheet sheet = WorkBook.getSheetAt(sheetIndex);
            Integer skipRw = 1;
            Integer skipcnt = 1;
            //####################################### Etudiants
            if (sheetIndex == 0) {
                //Section (LIBELLE_LONG,LIBELLE_COURT)
                //Iterate over excel rows
                for (org.apache.poi.ss.usermodel.Row tempRow : sheet) {
                    if (skipcnt > skipRw) { //skip first n row for labels.
                        //Create new row in table
                        OperationBinding op_new_std = BindingContext.getCurrent()
                                                                    .getCurrentBindingsEntry()
                                                                    .getOperationBinding("CreateStudent");
                        op_new_std.execute();
                        Row rowEtu = iterEtu.getCurrentRow();
                        int Index = 0;
                        String p_nom = null;
                        String nom = null;
                        String email = null;
                        String tel = null;
                        String nin = null;
                        //Iterate over row's columns
                        for (int column = 0; column < tempRow.getLastCellNum(); column++) {
                            Cell MytempCell = tempRow.getCell(column);
                            if (MytempCell != null) {
                                Index = MytempCell.getColumnIndex();
                                if (Index == 0) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        nom = MytempCell.getStringCellValue();
                                        //UtiCree
                                        rowEtu.setAttribute("UtiCree", getUtilisateur());
                                    }
                                } else if (Index == 1) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        p_nom = MytempCell.getStringCellValue();
                                    }
                                } else if (Index == 7) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        email = MytempCell.getStringCellValue();
                                    }
                                } else if (Index == 9) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        tel = MytempCell.getStringCellValue();
                                    }
                                } else if (Index == 14) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        nin = MytempCell.getStringCellValue();
                                    }
                                } else if (Index == 23) {
                                    if (MytempCell.getStringCellValue() !=
                                        null) {
                                        //isStudentExist
                                        OperationBinding is_exist =
         BindingContext.getCurrent()
                                                                                  .getCurrentBindingsEntry()
                                                                                  .getOperationBinding("isStudentExist");
                                        is_exist.getParamsMap().put("num", MytempCell.getStringCellValue());
                                        is_exist.execute();
                                        DCIteratorBinding iterExist =
                                            (DCIteratorBinding) BindingContext.getCurrent()
                                                                                                        .getCurrentBindingsEntry()
                                                                                                        .get("isStudentExist1Iterator");
                                        if (iterExist.getEstimatedRowCount() > 0) {
                                            rowEtu.removeAndRetain();
                                            break;
                                        }
                                        rowEtu.setAttribute("Numero", MytempCell.getStringCellValue());
                                        System.out.println("Numero : " + MytempCell.getStringCellValue());
                                    }
                                } else if (Index == 24) {
                                    rowEtu.setAttribute("NumeroTable", MytempCell.getStringCellValue());
                                }
                            } else {
                                Index++;
                            }
                        }
                        System.out.println("Nom : " + nom + " Prenom : " + p_nom + " Email : " + email + " Tel : " +
                                           tel + " NIN : " + nin + " Numero Etudiant : " +
                                           rowEtu.getAttribute("Numero"));
                        if (nom == null || p_nom == null || email == null || tel == null || nin == null ||
                            rowEtu.getAttribute("Numero") == null) {
                            rowEtu.removeAndRetain();
                            System.out.println("Des champs obligatoires manques !!!");
                            OperationBinding op_rlbk = BindingContext.getCurrent()
                                                                     .getCurrentBindingsEntry()
                                                                     .getOperationBinding("Rollback");
                            op_rlbk.execute();
                        } else {
                            OperationBinding is_pers_exist = BindingContext.getCurrent()
                                                                           .getCurrentBindingsEntry()
                                                                           .getOperationBinding("isPersExist");
                            is_pers_exist.getParamsMap().put("nom", nom);
                            is_pers_exist.getParamsMap().put("p_nom", p_nom);
                            is_pers_exist.getParamsMap().put("email", email);
                            is_pers_exist.getParamsMap().put("tel", tel);
                            is_pers_exist.getParamsMap().put("nin", nin);
                            is_pers_exist.execute();
                            DCIteratorBinding iterExist =
                                (DCIteratorBinding) BindingContext.getCurrent()
                                                                                            .getCurrentBindingsEntry()
                                                                                            .get("isPersExist1Iterator");
                            if (iterExist.getEstimatedRowCount() > 0) {
                                rowEtu.setAttribute("IdPersonne", Long.parseLong(iterExist.getCurrentRow()
                                                                                          .getAttribute("IdPersonne")
                                                                                          .toString()));
                                try {
                                    System.out.println("Commiting ...");
                                    OperationBinding op_commit = BindingContext.getCurrent()
                                                                               .getCurrentBindingsEntry()
                                                                               .getOperationBinding("Commit");
                                    op_commit.execute();
                                    System.out.println("Commited");

                                } catch (Exception e) {
                                    System.out.println(e.getMessage());
                                }
                            } else {
                                OperationBinding op_rlbk = BindingContext.getCurrent()
                                                                         .getCurrentBindingsEntry()
                                                                         .getOperationBinding("Rollback");
                                op_rlbk.execute();
                            }
                        }
                    }
                    skipcnt++;
                }
            }
            // ###################################### Inscription Admin
            if (sheetIndex == 1) {
                for (org.apache.poi.ss.usermodel.Row tempRow : sheet) {
                    if (skipcnt > skipRw) { //skip first n row for labels.
                        //Create new row in table
                        OperationBinding op_new_std = BindingContext.getCurrent()
                                                                    .getCurrentBindingsEntry()
                                                                    .getOperationBinding("CreateInsAdmin");
                        op_new_std.execute();
                        Row rowInsAdmin = iterInsAdmin.getCurrentRow();
                        int Index = 0;
                        //Parcourir les colonnes de la feuille
                        for (int column = 0; column < tempRow.getLastCellNum(); column++) {
                            Cell MytempCell = tempRow.getCell(column);
                            if (MytempCell != null) {
                                Index = MytempCell.getColumnIndex();
                                if (Index == 0) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        OperationBinding is_exist =
                                            BindingContext.getCurrent()
                                                                                  .getCurrentBindingsEntry()
                                                                                  .getOperationBinding("isStudentExist");
                                        is_exist.getParamsMap().put("num", MytempCell.getStringCellValue());
                                        is_exist.execute();
                                        DCIteratorBinding iterExist =
                                            (DCIteratorBinding) BindingContext.getCurrent()
                                                                                                        .getCurrentBindingsEntry()
                                                                                                        .get("isStudentExist1Iterator");
                                        if (iterExist.getEstimatedRowCount() > 0) {
                                            rowInsAdmin.setAttribute("IdEtudiant",
                                                                     Long.parseLong(iterExist.getCurrentRow()
                                                                                                           .getAttribute("IdEtudiant")
                                                                                                           .toString()));
                                        }
                                        rowInsAdmin.setAttribute("IdAnneesUnivers", getAnnee());
                                        rowInsAdmin.setAttribute("UtiCree", getUtilisateur());
                                    }
                                } else if (Index == 1) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        OperationBinding is_exist_tf =
                                            BindingContext.getCurrent()
                                                                                     .getCurrentBindingsEntry()
                                                                                     .getOperationBinding("getTypeForm");
                                        is_exist_tf.getParamsMap().put("lib", MytempCell.getStringCellValue());
                                        is_exist_tf.execute();
                                        DCIteratorBinding iterExistTf =
                                            (DCIteratorBinding) BindingContext.getCurrent()
                                                                                                          .getCurrentBindingsEntry()
                                                                                                          .get("getTypeFormROVO1Iterator");
                                        if (iterExistTf.getEstimatedRowCount() > 0) {
                                            rowInsAdmin.setAttribute("IdTypeFormation",
                                                                     Long.parseLong(iterExistTf.getCurrentRow()
                                                                                                                  .getAttribute("IdTypeFormation")
                                                                                                                  .toString()));
                                        }
                                    }
                                } else if (Index == 2) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        OperationBinding is_exist_gf = BindingContext.getCurrent()
                                                                                     .getCurrentBindingsEntry()
                                                                                     .getOperationBinding("getGrade");
                                        is_exist_gf.getParamsMap().put("lib", MytempCell.getStringCellValue());
                                        is_exist_gf.execute();
                                        DCIteratorBinding iterExistGf =
                                            (DCIteratorBinding) BindingContext.getCurrent()
                                                                                                          .getCurrentBindingsEntry()
                                                                                                          .get("getGrade1Iterator");
                                        if (iterExistGf.getEstimatedRowCount() > 0) {
                                            rowInsAdmin.setAttribute("IdGrade", Long.parseLong(iterExistGf.getCurrentRow()
                                                                                                          .getAttribute("IdGradesFormation")
                                                                                                          .toString()));
                                        }
                                    }
                                }
                            } else {
                                Index++;
                            }
                        }
                        System.out.println("Id Etudiant : " + rowInsAdmin.getAttribute("IdEtudiant") +
                                           " Type Formation : " + rowInsAdmin.getAttribute("IdTypeFormation") +
                                           " Grade Formation : " + rowInsAdmin.getAttribute("IdGrade") + " Annee : " +
                                           rowInsAdmin.getAttribute("IdAnneesUnivers"));
                        if (rowInsAdmin.getAttribute("IdEtudiant") == null ||
                            rowInsAdmin.getAttribute("IdTypeFormation") == null ||
                            rowInsAdmin.getAttribute("IdGrade") == null ||
                            rowInsAdmin.getAttribute("IdAnneesUnivers") == null) {
                            rowInsAdmin.removeAndRetain();
                            System.out.println("Des champs obligatoires manques !!!");
                            OperationBinding op_rlbk = BindingContext.getCurrent()
                                                                     .getCurrentBindingsEntry()
                                                                     .getOperationBinding("Rollback");
                            op_rlbk.execute();
                        } else {
                            OperationBinding is_insAdmin_exist = BindingContext.getCurrent()
                                                                               .getCurrentBindingsEntry()
                                                                               .getOperationBinding("isInsAdminExist");
                            is_insAdmin_exist.getParamsMap().put("etu_id", rowInsAdmin.getAttribute("IdEtudiant"));
                            is_insAdmin_exist.getParamsMap().put("tf_id", rowInsAdmin.getAttribute("IdTypeFormation"));
                            is_insAdmin_exist.getParamsMap().put("g_id", rowInsAdmin.getAttribute("IdGrade"));
                            is_insAdmin_exist.getParamsMap().put("a_id", rowInsAdmin.getAttribute("IdAnneesUnivers"));
                            is_insAdmin_exist.execute();
                            DCIteratorBinding iterInsAdminExist =
                                (DCIteratorBinding) BindingContext.getCurrent()
                                                                                                    .getCurrentBindingsEntry()
                                                                                                    .get("isInsAdminExist1Iterator");
                            if (iterInsAdminExist.getEstimatedRowCount() > 0) {
                                System.out.println("Deja inscrit administrativement.");
                                OperationBinding op_rlbk = BindingContext.getCurrent()
                                                                         .getCurrentBindingsEntry()
                                                                         .getOperationBinding("Rollback");
                                op_rlbk.execute();

                            } else {
                                try {
                                    System.out.println("Commiting ...");
                                    OperationBinding op_commit = BindingContext.getCurrent()
                                                                               .getCurrentBindingsEntry()
                                                                               .getOperationBinding("Commit");
                                    op_commit.execute();
                                    System.out.println("Commited");

                                } catch (Exception e) {
                                    System.out.println(e.getMessage());
                                }
                            }
                        }
                    }
                    skipcnt++;
                }
            }
        }
        //###################################### Inscription Pedagogique
        for (sheetIndex = 0; sheetIndex < WorkBook.getNumberOfSheets(); sheetIndex++) {
            System.out.println("Sheet : " + sheetIndex);
            XSSFSheet sheet = WorkBook.getSheetAt(sheetIndex);
            Integer skipRw = 1;
            Integer skipcnt = 1;
            if (sheetIndex == 1) {
                System.out.println("############################ INSCRIPTION PED #################");
                for (org.apache.poi.ss.usermodel.Row tempRow : sheet) {
                    if (skipcnt > skipRw) {
                        OperationBinding op_new_insped = BindingContext.getCurrent()
                                                                       .getCurrentBindingsEntry()
                                                                       .getOperationBinding("CreateInsPed");
                        op_new_insped.execute();
                        Row rowInsPed = iterInsPed.getCurrentRow();
                        int Index = 0;
                        int etd_id = 0;
                        int tf_id = 0;
                        int gf_id = 0;
                        //Parcourir les colonnes de la feuille
                        for (int column = 0; column < tempRow.getLastCellNum(); column++) {
                            Cell MytempCell = tempRow.getCell(column);
                            if (MytempCell != null) {
                                Index = MytempCell.getColumnIndex();
                                if (Index == 0) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        System.out.println("Numro : " + MytempCell.getStringCellValue());
                                        OperationBinding is_exist =
                                            BindingContext.getCurrent()
                                                                                  .getCurrentBindingsEntry()
                                                                                  .getOperationBinding("isStudentExist");
                                        is_exist.getParamsMap().put("num", MytempCell.getStringCellValue());
                                        is_exist.execute();
                                        DCIteratorBinding iterExist =
                                            (DCIteratorBinding) BindingContext.getCurrent()
                                                                                                        .getCurrentBindingsEntry()
                                                                                                        .get("isStudentExist1Iterator");
                                        if (iterExist.getEstimatedRowCount() > 0) {
                                            etd_id = Integer.parseInt(iterExist.getCurrentRow()
                                                                               .getAttribute("IdEtudiant")
                                                                               .toString());
                                            System.out.println("Etudiant id : " + etd_id);
                                        }
                                        rowInsPed.setAttribute("UtiCree", getUtilisateur());
                                        rowInsPed.setAttribute("UtiPermetDoublIns", getUtilisateur()); //
                                        System.out.println("UtiDoubleInsc UtiCree" + getUtilisateur());
                                    }
                                } else if (Index == 1) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        OperationBinding is_exist_tf =
                                            BindingContext.getCurrent()
                                                                                     .getCurrentBindingsEntry()
                                                                                     .getOperationBinding("getTypeForm");
                                        is_exist_tf.getParamsMap().put("lib", MytempCell.getStringCellValue());
                                        is_exist_tf.execute();
                                        DCIteratorBinding iterExistTf =
                                            (DCIteratorBinding) BindingContext.getCurrent()
                                                                                                          .getCurrentBindingsEntry()
                                                                                                          .get("getTypeFormROVO1Iterator");
                                        if (iterExistTf.getEstimatedRowCount() > 0) {
                                            tf_id = Integer.parseInt(iterExistTf.getCurrentRow()
                                                                                .getAttribute("IdTypeFormation")
                                                                                .toString());
                                            System.out.println("IdTypeFormation : " + tf_id);
                                        }
                                    }
                                } else if (Index == 2) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        OperationBinding is_exist_gf = BindingContext.getCurrent()
                                                                                     .getCurrentBindingsEntry()
                                                                                     .getOperationBinding("getGrade");
                                        is_exist_gf.getParamsMap().put("lib", MytempCell.getStringCellValue());
                                        is_exist_gf.execute();
                                        DCIteratorBinding iterExistGf =
                                            (DCIteratorBinding) BindingContext.getCurrent()
                                                                                                          .getCurrentBindingsEntry()
                                                                                                          .get("getGrade1Iterator");
                                        if (iterExistGf.getEstimatedRowCount() > 0) {
                                            gf_id = Integer.parseInt(iterExistGf.getCurrentRow()
                                                                                .getAttribute("IdGradesFormation")
                                                                                .toString());
                                            System.out.println("IdGradesFormation : " + gf_id);
                                            System.out.println("Anne  : " + this.getAnnee());
                                        }
                                    }
                                } else if (Index == 3) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        OperationBinding is_exist_gf =
                                            BindingContext.getCurrent()
                                                                                     .getCurrentBindingsEntry()
                                                                                     .getOperationBinding("getHoraireTD");
                                        is_exist_gf.getParamsMap().put("lib", MytempCell.getStringCellValue());
                                        is_exist_gf.execute();
                                        DCIteratorBinding iterExist =
                                            (DCIteratorBinding) BindingContext.getCurrent()
                                                                                                        .getCurrentBindingsEntry()
                                                                                                        .get("getHoraireTD1Iterator");
                                        if (iterExist.getEstimatedRowCount() > 0) {
                                            rowInsPed.setAttribute("IdHorairesTd",
                                                                   Long.parseLong(iterExist.getCurrentRow()
                                                                                                           .getAttribute("IdHorairesTd")
                                                                                                           .toString()));
                                            System.out.println("TD : " + MytempCell.getStringCellValue() + " id : " +
                                                               iterExist.getCurrentRow()
                                                                                                                               .getAttribute("IdHorairesTd")
                                                                                                                               .toString());
                                        }
                                    }
                                } else if (Index == 4) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        OperationBinding is_exist_gf = BindingContext.getCurrent()
                                                                                     .getCurrentBindingsEntry()
                                                                                     .getOperationBinding("getStatuts");
                                        is_exist_gf.getParamsMap().put("lib", MytempCell.getStringCellValue());
                                        is_exist_gf.execute();
                                        DCIteratorBinding iterExist =
                                            (DCIteratorBinding) BindingContext.getCurrent()
                                                                                                        .getCurrentBindingsEntry()
                                                                                                        .get("getStatus1Iterator");
                                        if (iterExist.getEstimatedRowCount() > 0) {
                                            rowInsPed.setAttribute("IdStatut", Long.parseLong(iterExist.getCurrentRow()
                                                                                                       .getAttribute("IdStatut")
                                                                                                       .toString()));
                                            System.out.println("Status id : " + iterExist.getCurrentRow()
                                                                                         .getAttribute("IdStatut")
                                                                                         .toString() + " lib " +
                                                               MytempCell.getStringCellValue());
                                        }
                                    }
                                } else if (Index == 5) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        OperationBinding is_exist_gf = BindingContext.getCurrent()
                                                                                     .getCurrentBindingsEntry()
                                                                                     .getOperationBinding("getOption");
                                        is_exist_gf.getParamsMap().put("lib", MytempCell.getStringCellValue());
                                        is_exist_gf.execute();
                                        DCIteratorBinding iterExist =
                                            (DCIteratorBinding) BindingContext.getCurrent()
                                                                                                        .getCurrentBindingsEntry()
                                                                                                        .get("getOption1Iterator");
                                        if (iterExist.getEstimatedRowCount() > 0) {
                                            rowInsPed.setAttribute("IdOption", Long.parseLong(iterExist.getCurrentRow()
                                                                                                       .getAttribute("IdOption")
                                                                                                       .toString()));
                                            System.out.println("IdOption " +
                                                               rowInsPed.getAttribute("IdOption").toString());

                                        }
                                    }
                                } else if (Index == 6) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        OperationBinding is_exist_gf = BindingContext.getCurrent()
                                                                                     .getCurrentBindingsEntry()
                                                                                     .getOperationBinding("getBourse");
                                        is_exist_gf.getParamsMap().put("lib", MytempCell.getStringCellValue());
                                        is_exist_gf.execute();
                                        DCIteratorBinding iterExist =
                                            (DCIteratorBinding) BindingContext.getCurrent()
                                                                                                        .getCurrentBindingsEntry()
                                                                                                        .get("getBourse1Iterator");
                                        if (iterExist.getEstimatedRowCount() > 0) {
                                            rowInsPed.setAttribute("IdBourse", Long.parseLong(iterExist.getCurrentRow()
                                                                                                       .getAttribute("IdBourse")
                                                                                                       .toString()));
                                            System.out.println("IdBourse " +
                                                               rowInsPed.getAttribute("IdBourse").toString());
                                        }
                                    }
                                } else if (Index == 7) {
                                    System.out.println("Cohorte : " + MytempCell.getStringCellValue());
                                    if (MytempCell.getStringCellValue() != null) {
                                        OperationBinding is_exist_gf = BindingContext.getCurrent()
                                                                                     .getCurrentBindingsEntry()
                                                                                     .getOperationBinding("getCohorte");
                                        is_exist_gf.getParamsMap().put("lib", MytempCell.getStringCellValue());
                                        is_exist_gf.execute();
                                        DCIteratorBinding iterExist =
                                            (DCIteratorBinding) BindingContext.getCurrent()
                                                                                                        .getCurrentBindingsEntry()
                                                                                                        .get("getCohorte1Iterator");
                                        if (iterExist.getEstimatedRowCount() > 0) {
                                            rowInsPed.setAttribute("IdCohorte", Long.parseLong(iterExist.getCurrentRow()
                                                                                                        .getAttribute("IdCohorte")
                                                                                                        .toString()));
                                            System.out.println("IdCohorte " +
                                                               rowInsPed.getAttribute("IdCohorte").toString());
                                        }
                                    }
                                } else if (Index == 8) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        OperationBinding is_exist_gf =
                                            BindingContext.getCurrent()
                                                                                     .getCurrentBindingsEntry()
                                                                                     .getOperationBinding("getTypeConvention");
                                        is_exist_gf.getParamsMap().put("lib", MytempCell.getStringCellValue());
                                        is_exist_gf.execute();
                                        DCIteratorBinding iterExist =
                                            (DCIteratorBinding) BindingContext.getCurrent()
                                                                                                        .getCurrentBindingsEntry()
                                                                                                        .get("getTypeConvention1Iterator");
                                        if (iterExist.getEstimatedRowCount() > 0) {
                                            rowInsPed.setAttribute("IdTypeConvention",
                                                                   Long.parseLong(iterExist.getCurrentRow()
                                                                                                               .getAttribute("IdTypeConvention")
                                                                                                               .toString()));
                                            System.out.println("IdTypeConvention " +
                                                               rowInsPed.getAttribute("IdTypeConvention").toString());
                                        }
                                    }
                                } else if (Index == 9) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        OperationBinding is_exist_gf =
                                            BindingContext.getCurrent()
                                                                                     .getCurrentBindingsEntry()
                                                                                     .getOperationBinding("getOperateur");
                                        is_exist_gf.getParamsMap().put("lib", MytempCell.getStringCellValue());
                                        is_exist_gf.execute();
                                        DCIteratorBinding iterExist =
                                            (DCIteratorBinding) BindingContext.getCurrent()
                                                                                                        .getCurrentBindingsEntry()
                                                                                                        .get("getOperateur1Iterator");
                                        if (iterExist.getEstimatedRowCount() > 0) {
                                            rowInsPed.setAttribute("IdOperateur", Long.parseLong(iterExist.getCurrentRow()
                                                                                                          .getAttribute("IdOperateur")
                                                                                                          .toString()));
                                            System.out.println("IdOperateur " +
                                                               rowInsPed.getAttribute("IdOperateur").toString());
                                        }
                                    }
                                } else if (Index == 10) {
                                    rowInsPed.setAttribute("Motif", MytempCell.getStringCellValue());
                                } else if (Index == 11) {
                                    rowInsPed.setAttribute("Redoublement", (int) MytempCell.getNumericCellValue());
                                } else if (Index == 12) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        OperationBinding is_exist_gf =
                                            BindingContext.getCurrent()
                                                                                     .getCurrentBindingsEntry()
                                                                                     .getOperationBinding("getEtatInsc");
                                        is_exist_gf.getParamsMap().put("lib", MytempCell.getStringCellValue());
                                        is_exist_gf.execute();
                                        DCIteratorBinding iterExist =
                                            (DCIteratorBinding) BindingContext.getCurrent()
                                                                                                        .getCurrentBindingsEntry()
                                                                                                        .get("getEtatInsc1Iterator");
                                        if (iterExist.getEstimatedRowCount() > 0) {
                                            rowInsPed.setAttribute("EtatInscrEtatInscrId",
                                                                   Long.parseLong(iterExist.getCurrentRow()
                                                                                                                   .getAttribute("IdEtatsInscription")
                                                                                                                   .toString()));
                                            System.out.println("IdEtatsInscription " +
                                                               rowInsPed.getAttribute("EtatInscrEtatInscrId")
                                                               .toString());
                                        }
                                    }
                                } else if (Index == 13) {
                                    rowInsPed.setAttribute("Quittance", MytempCell.getStringCellValue());
                                } else if (Index == 14) {
                                    rowInsPed.setAttribute("Tarif", (int) MytempCell.getNumericCellValue());
                                } else if (Index == 15) {
                                    rowInsPed.setAttribute("NbInsc", (int) MytempCell.getNumericCellValue());
                                } else if (Index == 16) {
                                    rowInsPed.setAttribute("DernierInscription",
                                                           (int) MytempCell.getNumericCellValue());
                                } else if (Index == 17) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        if (MytempCell.getStringCellValue().equals("OUI")) {
                                            rowInsPed.setAttribute("PermetDoubleInscription", 1);
                                        }
                                    }
                                } else if (Index == 18) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        if (MytempCell.getStringCellValue().equals("OUI")) {
                                            rowInsPed.setAttribute("Assimile", 1);
                                        }
                                    }
                                } else if (Index == 19) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        if (MytempCell.getStringCellValue().equals("OUI")) {
                                            rowInsPed.setAttribute("Cartetiree", 1);
                                        }
                                    }
                                } else if (Index == 20) {
                                    rowInsPed.setAttribute("OrdreInscription", (int) MytempCell.getNumericCellValue());
                                } else if (Index == 21) {
                                    rowInsPed.setAttribute("CodeAConserver", MytempCell.getStringCellValue());
                                } else if (Index == 22) {
                                    java.util.Date date = MytempCell.getDateCellValue();
                                    DateFormat dateFormat = new SimpleDateFormat("MM/dd/yy");
                                    String date1 = dateFormat.format(date);
                                    try {
                                        date = dateFormat.parse(date1);
                                    } catch (ParseException e) {
                                    }
                                    //System.out.println("Date Format : " + date);
                                    java.sql.Date sqlDate = new java.sql.Date(date.getTime());
                                    oracle.jbo.domain.Date jboDate = new oracle.jbo.domain.Date(sqlDate);
                                    rowInsPed.setAttribute("DateEditionCarte", date);
                                }
                            } else {
                                Index++;
                            }
                        }

                        if (etd_id == 0 || tf_id == 0 || gf_id == 0 || this.getAnnee() == null ||
                            rowInsPed.getAttribute("IdHorairesTd") == null ||
                            rowInsPed.getAttribute("IdStatut") == null || rowInsPed.getAttribute("IdOption") == null ||
                            rowInsPed.getAttribute("IdBourse") == null || rowInsPed.getAttribute("IdCohorte") == null ||
                            rowInsPed.getAttribute("IdTypeConvention") == null ||
                            rowInsPed.getAttribute("IdOperateur") == null ||
                            rowInsPed.getAttribute("EtatInscrEtatInscrId") == null) {
                            rowInsPed.removeAndRetain();
                            System.out.println("Des champs obligatoires manques !!!");
                            OperationBinding op_rlbk = BindingContext.getCurrent()
                                                                     .getCurrentBindingsEntry()
                                                                     .getOperationBinding("Rollback");
                            op_rlbk.execute();
                        } else {
                            System.out.println("Etudiant id : " + etd_id + " Type formation id : " + tf_id +
                                               " grade id : " + gf_id + " An id : " + getAnnee());

                            //getinsAdmin
                            OperationBinding op_exist = BindingContext.getCurrent()
                                                                      .getCurrentBindingsEntry()
                                                                      .getOperationBinding("getinsAdmin");
                            op_exist.getParamsMap().put("etu", etd_id);
                            op_exist.getParamsMap().put("typef", tf_id);
                            op_exist.getParamsMap().put("grade", gf_id);
                            op_exist.getParamsMap().put("annee", getAnnee());
                            op_exist.execute();
                            DCIteratorBinding iterext = (DCIteratorBinding) BindingContext.getCurrent()
                                                                                          .getCurrentBindingsEntry()
                                                                                          .get("getInsAdmin1Iterator");
                            if (iterext.getEstimatedRowCount() > 0) {
                                System.out.println("IdInscriptionAdmin : " + iterext.getCurrentRow()
                                                                                    .getAttribute("IdInscriptionAdmin")
                                                                                    .toString());
                                rowInsPed.setAttribute("IdInscriptionAdmin", Integer.parseInt(iterext.getCurrentRow()
                                                                                                     .getAttribute("IdInscriptionAdmin")
                                                                                                     .toString()));
                                OperationBinding get_prcrs = BindingContext.getCurrent()
                                                                           .getCurrentBindingsEntry()
                                                                           .getOperationBinding("getPrcrsMaqAnnee");
                                get_prcrs.getParamsMap().put("anne_id", this.getAnnee());
                                get_prcrs.getParamsMap().put("nfp_id", this.getParcours());
                                get_prcrs.execute();
                                DCIteratorBinding iterPrcrs =
                                    (DCIteratorBinding) BindingContext.getCurrent()
                                                                                                .getCurrentBindingsEntry()
                                                                                                .get("getParcoursMaqAnnee1Iterator");
                                if (iterPrcrs.getEstimatedRowCount() == 1) {
                                    rowInsPed.setAttribute("IdParcoursMaquetAnnee",
                                                           Integer.parseInt(iterPrcrs.getCurrentRow()
                                                                                                              .getAttribute("IdParcoursMaquetAnnee")
                                                                                                              .toString()));

                                    OperationBinding is_insPed_exist =
                                        BindingContext.getCurrent()
                                                                                     .getCurrentBindingsEntry()
                                                                                     .getOperationBinding("isInsPedExist");
                                    is_insPed_exist.getParamsMap()
                                        .put("ins_adm_id",
                                             Integer.parseInt(iterext.getCurrentRow()
                                                                                                             .getAttribute("IdInscriptionAdmin")
                                                                                                             .toString()));
                                    is_insPed_exist.getParamsMap()
                                        .put("prcrs_maq_an_id",
                                             Integer.parseInt(iterPrcrs.getCurrentRow()
                                                                                                                    .getAttribute("IdParcoursMaquetAnnee")
                                                                                                                    .toString()));
                                    is_insPed_exist.execute();
                                    DCIteratorBinding iterInsPedExist =
                                        (DCIteratorBinding) BindingContext.getCurrent()
                                                                                                          .getCurrentBindingsEntry()
                                                                                                          .get("isInsPedExistROVO1Iterator");
                                    if (iterInsPedExist.getEstimatedRowCount() > 0) {
                                        System.out.println("Insped existant Id : " + iterInsPedExist.getCurrentRow()
                                                                                                    .getAttribute("IdInscriptionPedagogique")
                                                                                                    .toString());
                                        OperationBinding op_rlbk = BindingContext.getCurrent()
                                                                                 .getCurrentBindingsEntry()
                                                                                 .getOperationBinding("Rollback");
                                        op_rlbk.execute();
                                    } else {
                                        try {

                                            System.out.println("Commiting ...");
                                            OperationBinding op_commit = BindingContext.getCurrent()
                                                                                       .getCurrentBindingsEntry()
                                                                                       .getOperationBinding("Commit");
                                            op_commit.execute();
                                            System.out.println("Commited");
                                        } catch (Exception e) {
                                            System.out.println(e.getMessage());
                                        }
                                    }
                                } else {
                                    OperationBinding op_rlbk = BindingContext.getCurrent()
                                                                             .getCurrentBindingsEntry()
                                                                             .getOperationBinding("Rollback");
                                    op_rlbk.execute();
                                }
                            } else {
                                OperationBinding op_rlbk = BindingContext.getCurrent()
                                                                         .getCurrentBindingsEntry()
                                                                         .getOperationBinding("Rollback");
                                op_rlbk.execute();
                            }

                        }
                    }
                    skipcnt++;
                }
            }
        }
        //############################ INSCRIPTION PEDAGOGIQUE SEMESTRE
        for (sheetIndex = 0; sheetIndex < WorkBook.getNumberOfSheets(); sheetIndex++) {
            System.out.println("Sheet : " + sheetIndex);
            XSSFSheet sheet = WorkBook.getSheetAt(sheetIndex);
            Integer skipRw = 1;
            Integer skipcnt = 1;
            if (sheetIndex == 1) {
                System.out.println("############################ INSCRIPTION PED SEM #################");
                for (org.apache.poi.ss.usermodel.Row tempRow : sheet) {
                    if (skipcnt > skipRw) {
                        OperationBinding op_new_insped = BindingContext.getCurrent()
                                                                       .getCurrentBindingsEntry()
                                                                       .getOperationBinding("CreateInsPedSem");
                        op_new_insped.execute();
                        Row rowInsPedSem = iterInsPedSem.getCurrentRow();
                        int Index = 0;
                        int etd_id = 0;
                        int tf_id = 0;
                        int gf_id = 0;
                        //Parcourir les colonnes de la feuille
                        for (int column = 0; column < tempRow.getLastCellNum(); column++) {
                            Cell MytempCell = tempRow.getCell(column);
                            if (MytempCell != null) {
                                Index = MytempCell.getColumnIndex();
                                if (Index == 0) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        System.out.println("Numro : " + MytempCell.getStringCellValue());
                                        OperationBinding is_exist =
                                            BindingContext.getCurrent()
                                                                                  .getCurrentBindingsEntry()
                                                                                  .getOperationBinding("isStudentExist");
                                        is_exist.getParamsMap().put("num", MytempCell.getStringCellValue());
                                        is_exist.execute();
                                        DCIteratorBinding iterExist =
                                            (DCIteratorBinding) BindingContext.getCurrent()
                                                                                                        .getCurrentBindingsEntry()
                                                                                                        .get("isStudentExist1Iterator");
                                        if (iterExist.getEstimatedRowCount() > 0) {
                                            etd_id = Integer.parseInt(iterExist.getCurrentRow()
                                                                               .getAttribute("IdEtudiant")
                                                                               .toString());
                                        }
                                        rowInsPedSem.setAttribute("UtiCree", getUtilisateur());
                                        rowInsPedSem.setAttribute("IdSemestre", getSemestre()); //
                                    }
                                } else if (Index == 1) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        OperationBinding is_exist_tf =
                                            BindingContext.getCurrent()
                                                                                     .getCurrentBindingsEntry()
                                                                                     .getOperationBinding("getTypeForm");
                                        is_exist_tf.getParamsMap().put("lib", MytempCell.getStringCellValue());
                                        is_exist_tf.execute();
                                        DCIteratorBinding iterExistTf =
                                            (DCIteratorBinding) BindingContext.getCurrent()
                                                                                                          .getCurrentBindingsEntry()
                                                                                                          .get("getTypeFormROVO1Iterator");
                                        if (iterExistTf.getEstimatedRowCount() > 0) {
                                            tf_id = Integer.parseInt(iterExistTf.getCurrentRow()
                                                                                .getAttribute("IdTypeFormation")
                                                                                .toString());

                                        }
                                    }
                                } else if (Index == 2) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        System.out.println("Grade : " + MytempCell.getStringCellValue());
                                        OperationBinding is_exist_gf = BindingContext.getCurrent()
                                                                                     .getCurrentBindingsEntry()
                                                                                     .getOperationBinding("getGrade");
                                        is_exist_gf.getParamsMap().put("lib", MytempCell.getStringCellValue());
                                        is_exist_gf.execute();
                                        DCIteratorBinding iterExistGf =
                                            (DCIteratorBinding) BindingContext.getCurrent()
                                                                                                          .getCurrentBindingsEntry()
                                                                                                          .get("getGrade1Iterator");
                                        if (iterExistGf.getEstimatedRowCount() > 0) {
                                            gf_id = Integer.parseInt(iterExistGf.getCurrentRow()
                                                                                .getAttribute("IdGradesFormation")
                                                                                .toString());
                                        }
                                    }
                                } else if (Index == 23) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        System.out.println("InsPedValide : " + MytempCell.getStringCellValue());
                                        if (MytempCell.getStringCellValue().equals("OUI")) {
                                            rowInsPedSem.setAttribute("InsPedValide", 1);
                                        }
                                    }
                                } else if (Index == 24) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        System.out.println("PassExam : " + MytempCell.getStringCellValue());
                                        if (MytempCell.getStringCellValue().equals("OUI")) {
                                            rowInsPedSem.setAttribute("PassExam", 1);
                                        }
                                    }
                                } else if (Index == 25) {
                                    rowInsPedSem.setAttribute("CumulCredit", (int) MytempCell.getNumericCellValue());
                                } else if (Index == 26) {
                                    rowInsPedSem.setAttribute("DetteCredit", (int) MytempCell.getNumericCellValue());
                                }
                            } else {
                                Index++;
                            }
                        }
                        if (etd_id == 0 || tf_id == 0 || gf_id == 0 || this.getSemestre() == null) {
                            rowInsPedSem.removeAndRetain();
                            System.out.println("Des champs obligatoires manques !!!");
                            OperationBinding op_rlbk = BindingContext.getCurrent()
                                                                     .getCurrentBindingsEntry()
                                                                     .getOperationBinding("Rollback");
                            op_rlbk.execute();
                        } else {
                            System.out.println("Etudiant id : " + etd_id + " Type formation id : " + tf_id +
                                               " grade id : " + gf_id + " An id : " + getAnnee());

                            //getinsPed
                            OperationBinding op_ins_ped = BindingContext.getCurrent()
                                                                        .getCurrentBindingsEntry()
                                                                        .getOperationBinding("getInsPed");
                            op_ins_ped.getParamsMap().put("etu", etd_id);
                            op_ins_ped.getParamsMap().put("typef", tf_id);
                            op_ins_ped.getParamsMap().put("gade", gf_id);
                            op_ins_ped.getParamsMap().put("annee", getAnnee());
                            op_ins_ped.execute();
                            DCIteratorBinding iterext = (DCIteratorBinding) BindingContext.getCurrent()
                                                                                          .getCurrentBindingsEntry()
                                                                                          .get("getInsPed1Iterator");
                            if (iterext.getEstimatedRowCount() > 0) {
                                System.out.println("IdInscriptionPed : " + iterext.getCurrentRow()
                                                                                  .getAttribute("IdInscriptionPedagogique")
                                                                                  .toString());
                                rowInsPedSem.setAttribute("IdInscriptionPedagogique",
                                                          Integer.parseInt(iterext.getCurrentRow()
                                                                                                              .getAttribute("IdInscriptionPedagogique")
                                                                                                              .toString()));
                                OperationBinding is_insPedSem_exist =
                                    BindingContext.getCurrent()
                                                                                    .getCurrentBindingsEntry()
                                                                                    .getOperationBinding("isinsPedSemExist");

                                is_insPedSem_exist.getParamsMap()
                                    .put("id_insped",
                                         Integer.parseInt(iterext.getCurrentRow()
                                                                                                           .getAttribute("IdInscriptionPedagogique")
                                                                                                           .toString()));
                                is_insPedSem_exist.getParamsMap().put("sem_id", getSemestre());
                                is_insPedSem_exist.execute();
                                DCIteratorBinding iterInsPedSemExist =
                                    (DCIteratorBinding) BindingContext.getCurrent()
                                                                                                         .getCurrentBindingsEntry()
                                                                                                         .get("isInsPedSemExist1Iterator");
                                if (iterInsPedSemExist.getEstimatedRowCount() > 0) {
                                    System.out.println("InspedSem existant Id : " + iterInsPedSemExist.getCurrentRow()
                                                                                                      .getAttribute("IdInscriptionPedSemestre")
                                                                                                      .toString());
                                    OperationBinding op_rlbk = BindingContext.getCurrent()
                                                                             .getCurrentBindingsEntry()
                                                                             .getOperationBinding("Rollback");
                                    op_rlbk.execute();
                                } else {
                                    try {

                                        System.out.println("Commiting ...");
                                        OperationBinding op_commit = BindingContext.getCurrent()
                                                                                   .getCurrentBindingsEntry()
                                                                                   .getOperationBinding("Commit");
                                        op_commit.execute();
                                        System.out.println("Commited");
                                    } catch (Exception e) {
                                        System.out.println(e.getMessage());
                                    }

                                }
                            } else {
                                OperationBinding op_rlbk = BindingContext.getCurrent()
                                                                         .getCurrentBindingsEntry()
                                                                         .getOperationBinding("Rollback");
                                op_rlbk.execute();
                            }

                        }
                    }
                    skipcnt++;
                }
            }
        }
        ////############################ INSCRIPTION PEDAGOGIQUE SEMESTRE_UE
        for (sheetIndex = 0; sheetIndex < WorkBook.getNumberOfSheets(); sheetIndex++) {
            System.out.println("Sheet : " + sheetIndex);
            XSSFSheet sheet = WorkBook.getSheetAt(sheetIndex);
            Integer skipRw = 1;
            Integer skipcnt = 1;
            if (sheetIndex == 1) {
                System.out.println("############################ INSCRIPTION PED SEM UE #################");
                for (org.apache.poi.ss.usermodel.Row tempRow : sheet) {
                    if (skipcnt > skipRw) {
                        int Index = 0;
                        int etd_id = 0;
                        int tf_id = 0;
                        int gf_id = 0;
                        //Parcourir les colonnes de la feuille
                        for (int column = 0; column < tempRow.getLastCellNum(); column++) {
                            Cell MytempCell = tempRow.getCell(column);
                            if (MytempCell != null) {
                                Index = MytempCell.getColumnIndex();
                                if (Index == 0) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        System.out.println("Numro : " + MytempCell.getStringCellValue());
                                        OperationBinding is_exist =
                                            BindingContext.getCurrent()
                                                                                  .getCurrentBindingsEntry()
                                                                                  .getOperationBinding("isStudentExist");
                                        is_exist.getParamsMap().put("num", MytempCell.getStringCellValue());
                                        is_exist.execute();
                                        DCIteratorBinding iterExist =
                                            (DCIteratorBinding) BindingContext.getCurrent()
                                                                                                        .getCurrentBindingsEntry()
                                                                                                        .get("isStudentExist1Iterator");
                                        if (iterExist.getEstimatedRowCount() > 0) {
                                            etd_id = Integer.parseInt(iterExist.getCurrentRow()
                                                                               .getAttribute("IdEtudiant")
                                                                               .toString());
                                        }

                                    }
                                } else if (Index == 1) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        OperationBinding is_exist_tf =
                                            BindingContext.getCurrent()
                                                                                     .getCurrentBindingsEntry()
                                                                                     .getOperationBinding("getTypeForm");
                                        is_exist_tf.getParamsMap().put("lib", MytempCell.getStringCellValue());
                                        is_exist_tf.execute();
                                        DCIteratorBinding iterExistTf =
                                            (DCIteratorBinding) BindingContext.getCurrent()
                                                                                                          .getCurrentBindingsEntry()
                                                                                                          .get("getTypeFormROVO1Iterator");
                                        if (iterExistTf.getEstimatedRowCount() > 0) {
                                            tf_id = Integer.parseInt(iterExistTf.getCurrentRow()
                                                                                .getAttribute("IdTypeFormation")
                                                                                .toString());

                                        }
                                    }
                                } else if (Index == 2) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        System.out.println("Grade : " + MytempCell.getStringCellValue());
                                        OperationBinding is_exist_gf = BindingContext.getCurrent()
                                                                                     .getCurrentBindingsEntry()
                                                                                     .getOperationBinding("getGrade");
                                        is_exist_gf.getParamsMap().put("lib", MytempCell.getStringCellValue());
                                        is_exist_gf.execute();
                                        DCIteratorBinding iterExistGf =
                                            (DCIteratorBinding) BindingContext.getCurrent()
                                                                                                          .getCurrentBindingsEntry()
                                                                                                          .get("getGrade1Iterator");
                                        if (iterExistGf.getEstimatedRowCount() > 0) {
                                            gf_id = Integer.parseInt(iterExistGf.getCurrentRow()
                                                                                .getAttribute("IdGradesFormation")
                                                                                .toString());
                                        }
                                    }
                                }
                            } else {
                                Index++;
                            }
                        }
                        if (listfilUeSem.size() == 0 || etd_id == 0 || tf_id == 0 || gf_id == 0 ||
                            this.getSemestre() == null || this.getAnnee() == null || this.getParcours() == null) {
                            System.out.println("Des champs obligatoires manques !!!");
                        } else {
                            OperationBinding inspedsem = BindingContext.getCurrent()
                                                                       .getCurrentBindingsEntry()
                                                                       .getOperationBinding("getInsPedSem");
                            inspedsem.getParamsMap().put("annee", getAnnee());
                            inspedsem.getParamsMap().put("etu", etd_id);
                            inspedsem.getParamsMap().put("gade", gf_id);
                            inspedsem.getParamsMap().put("s_id", getSemestre());
                            inspedsem.getParamsMap().put("typef", tf_id);
                            inspedsem.execute();
                            DCIteratorBinding iterinsped =
                                (DCIteratorBinding) BindingContext.getCurrent()
                                                                                             .getCurrentBindingsEntry()
                                                                                             .get("getInsPedSem1Iterator");
                            if (iterinsped.getEstimatedRowCount() > 0) {
                                for (int i = 0; i < listfilUeSem.size(); i++) {
                                    OperationBinding op_new_insped =
                                        BindingContext.getCurrent()
                                                                                   .getCurrentBindingsEntry()
                                                                                   .getOperationBinding("CreateInPedSemUe");
                                    op_new_insped.execute();
                                    Row rowInsPedSemUe = iterInsPedSemUe.getCurrentRow();
                                    rowInsPedSemUe.setAttribute("UtiCree", getUtilisateur());
                                    rowInsPedSemUe.setAttribute("IdFiliereUeSemstre", listfilUeSem.get(i));
                                    rowInsPedSemUe.setAttribute("IdInscriptionPedSemestre",
                                                                Integer.parseInt(iterinsped.getCurrentRow()
                                                                                                                       .getAttribute("IdInscriptionPedSemestre")
                                                                                                                       .toString()));
                                    //isInsPedSemUeExist
                                    OperationBinding is_inspedsem_ue =
                                        BindingContext.getCurrent()
                                                                                     .getCurrentBindingsEntry()
                                                                                     .getOperationBinding("isInsPedSemUeExist");
                                    is_inspedsem_ue.getParamsMap()
                                        .put("ins_ped_sem_id", rowInsPedSemUe.getAttribute("IdInscriptionPedSemestre"));
                                    is_inspedsem_ue.getParamsMap()
                                        .put("fil_ue_sem_id", rowInsPedSemUe.getAttribute("IdFiliereUeSemstre"));
                                    is_inspedsem_ue.execute();
                                    DCIteratorBinding iterinspedsemue =
                                        (DCIteratorBinding) BindingContext.getCurrent()
                                                                                                          .getCurrentBindingsEntry()
                                                                                                          .get("isInsPedSemUeExist1Iterator");
                                    if (iterinspedsemue.getEstimatedRowCount() > 0) {
                                        System.out.println("InsPedSemUE exist !!!");
                                        rowInsPedSemUe.removeAndRetain();
                                        OperationBinding op_rlbk = BindingContext.getCurrent()
                                                                                 .getCurrentBindingsEntry()
                                                                                 .getOperationBinding("Rollback");
                                        op_rlbk.execute();
                                    } else {
                                        try {

                                            System.out.println("Commiting ...");
                                            OperationBinding op_commit = BindingContext.getCurrent()
                                                                                       .getCurrentBindingsEntry()
                                                                                       .getOperationBinding("Commit");
                                            op_commit.execute();
                                            System.out.println("Commited");
                                        } catch (Exception e) {
                                            System.out.println(e.getMessage());
                                        }
                                    }
                                }
                            } else {
                                System.out.println("Pas Encore inscrit pedagogiquement !!!");
                            }
                        }
                    }
                    skipcnt++;
                }
            }
        }
        this.getPopupImportEtu().hide();
    }

    /**
     * Method to read xlsx file and upload to table.
     * @param myxls
     * @throws IOException
     */
    @SuppressWarnings({ "oracle.jdeveloper.java.insufficient-catch-block", "unchecked" })
    public void readNProcessExcelx(InputStream xlsx) throws IOException {
        //store exist lib section
        ArrayList<String> existSectionList = new ArrayList<String>();
        ArrayList<String> existEtabList = new ArrayList<String>();
        ArrayList<String> existDeptList = new ArrayList<String>();

        DCIteratorBinding iterSect = (DCIteratorBinding) BindingContext.getCurrent()
                                                                       .getCurrentBindingsEntry()
                                                                       .get("TypeSectionsIterator");
        DCIteratorBinding iterStruct = (DCIteratorBinding) BindingContext.getCurrent()
                                                                         .getCurrentBindingsEntry()
                                                                         .get("StructuresIterator1");
        DCIteratorBinding iterHStruct = (DCIteratorBinding) BindingContext.getCurrent()
                                                                          .getCurrentBindingsEntry()
                                                                          .get("HistoriquesStructuresStructIterator");
        DCIteratorBinding iterDomaine = (DCIteratorBinding) BindingContext.getCurrent()
                                                                          .getCurrentBindingsEntry()
                                                                          .get("DomainesIterator");
        DCIteratorBinding iterMention = (DCIteratorBinding) BindingContext.getCurrent()
                                                                          .getCurrentBindingsEntry()
                                                                          .get("MentionsDomainesIterator");
        DCIteratorBinding iterSpecialite = (DCIteratorBinding) BindingContext.getCurrent()
                                                                             .getCurrentBindingsEntry()
                                                                             .get("SpecialitesMentionsIterator");
        DCIteratorBinding iterFormation = (DCIteratorBinding) BindingContext.getCurrent()
                                                                            .getCurrentBindingsEntry()
                                                                            .get("FormationsVO1Iterator");
        DCIteratorBinding iterNivFormation = (DCIteratorBinding) BindingContext.getCurrent()
                                                                               .getCurrentBindingsEntry()
                                                                               .get("NiveauxFormationsIterator");
        DCIteratorBinding iterUe = (DCIteratorBinding) BindingContext.getCurrent()
                                                                     .getCurrentBindingsEntry()
                                                                     .get("UesIterator");
        DCIteratorBinding iterEc = (DCIteratorBinding) BindingContext.getCurrent()
                                                                     .getCurrentBindingsEntry()
                                                                     .get("EcsIterator");
        DCIteratorBinding iterMaquette = (DCIteratorBinding) BindingContext.getCurrent()
                                                                           .getCurrentBindingsEntry()
                                                                           .get("MaquettesIterator");
        DCIteratorBinding iterFilUe = (DCIteratorBinding) BindingContext.getCurrent()
                                                                        .getCurrentBindingsEntry()
                                                                        .get("FiliereUeSemstresIterator");
        DCIteratorBinding iterFilEc = (DCIteratorBinding) BindingContext.getCurrent()
                                                                        .getCurrentBindingsEntry()
                                                                        .get("FiliereUeSemstreEcIterator");
        DCIteratorBinding iterNivFromMaqAnn =
            (DCIteratorBinding) BindingContext.getCurrent()
                                                                                .getCurrentBindingsEntry()
                                                                                .get("NiveauFormationMaquetteAnnesIterator");
        DCIteratorBinding iterDroitNivPays = (DCIteratorBinding) BindingContext.getCurrent()
                                                                               .getCurrentBindingsEntry()
                                                                               .get("DroitNiveauPaysVOIterator");
        DCIteratorBinding iterGrade = (DCIteratorBinding) BindingContext.getCurrent()
                                                                        .getCurrentBindingsEntry()
                                                                        .get("GradesFormationIterator");
        DCIteratorBinding iterOption = (DCIteratorBinding) BindingContext.getCurrent()
                                                                         .getCurrentBindingsEntry()
                                                                         .get("OptionsSpecialitesIterator");
        DCIteratorBinding iterFormSpec = (DCIteratorBinding) BindingContext.getCurrent()
                                                                           .getCurrentBindingsEntry()
                                                                           .get("FormationsSpecialitesIterator");
        //DroitNiveauPaysVOIterator
        //Use XSSFWorkbook for XLS file
        XSSFWorkbook WorkBook = null;
        int sheetIndex = 0;
        try {
            WorkBook = new XSSFWorkbook(xlsx);
        } catch (IOException e) {

        }
        System.out.println("Nombre de feuille : " + WorkBook.getNumberOfSheets());
        for (sheetIndex = 0; sheetIndex < WorkBook.getNumberOfSheets(); sheetIndex++) {
            System.out.println("Sheet : " + sheetIndex);
            XSSFSheet sheet = WorkBook.getSheetAt(sheetIndex);
            Integer skipRw = 1;
            Integer skipcnt = 1;
            //Import Sections
            if (sheetIndex == 0) {
                System.out.println("Titre feuille : " + WorkBook.getSheetAt(sheetIndex).getSheetName());
                //Section (LIBELLE_LONG,LIBELLE_COURT)
                //Iterate over excel rows
                for (org.apache.poi.ss.usermodel.Row tempRow : sheet) {
                    if (skipcnt > skipRw) { //skip first n row for labels.
                        //Create new row in table
                        OperationBinding op_new_ts = BindingContext.getCurrent()
                                                                   .getCurrentBindingsEntry()
                                                                   .getOperationBinding("CreateTypeSection");
                        op_new_ts.execute();
                        Row rowSect = iterSect.getCurrentRow();
                        int Index = 0;
                        //Iterate over row's columns
                        for (int column = 0; column < tempRow.getLastCellNum(); column++) {
                            Cell MytempCell = tempRow.getCell(column);
                            if (MytempCell != null) {
                                Index = MytempCell.getColumnIndex();
                                if (Index == 1) {
                                    if (MytempCell.getStringCellValue() !=
                                        null) {
                                        //isSectionExist
                                        OperationBinding is_exist =
         BindingContext.getCurrent()
                                                                                  .getCurrentBindingsEntry()
                                                                                  .getOperationBinding("isSectionExist");
                                        is_exist.getParamsMap().put("lib", MytempCell.getStringCellValue());
                                        is_exist.execute();
                                        DCIteratorBinding iterExist =
                                            (DCIteratorBinding) BindingContext.getCurrent()
                                                                                                        .getCurrentBindingsEntry()
                                                                                                        .get("isSectionExistROVOIterator");
                                        if (iterExist.getEstimatedRowCount() > 0) {
                                            //iter.getCurrentRow().remove();
                                            /* existSectionList.add(MytempCell.getStringCellValue());
                                                        System.out.println("Section " + MytempCell.getStringCellValue() +
                                                                           " Existant !!!"); */
                                            rowSect.removeAndRetain();
                                            break;
                                        }
                                        //System.out.println("LibelleLong : " + MytempCell.getStringCellValue());
                                        rowSect.setAttribute("LibelleLong", MytempCell.getStringCellValue());
                                        //UtiCree
                                        rowSect.setAttribute("UtiCree", getUtilisateur());
                                    }
                                } else if (Index == 2) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        //System.out.println("LibelleCourt : " + MytempCell.getStringCellValue());
                                        rowSect.setAttribute("LibelleCourt", MytempCell.getStringCellValue());
                                    }
                                }
                            } else {
                                Index++;
                            }
                        }
                        //System.out.println("Is row section null : " + (rowSect.getAttribute("LibelleLong") == null));
                        if (rowSect.getAttribute("LibelleLong") == null) {
                            //System.out.println("Ligne Section vide");
                            rowSect.removeAndRetain();
                        }
                        try {
                            OperationBinding op_commit = BindingContext.getCurrent()
                                                                       .getCurrentBindingsEntry()
                                                                       .getOperationBinding("Commit");
                            op_commit.execute();

                        } catch (Exception e) {
                            System.out.println(e.getMessage());
                        }
                    }
                    skipcnt++;
                }
            }
            //Import Structure(Etab)

            if (sheetIndex == 1) {
                System.out.println("Titre feuille : " + WorkBook.getSheetAt(sheetIndex).getSheetName());
                //Iterate over excel rows
                for (org.apache.poi.ss.usermodel.Row tempRow : sheet) {
                    if (skipcnt > skipRw) { //skip first n row for labels.
                        //Create new row in table
                        OperationBinding op_new_s = BindingContext.getCurrent()
                                                                  .getCurrentBindingsEntry()
                                                                  .getOperationBinding("CreateStructure");
                        op_new_s.execute();
                        Row rowEtab = iterStruct.getCurrentRow();
                        int Index = 0;
                        //Iterate over row's columns
                        for (int column = 0; column < tempRow.getLastCellNum(); column++) {
                            Cell MytempCell = tempRow.getCell(column);
                            if (MytempCell != null) {
                                Index = MytempCell.getColumnIndex();
                                if (Index == 1) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        //isEtabExist
                                        OperationBinding is_exist = BindingContext.getCurrent()
                                                                                  .getCurrentBindingsEntry()
                                                                                  .getOperationBinding("isEtabExist");
                                        is_exist.getParamsMap().put("lib", MytempCell.getStringCellValue());
                                        is_exist.execute();
                                        DCIteratorBinding iterExist =
                                            (DCIteratorBinding) BindingContext.getCurrent()
                                                                                                        .getCurrentBindingsEntry()
                                                                                                        .get("isEtabExistROVO1Iterator");
                                        if (iterExist.getEstimatedRowCount() > 0) {
                                            //iter.getCurrentRow().remove();
                                            //existEtabList.add(MytempCell.getStringCellValue());
                                            //System.out.println("Etablissement " + MytempCell.getStringCellValue() +
                                            // " Existant !!!");
                                            rowEtab.removeAndRetain();
                                            break;
                                        }
                                        //System.out.println("LibelleLong : " + MytempCell.getStringCellValue());
                                        rowEtab.setAttribute("LibelleLong", MytempCell.getStringCellValue());
                                        //UtiCree
                                        rowEtab.setAttribute("UtiCree", getUtilisateur());
                                    }
                                } else if (Index == 2) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        // System.out.println("LibelleCourt : " + MytempCell.getStringCellValue());
                                        rowEtab.setAttribute("LibelleCourt", MytempCell.getStringCellValue());
                                    }
                                } else if (Index == 3) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        //System.out.println("Adresse : " + MytempCell.getStringCellValue());
                                        rowEtab.setAttribute("Adresse", MytempCell.getStringCellValue());
                                    }
                                } else if (Index == 4) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        //System.out.println("Email : " + MytempCell.getStringCellValue());
                                        rowEtab.setAttribute("Email", MytempCell.getStringCellValue());
                                    }
                                } else if (Index == 5) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        //System.out.println("Telephone : " + MytempCell.getStringCellValue());
                                        rowEtab.setAttribute("Telephone", MytempCell.getStringCellValue());
                                    }
                                } else if (Index == 6) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        //System.out.println("Fax : " + MytempCell.getStringCellValue());
                                        rowEtab.setAttribute("Fax", MytempCell.getStringCellValue());
                                    }
                                } else if (Index == 7) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        OperationBinding is_exist_p = BindingContext.getCurrent()
                                                                                    .getCurrentBindingsEntry()
                                                                                    .getOperationBinding("isEtabExist");
                                        is_exist_p.getParamsMap().put("lib", MytempCell.getStringCellValue());
                                        is_exist_p.execute();
                                        DCIteratorBinding iterExist =
                                            (DCIteratorBinding) BindingContext.getCurrent()
                                                                                                        .getCurrentBindingsEntry()
                                                                                                        .get("isEtabExistROVO1Iterator");
                                        if (iterExist.getEstimatedRowCount() > 0) {
                                            rowEtab.setAttribute("StructureParent",
                                                                 Integer.parseInt(iterExist.getCurrentRow()
                                                                                                              .getAttribute("IdStructure")
                                                                                                              .toString()));
                                            /* System.out.println("StructureParent " + iterExist.getCurrentRow()
                                                                                                         .getAttribute("IdStructure")
                                                                                                         .toString()); */
                                        }
                                    }
                                } else if (Index == 8) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        OperationBinding is_exist_t =
                                            BindingContext.getCurrent()
                                                                                    .getCurrentBindingsEntry()
                                                                                    .getOperationBinding("isSectionExist");
                                        is_exist_t.getParamsMap().put("lib", MytempCell.getStringCellValue());
                                        is_exist_t.execute();
                                        DCIteratorBinding iterExist_s =
                                            (DCIteratorBinding) BindingContext.getCurrent()
                                                                                                          .getCurrentBindingsEntry()
                                                                                                          .get("isSectionExistROVOIterator");
                                        if (iterExist_s.getEstimatedRowCount() > 0) {
                                            rowEtab.setAttribute("IdTypeSection",
                                                                 Integer.parseInt(iterExist_s.getCurrentRow()
                                                                                                              .getAttribute("IdTypeSection")
                                                                                                              .toString()));
                                            /* System.out.println("IdTypeSection " + iterExist_s.getCurrentRow()
                                                                                                         .getAttribute("IdTypeSection")
                                                                                                         .toString()); */
                                        }
                                    }
                                } else if (Index == 9) {
                                    //System.out.println("Niveau : " + (int) MytempCell.getNumericCellValue());
                                    rowEtab.setAttribute("Niveau", (int) MytempCell.getNumericCellValue());
                                } else if (Index == 10) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        //System.out.println("Url : " + MytempCell.getStringCellValue());
                                        rowEtab.setAttribute("Url", MytempCell.getStringCellValue());
                                    }
                                } else if (Index == 11) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        //System.out.println("HoraireTravail : " + MytempCell.getStringCellValue());
                                        rowEtab.setAttribute("HoraireTravail", MytempCell.getStringCellValue());
                                    }
                                }
                            } else {
                                Index++;
                            }
                        }
                        //System.out.println("Is row Etab null : " + (rowEtab.getAttribute("LibelleLong") == null));
                        if (rowEtab.getAttribute("LibelleLong") == null) {
                            //System.out.println("Ligne Etablissement vide");
                            rowEtab.removeAndRetain();
                            OperationBinding op_rbk = BindingContext.getCurrent()
                                                                    .getCurrentBindingsEntry()
                                                                    .getOperationBinding("Rollback");
                            op_rbk.execute();
                        }
                        try {
                            OperationBinding op_commit_et = BindingContext.getCurrent()
                                                                          .getCurrentBindingsEntry()
                                                                          .getOperationBinding("Commit");
                            op_commit_et.execute();

                        } catch (Exception e) {
                            //System.out.println(e.getMessage());
                            OperationBinding op_rbk = BindingContext.getCurrent()
                                                                    .getCurrentBindingsEntry()
                                                                    .getOperationBinding("Rollback");
                            op_rbk.execute();
                        }
                    }
                    skipcnt++;
                }
            }
            //Import HistoriqueStructure(Departement)
            if (sheetIndex == 2) {
                System.out.println("Titre feuille : " + WorkBook.getSheetAt(sheetIndex).getSheetName());
                //Iterate over excel rows
                for (org.apache.poi.ss.usermodel.Row tempRow : sheet) {
                    if (skipcnt > skipRw) { //skip first n row for labels.
                        //Create new row in table
                        OperationBinding op_new_hs = BindingContext.getCurrent()
                                                                   .getCurrentBindingsEntry()
                                                                   .getOperationBinding("CreateHStructure");
                        op_new_hs.execute();
                        Row rowDept = iterHStruct.getCurrentRow();
                        int Index = 0;
                        //Iterate over row's columns
                        for (int column = 0; column < tempRow.getLastCellNum(); column++) {
                            Cell MytempCell = tempRow.getCell(column);
                            if (MytempCell != null) {
                                Index = MytempCell.getColumnIndex();
                                if (Index == 1) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        //isEtabExist
                                        OperationBinding is_exist = BindingContext.getCurrent()
                                                                                  .getCurrentBindingsEntry()
                                                                                  .getOperationBinding("isDeptExist");
                                        is_exist.getParamsMap().put("lib", MytempCell.getStringCellValue());
                                        is_exist.execute();
                                        DCIteratorBinding iterExist =
                                            (DCIteratorBinding) BindingContext.getCurrent()
                                                                                                        .getCurrentBindingsEntry()
                                                                                                        .get("isDeptExist1Iterator");
                                        if (iterExist.getEstimatedRowCount() > 0) {
                                            //iter.getCurrentRow().remove();
                                            existDeptList.add(MytempCell.getStringCellValue());
                                            /* System.out.println("Departement " + MytempCell.getStringCellValue() +
                                                                                       " Existant !!!"); */
                                            rowDept.removeAndRetain();
                                            break;
                                        }
                                        //System.out.println("LibelleLong : " + MytempCell.getStringCellValue());
                                        rowDept.setAttribute("LibelleLong", MytempCell.getStringCellValue());
                                        //UtiCree
                                        rowDept.setAttribute("UtiCree", getUtilisateur());
                                    }
                                } else if (Index == 2) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        //System.out.println("LibelleCourt : " + MytempCell.getStringCellValue());
                                        rowDept.setAttribute("LibelleCourt", MytempCell.getStringCellValue());
                                    }
                                } else if (Index == 3) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        OperationBinding is_exist_etab =
                                            BindingContext.getCurrent()
                                                                                       .getCurrentBindingsEntry()
                                                                                       .getOperationBinding("isEtabExist");
                                        is_exist_etab.getParamsMap().put("lib", MytempCell.getStringCellValue());
                                        is_exist_etab.execute();
                                        DCIteratorBinding iterExist =
                                            (DCIteratorBinding) BindingContext.getCurrent()
                                                                                                        .getCurrentBindingsEntry()
                                                                                                        .get("isEtabExistROVO1Iterator");
                                        if (iterExist.getEstimatedRowCount() > 0) {
                                            rowDept.setAttribute("IdStructures",
                                                                 Integer.parseInt(iterExist.getCurrentRow()
                                                                                                           .getAttribute("IdStructure")
                                                                                                           .toString()));
                                            /* System.out.println("IdStructures " + iterExist.getCurrentRow()
                                                                                                                  .getAttribute("IdStructure")
                                                                                                                  .toString()); */
                                        }
                                    }
                                } else if (Index == 4) {
                                    if (MytempCell.getDateCellValue() != null) {
                                        java.util.Date date = MytempCell.getDateCellValue();
                                        DateFormat dateFormat = new SimpleDateFormat("MM/dd/yy");
                                        String date1 = dateFormat.format(date);
                                        //System.out.println("Date : "+MytempCell.getDateCellValue());
                                        //System.out.println("Formated date : " + date1);
                                        try {
                                            date = dateFormat.parse(date1);
                                        } catch (ParseException e) {
                                        }
                                        java.sql.Date sqlDate = new java.sql.Date(date.getTime());
                                        oracle.jbo.domain.Date jboDate = new oracle.jbo.domain.Date(sqlDate);
                                        //System.out.println("jbo date : " + jboDate);
                                        rowDept.setAttribute("DateDebut", jboDate);
                                    }

                                } else if (Index == 5) {
                                    if (MytempCell.getDateCellValue() != null) {
                                        java.util.Date date = MytempCell.getDateCellValue();
                                        DateFormat dateFormat = new SimpleDateFormat("MM/dd/yy");
                                        String date1 = dateFormat.format(date);
                                        /* System.out.println("Date : " + MytempCell.getDateCellValue());
                                                                System.out.println("Formated date Debut : " + date1); */
                                        try {
                                            date = dateFormat.parse(date1);
                                        } catch (ParseException e) {
                                        }
                                        java.sql.Date sqlDate = new java.sql.Date(date.getTime());
                                        oracle.jbo.domain.Date jboDate = new oracle.jbo.domain.Date(sqlDate);
                                        rowDept.setAttribute("DateFin", jboDate);
                                    }
                                }
                            } else {
                                Index++;
                            }
                        }
                        //System.out.println("Is row Dept null : " + (rowDept.getAttribute("LibelleLong") == null));
                        if (rowDept.getAttribute("LibelleLong") == null) {
                            //System.out.println("Ligne Dept vide");
                            rowDept.removeAndRetain();
                        }
                        try {
                            OperationBinding op_commit_s = BindingContext.getCurrent()
                                                                         .getCurrentBindingsEntry()
                                                                         .getOperationBinding("Commit");
                            op_commit_s.execute();
                        } catch (Exception e) {
                            System.out.println(e.getMessage());
                        }
                    }
                    skipcnt++;
                }
            }
            //Import GradeFormation
            if (sheetIndex == 3) {
                System.out.println("Titre feuille : " + WorkBook.getSheetAt(sheetIndex).getSheetName());
                for (org.apache.poi.ss.usermodel.Row tempRow : sheet) {
                    if (skipcnt > skipRw) { //skip first n row for labels.
                        //Create new row in table
                        OperationBinding op_new_ts = BindingContext.getCurrent()
                                                                   .getCurrentBindingsEntry()
                                                                   .getOperationBinding("CreateGradeForm");
                        op_new_ts.execute();
                        Row rowgrde = iterGrade.getCurrentRow();
                        int Index = 0;
                        //Iterate over row's columns
                        for (int column = 0; column < tempRow.getLastCellNum(); column++) {
                            Cell MytempCell = tempRow.getCell(column);
                            if (MytempCell != null) {
                                Index = MytempCell.getColumnIndex();
                                if (Index == 0) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        OperationBinding op_grade = BindingContext.getCurrent()
                                                                                  .getCurrentBindingsEntry()
                                                                                  .getOperationBinding("getGrade");
                                        op_grade.getParamsMap().put("lib", MytempCell.getStringCellValue());
                                        op_grade.execute();
                                        DCIteratorBinding iterExist =
                                            (DCIteratorBinding) BindingContext.getCurrent()
                                                                                                        .getCurrentBindingsEntry()
                                                                                                        .get("getGrade1Iterator");
                                        if (iterExist.getEstimatedRowCount() > 0) {
                                            System.out.println("Grade " + MytempCell.getStringCellValue() +
                                                               " existant");
                                            rowgrde.removeAndRetain();
                                            break;
                                        }
                                        System.out.println("LibelleLong Grade : " + MytempCell.getStringCellValue());
                                        rowgrde.setAttribute("LibelleLong", MytempCell.getStringCellValue());
                                        //UtiCree
                                        rowgrde.setAttribute("UtiCree", getUtilisateur());
                                        System.out.println("User : " + getUtilisateur());
                                    }
                                } else if (Index == 1) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        System.out.println("LibelleCourt Grade : " + MytempCell.getStringCellValue());
                                        rowgrde.setAttribute("LibelleCourt", MytempCell.getStringCellValue());
                                    }
                                }
                            } else {
                                Index++;
                            }
                        }
                        //System.out.println("Is row section null : " + (rowSect.getAttribute("LibelleLong") == null));
                        if (rowgrde.getAttribute("LibelleLong") == null ||
                            rowgrde.getAttribute("LibelleCourt") == null) {
                            //System.out.println("Ligne Mention vide");
                            rowgrde.removeAndRetain();
                            OperationBinding op_rlbk = BindingContext.getCurrent()
                                                                     .getCurrentBindingsEntry()
                                                                     .getOperationBinding("Rollback");
                            op_rlbk.execute();
                        }
                        try {
                            OperationBinding op_commit = BindingContext.getCurrent()
                                                                       .getCurrentBindingsEntry()
                                                                       .getOperationBinding("Commit");
                            op_commit.execute();

                        } catch (Exception e) {
                            System.out.println(e.getMessage());
                        }
                    }
                    skipcnt++;
                }
            }
            //Import Domaine
            if (sheetIndex == 4) {
                //System.out.println("Titre feuille : " + WorkBook.getSheetAt(sheetIndex).getSheetName());
                //Iterate over excel rows
                for (org.apache.poi.ss.usermodel.Row tempRow : sheet) {
                    if (skipcnt > skipRw) { //skip first n row for labels.
                        //Create new row in table
                        OperationBinding op_new_dm = BindingContext.getCurrent()
                                                                   .getCurrentBindingsEntry()
                                                                   .getOperationBinding("CreateDomaine");
                        op_new_dm.execute();
                        Row rowDm = iterDomaine.getCurrentRow();
                        int Index = 0;
                        //Iterate over row's columns
                        for (int column = 0; column < tempRow.getLastCellNum(); column++) {
                            Cell MytempCell = tempRow.getCell(column);
                            if (MytempCell != null) {
                                Index = MytempCell.getColumnIndex();
                                if (Index == 1) {
                                    if (MytempCell.getStringCellValue() !=
                                        null) {
                                        //isSectionExist
                                        OperationBinding is_exist =
         BindingContext.getCurrent()
                                                                                  .getCurrentBindingsEntry()
                                                                                  .getOperationBinding("isDomaineExist");
                                        is_exist.getParamsMap().put("lib", MytempCell.getStringCellValue());
                                        is_exist.execute();
                                        DCIteratorBinding iterExist =
                                            (DCIteratorBinding) BindingContext.getCurrent()
                                                                                                        .getCurrentBindingsEntry()
                                                                                                        .get("isDomaineExistROVO1Iterator");
                                        if (iterExist.getEstimatedRowCount() >
                                            0) {
                                            //iter.getCurrentRow().remove();
                                            System.out.println("Domaine " + MytempCell.getStringCellValue() +
                                                               " Existant !!!");
                                            rowDm.removeAndRetain();
                                            break;
                                        }
                                        //System.out.println("LibelleLong : " + MytempCell.getStringCellValue());
                                        rowDm.setAttribute("LibelleLong", MytempCell.getStringCellValue());
                                        //UtiCree
                                        rowDm.setAttribute("UtiCree", getUtilisateur());
                                    }
                                } else if (Index == 2) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        //System.out.println("LibelleCourt : " + MytempCell.getStringCellValue());
                                        rowDm.setAttribute("LibelleCourt", MytempCell.getStringCellValue());
                                    }
                                }
                            } else {
                                Index++;
                            }
                        }
                        //System.out.println("Is row domaine null : " + (rowDm.getAttribute("LibelleLong") == null));
                        if (rowDm.getAttribute("LibelleLong") == null || rowDm.getAttribute("LibelleCourt") == null) {
                            //System.out.println("Ligne Domaine vide");
                            rowDm.removeAndRetain();
                            OperationBinding op_rlbk = BindingContext.getCurrent()
                                                                     .getCurrentBindingsEntry()
                                                                     .getOperationBinding("Rollback");
                            op_rlbk.execute();
                        }
                        try {
                            OperationBinding op_commit = BindingContext.getCurrent()
                                                                       .getCurrentBindingsEntry()
                                                                       .getOperationBinding("Commit");
                            op_commit.execute();

                        } catch (Exception e) {
                            System.out.println(e.getMessage());
                        }
                    }
                    skipcnt++;
                }
            }
            //Import Mention
            if (sheetIndex == 5) {
                //System.out.println("Titre feuille : " + WorkBook.getSheetAt(sheetIndex).getSheetName());
                //Iterate over excel rows
                for (org.apache.poi.ss.usermodel.Row tempRow : sheet) {
                    if (skipcnt > skipRw) { //skip first n row for labels.
                        //Create new row in table
                        OperationBinding op_new_s = BindingContext.getCurrent()
                                                                  .getCurrentBindingsEntry()
                                                                  .getOperationBinding("CreateMention");
                        op_new_s.execute();
                        Row rowMt = iterMention.getCurrentRow();
                        int Index = 0;
                        String mnt = null;
                        int dm = 0;
                        //Iterate over row's columns
                        for (int column = 0; column < tempRow.getLastCellNum(); column++) {
                            Cell MytempCell = tempRow.getCell(column);
                            if (MytempCell != null) {
                                Index = MytempCell.getColumnIndex();
                                if (Index == 1) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        //System.out.println("LibelleLong : " + MytempCell.getStringCellValue());
                                        rowMt.setAttribute("LibelleLong", MytempCell.getStringCellValue());
                                        //UtiCree
                                        rowMt.setAttribute("UtiCree", getUtilisateur());
                                        mnt = MytempCell.getStringCellValue();
                                    }
                                } else if (Index == 2) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        //System.out.println("LibelleCourt : " + MytempCell.getStringCellValue());
                                        rowMt.setAttribute("LibelleCourt", MytempCell.getStringCellValue());
                                    }
                                } else if (Index == 3) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        OperationBinding is_exist_dm =
                                            BindingContext.getCurrent()
                                                                                     .getCurrentBindingsEntry()
                                                                                     .getOperationBinding("isDomaineExist");
                                        is_exist_dm.getParamsMap().put("lib", MytempCell.getStringCellValue());
                                        is_exist_dm.execute();
                                        DCIteratorBinding iterExist =
                                            (DCIteratorBinding) BindingContext.getCurrent()
                                                                                                        .getCurrentBindingsEntry()
                                                                                                        .get("isDomaineExistROVO1Iterator");
                                        if (iterExist.getEstimatedRowCount() > 0) {
                                            rowMt.setAttribute("IdDomaine", Long.parseLong(iterExist.getCurrentRow()
                                                                                                    .getAttribute("IdDomaine")
                                                                                                    .toString()));
                                            dm = Integer.parseInt(iterExist.getCurrentRow()
                                                                           .getAttribute("IdDomaine")
                                                                           .toString());
                                            /* System.out.println("Domaine " + iterExist.getCurrentRow()
                                                                                                             .getAttribute("IdDomaine")
                                                                                                             .toString()); */
                                        }
                                    }
                                }
                            } else {
                                Index++;
                            }
                        }
                        //System.out.println("Is row Mention null : " + (rowMt.getAttribute("LibelleLong") == null));
                        if (rowMt.getAttribute("LibelleLong") == null || rowMt.getAttribute("LibelleCourt") == null ||
                            rowMt.getAttribute("IdDomaine") == null) {
                            //System.out.println("Ligne Mention vide");
                            rowMt.removeAndRetain();
                            OperationBinding op_rlbk = BindingContext.getCurrent()
                                                                     .getCurrentBindingsEntry()
                                                                     .getOperationBinding("Rollback");
                            op_rlbk.execute();
                        } else {
                            OperationBinding is_exist = BindingContext.getCurrent()
                                                                      .getCurrentBindingsEntry()
                                                                      .getOperationBinding("isMentionExist");
                            is_exist.getParamsMap().put("lib", rowMt.getAttribute("LibelleLong"));
                            is_exist.getParamsMap().put("domaine_id", rowMt.getAttribute("IdDomaine"));
                            is_exist.execute();
                            DCIteratorBinding iterExist =
                                (DCIteratorBinding) BindingContext.getCurrent()
                                                                                            .getCurrentBindingsEntry()
                                                                                            .get("isMentionExist1Iterator");
                            if (iterExist.getEstimatedRowCount() > 0) {
                                //System.out.println("Mention " + rowMt.getAttribute("LibelleLong") + " Existant !!!");
                                rowMt.removeAndRetain();
                                OperationBinding op_rlbk = BindingContext.getCurrent()
                                                                         .getCurrentBindingsEntry()
                                                                         .getOperationBinding("Rollback");
                                op_rlbk.execute();
                            }
                        }
                        try {
                            OperationBinding op_commit_s = BindingContext.getCurrent()
                                                                         .getCurrentBindingsEntry()
                                                                         .getOperationBinding("Commit");
                            op_commit_s.execute();

                        } catch (Exception e) {
                            System.out.println(e.getMessage());
                        }
                    }
                    skipcnt++;
                }
            }
            //Import Specialit
            if (sheetIndex == 6) {
                //System.out.println("Titre feuille : " + WorkBook.getSheetAt(sheetIndex).getSheetName());
                //Iterate over excel rows
                for (org.apache.poi.ss.usermodel.Row tempRow : sheet) {
                    if (skipcnt > skipRw) { //skip first n row for labels.
                        //Create new row in table
                        OperationBinding op_new_sp = BindingContext.getCurrent()
                                                                   .getCurrentBindingsEntry()
                                                                   .getOperationBinding("CreateSpec");
                        op_new_sp.execute();
                        Row rowSpec = iterSpecialite.getCurrentRow();
                        int Index = 0;
                        //Iterate over row's columns
                        for (int column = 0; column < tempRow.getLastCellNum(); column++) {
                            Cell MytempCell = tempRow.getCell(column);
                            if (MytempCell != null) {
                                Index = MytempCell.getColumnIndex();
                                if (Index == 1) {
                                    if (MytempCell.getStringCellValue() != null) {

                                        //System.out.println("LibelleLong : " + MytempCell.getStringCellValue());
                                        rowSpec.setAttribute("LibelleLong", MytempCell.getStringCellValue());
                                        //UtiCree
                                        rowSpec.setAttribute("UtiCree", getUtilisateur());
                                    }
                                } else if (Index == 2) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        //System.out.println("LibelleCourt : " + MytempCell.getStringCellValue());
                                        rowSpec.setAttribute("LibelleCourt", MytempCell.getStringCellValue());
                                    }
                                } else if (Index == 3) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        //System.out.println("Get mention");
                                        OperationBinding is_exist = BindingContext.getCurrent()
                                                                                  .getCurrentBindingsEntry()
                                                                                  .getOperationBinding("getMention");
                                        is_exist.getParamsMap().put("lib", MytempCell.getStringCellValue());
                                        is_exist.execute();
                                        DCIteratorBinding iterExistM =
                                            (DCIteratorBinding) BindingContext.getCurrent()
                                                                                                         .getCurrentBindingsEntry()
                                                                                                         .get("GetMention1Iterator");
                                        //System.out.println("Mention size : " + iterExistM.getEstimatedRowCount());
                                        if (iterExistM.getEstimatedRowCount() > 0) {
                                            /* System.out.println("IdMention " + iterExistM.getCurrentRow()
                                                                                                                .getAttribute("IdMention")
                                                                                                                .toString()); */
                                            rowSpec.setAttribute("IdMention", Long.parseLong(iterExistM.getCurrentRow()
                                                                                                       .getAttribute("IdMention")
                                                                                                       .toString()));
                                        }
                                    }
                                }
                            } else {
                                Index++;
                            }
                        }
                        //System.out.println("Is row Mention null : " + (rowSpec.getAttribute("LibelleLong") == null));
                        if (rowSpec.getAttribute("LibelleLong") == null ||
                            rowSpec.getAttribute("LibelleCourt") == null || rowSpec.getAttribute("IdMention") == null) {
                            //System.out.println("Ligne Mention vide");
                            rowSpec.removeAndRetain();
                            OperationBinding op_rlbk = BindingContext.getCurrent()
                                                                     .getCurrentBindingsEntry()
                                                                     .getOperationBinding("Rollback");
                            op_rlbk.execute();
                        } else {
                            OperationBinding is_exist = BindingContext.getCurrent()
                                                                      .getCurrentBindingsEntry()
                                                                      .getOperationBinding("isSpecExist");
                            is_exist.getParamsMap().put("lib", rowSpec.getAttribute("LibelleLong"));
                            is_exist.getParamsMap().put("mention_id", rowSpec.getAttribute("IdMention"));
                            is_exist.execute();
                            DCIteratorBinding iterExist =
                                (DCIteratorBinding) BindingContext.getCurrent()
                                                                                            .getCurrentBindingsEntry()
                                                                                            .get("isSpecialiteExistROVO1Iterator");
                            if (iterExist.getEstimatedRowCount() > 0) {
                                /* System.out.println("Specialit " + rowSpec.getAttribute("LibelleLong") +
                                                               " Existant !!!"); */
                                rowSpec.removeAndRetain();
                                OperationBinding op_rlbk = BindingContext.getCurrent()
                                                                         .getCurrentBindingsEntry()
                                                                         .getOperationBinding("Rollback");
                                op_rlbk.execute();
                            }
                        }
                        try {
                            OperationBinding op_commit_sp = BindingContext.getCurrent()
                                                                          .getCurrentBindingsEntry()
                                                                          .getOperationBinding("Commit");
                            op_commit_sp.execute();

                        } catch (Exception e) {
                            //System.out.println(e.getMessage());
                        }
                    }
                    skipcnt++;
                }
            }
            //Import Option
            if (sheetIndex == 7) {
                //System.out.println("Titre feuille : " + WorkBook.getSheetAt(sheetIndex).getSheetName());
                //Iterate over excel rows
                for (org.apache.poi.ss.usermodel.Row tempRow : sheet) {
                    if (skipcnt > skipRw) { //skip first n row for labels.
                        //Create new row in table
                        OperationBinding op_new_sp = BindingContext.getCurrent()
                                                                   .getCurrentBindingsEntry()
                                                                   .getOperationBinding("CreateOpt");
                        op_new_sp.execute();
                        Row rowOpt = iterOption.getCurrentRow();
                        int Index = 0;
                        //Iterate over row's columns
                        for (int column = 0; column < tempRow.getLastCellNum(); column++) {
                            Cell MytempCell = tempRow.getCell(column);
                            if (MytempCell != null) {
                                Index = MytempCell.getColumnIndex();
                                if (Index == 0) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        //System.out.println("LibelleLong : " + MytempCell.getStringCellValue());
                                        rowOpt.setAttribute("LibelleLong", MytempCell.getStringCellValue());
                                        //UtiCree
                                        rowOpt.setAttribute("UtiCree", getUtilisateur());
                                    }
                                } else if (Index == 1) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        //System.out.println("LibelleCourt : " + MytempCell.getStringCellValue());
                                        rowOpt.setAttribute("LibelleCourt", MytempCell.getStringCellValue());
                                    }
                                } else if (Index == 2) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        //System.out.println("Get mention");
                                        OperationBinding is_exist = BindingContext.getCurrent()
                                                                                  .getCurrentBindingsEntry()
                                                                                  .getOperationBinding("getSpecialite");
                                        is_exist.getParamsMap().put("lib", MytempCell.getStringCellValue());
                                        is_exist.execute();
                                        DCIteratorBinding iterExistM =
                                            (DCIteratorBinding) BindingContext.getCurrent()
                                                                                                         .getCurrentBindingsEntry()
                                                                                                         .get("GetSpecialiteROVO1Iterator");
                                        //System.out.println("Mention size : " + iterExistM.getEstimatedRowCount());
                                        if (iterExistM.getEstimatedRowCount() > 0) {
                                            /* System.out.println("IdMention " + iterExistM.getCurrentRow()
                                                                                                                    .getAttribute("IdMention")
                                                                                                                    .toString()); */
                                            rowOpt.setAttribute("IdSpecialite", Long.parseLong(iterExistM.getCurrentRow()
                                                                                                         .getAttribute("IdSpecialite")
                                                                                                         .toString()));
                                        }
                                    }
                                }
                            } else {
                                Index++;
                            }
                        }
                        //System.out.println("Is row Mention null : " + (rowSpec.getAttribute("LibelleLong") == null));
                        if (rowOpt.getAttribute("LibelleLong") == null || rowOpt.getAttribute("LibelleCourt") == null ||
                            rowOpt.getAttribute("IdSpecialite") == null) {
                            //System.out.println("Ligne Mention vide");
                            rowOpt.removeAndRetain();
                            OperationBinding op_rlbk = BindingContext.getCurrent()
                                                                     .getCurrentBindingsEntry()
                                                                     .getOperationBinding("Rollback");
                            op_rlbk.execute();
                        } else {
                            OperationBinding is_exist = BindingContext.getCurrent()
                                                                      .getCurrentBindingsEntry()
                                                                      .getOperationBinding("isOptionExist");
                            is_exist.getParamsMap().put("lib", rowOpt.getAttribute("LibelleLong"));
                            is_exist.getParamsMap().put("spec_id", rowOpt.getAttribute("IdSpecialite"));
                            is_exist.execute();
                            DCIteratorBinding iterExist =
                                (DCIteratorBinding) BindingContext.getCurrent()
                                                                                            .getCurrentBindingsEntry()
                                                                                            .get("IsOptionExist1Iterator");
                            if (iterExist.getEstimatedRowCount() > 0) {
                                /* System.out.println("Specialit " + rowSpec.getAttribute("LibelleLong") +
                                                                   " Existant !!!"); */
                                rowOpt.removeAndRetain();
                                OperationBinding op_rlbk = BindingContext.getCurrent()
                                                                         .getCurrentBindingsEntry()
                                                                         .getOperationBinding("Rollback");
                                op_rlbk.execute();
                            }
                        }
                        try {
                            OperationBinding op_commit_sp = BindingContext.getCurrent()
                                                                          .getCurrentBindingsEntry()
                                                                          .getOperationBinding("Commit");
                            op_commit_sp.execute();

                        } catch (Exception e) {
                            //System.out.println(e.getMessage());
                        }
                    }
                    skipcnt++;
                }
            }
            //Import Formation
            if (sheetIndex == 8) {
                System.out.println("Titre feuille : " + WorkBook.getSheetAt(sheetIndex).getSheetName());
                //Iterate over excel rows
                for (org.apache.poi.ss.usermodel.Row tempRow : sheet) {
                    if (skipcnt > skipRw) { //skip first n row for labels.
                        //Create new row in table
                        OperationBinding op_new_fr = BindingContext.getCurrent()
                                                                   .getCurrentBindingsEntry()
                                                                   .getOperationBinding("CreateFormation");
                        op_new_fr.execute();
                        Row rowForm = iterFormation.getCurrentRow();
                        int Index = 0;
                        //Iterate over row's columns
                        for (int column = 0; column < tempRow.getLastCellNum(); column++) {
                            Cell MytempCell = tempRow.getCell(column);
                            if (MytempCell != null) {
                                Index = MytempCell.getColumnIndex();
                                if (Index == 1) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        //System.out.println("LibelleLong : " + MytempCell.getStringCellValue());
                                        rowForm.setAttribute("LibelleLong", MytempCell.getStringCellValue());
                                        //UtiCree
                                        rowForm.setAttribute("UtiCree", getUtilisateur());
                                    }
                                } else if (Index == 2) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        //System.out.println("LibelleCourt : " + MytempCell.getStringCellValue());
                                        rowForm.setAttribute("LibelleCourt", MytempCell.getStringCellValue());
                                    }
                                } else if (Index == 3) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        OperationBinding is_exist = BindingContext.getCurrent()
                                                                                  .getCurrentBindingsEntry()
                                                                                  .getOperationBinding("getMention");
                                        is_exist.getParamsMap().put("lib", MytempCell.getStringCellValue());
                                        is_exist.execute();
                                        DCIteratorBinding iterExist =
                                            (DCIteratorBinding) BindingContext.getCurrent()
                                                                                                        .getCurrentBindingsEntry()
                                                                                                        .get("GetMention1Iterator");
                                        if (iterExist.getEstimatedRowCount() > 0) {
                                            rowForm.setAttribute("IdMention", Long.parseLong(iterExist.getCurrentRow()
                                                                                                      .getAttribute("IdMention")
                                                                                                      .toString()));
                                            /* System.out.println("IdMention " + iterExist.getCurrentRow()
                                                                                                                           .getAttribute("IdMention")
                                                                                                                           .toString()); */
                                        }
                                    }
                                } else if (Index == 4) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        OperationBinding is_exist = BindingContext.getCurrent()
                                                                                  .getCurrentBindingsEntry()
                                                                                  .getOperationBinding("isDeptExist");
                                        is_exist.getParamsMap().put("lib", MytempCell.getStringCellValue());
                                        is_exist.execute();
                                        DCIteratorBinding iterExist =
                                            (DCIteratorBinding) BindingContext.getCurrent()
                                                                                                        .getCurrentBindingsEntry()
                                                                                                        .get("isDeptExist1Iterator");
                                        if (iterExist.getEstimatedRowCount() > 0) {
                                            rowForm.setAttribute("IdHistoriquesStructure",
                                                                 Long.parseLong(iterExist.getCurrentRow()
                                                                                                                   .getAttribute("IdHistoriquesStructure")
                                                                                                                   .toString()));
                                            /* System.out.println("Departement " + iterExist.getCurrentRow()
                                                                                                                             .getAttribute("IdHistoriquesStructure")
                                                                                                                             .toString()); */
                                        }
                                    }
                                } else if (Index == 5) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        OperationBinding op_grade = BindingContext.getCurrent()
                                                                                  .getCurrentBindingsEntry()
                                                                                  .getOperationBinding("getGrade");
                                        op_grade.getParamsMap().put("lib", MytempCell.getStringCellValue());
                                        op_grade.execute();
                                        DCIteratorBinding iterExist =
                                            (DCIteratorBinding) BindingContext.getCurrent()
                                                                                                        .getCurrentBindingsEntry()
                                                                                                        .get("getGrade1Iterator");
                                        if (iterExist.getEstimatedRowCount() > 0) {
                                            rowForm.setAttribute("IdGradesFormation",
                                                                 Long.parseLong(iterExist.getCurrentRow()
                                                                                                              .getAttribute("IdGradesFormation")
                                                                                                              .toString()));
                                            /* System.out.println("Grade Formation : " +
                                                                                                   MytempCell.getStringCellValue().toUpperCase()); */
                                        }
                                    }
                                } else if (Index == 6) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        OperationBinding op_grade = BindingContext.getCurrent()
                                                                                  .getCurrentBindingsEntry()
                                                                                  .getOperationBinding("getCycle");
                                        op_grade.getParamsMap().put("lib", MytempCell.getStringCellValue());
                                        op_grade.execute();
                                        DCIteratorBinding iterExist =
                                            (DCIteratorBinding) BindingContext.getCurrent()
                                                                                                        .getCurrentBindingsEntry()
                                                                                                        .get("getCycleROVO1Iterator");
                                        if (iterExist.getEstimatedRowCount() > 0) {
                                            rowForm.setAttribute("IdCycle", Long.parseLong(iterExist.getCurrentRow()
                                                                                                    .getAttribute("IdCycle")
                                                                                                    .toString()));
                                            /* System.out.println("Cycle : " +
                                                                                                   MytempCell.getStringCellValue().toUpperCase()); */
                                        }
                                    }
                                } else if (Index == 7) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        if (MytempCell.getStringCellValue().equals("NON")) {
                                            rowForm.setAttribute("Ouvert", 0);
                                        }
                                        //System.out.println("Ouvert : " + MytempCell.getStringCellValue());
                                    }
                                } else if (Index == 8) {
                                    //getEcoleDoctorale
                                    //System.out.println("Ecole Doctorale");


















                                } else if (Index == 9) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        if (MytempCell.getStringCellValue().equals("OUI")) {
                                            rowForm.setAttribute("Professionalisante", 1);
                                        }
                                        //System.out.println("Professionalisante : " + MytempCell.getStringCellValue());
                                    }
                                } else if (Index == 10) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        OperationBinding op_grade = BindingContext.getCurrent()
                                                                                  .getCurrentBindingsEntry()
                                                                                  .getOperationBinding("getTypeForm");
                                        op_grade.getParamsMap().put("lib", MytempCell.getStringCellValue());
                                        op_grade.execute();
                                        DCIteratorBinding iterExist =
                                            (DCIteratorBinding) BindingContext.getCurrent()
                                                                                                        .getCurrentBindingsEntry()
                                                                                                        .get("getTypeFormROVO1Iterator");
                                        if (iterExist.getEstimatedRowCount() > 0) {
                                            rowForm.setAttribute("IdTypeFormation",
                                                                 Long.parseLong(iterExist.getCurrentRow()
                                                                                                            .getAttribute("IdTypeFormation")
                                                                                                            .toString()));
                                            //System.out.println("Type Formation : " + MytempCell.getStringCellValue());
                                        }
                                    }
                                } else if (Index == 11) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        if (MytempCell.getStringCellValue().equals("OUI")) {
                                            rowForm.setAttribute("TroncCommun", 1);
                                        }
                                        //System.out.println("TroncCommun : " + MytempCell.getStringCellValue());
                                    }
                                } else if (Index == 12) {
                                    //getOrganisationEtude
                                    //System.out.println("Organisation Etude");


















                                } else if (Index == 13) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        rowForm.setAttribute("JustificationProgramme", MytempCell.getStringCellValue());
                                        //System.out.println("TroncCommun : " + MytempCell.getStringCellValue());
                                    }
                                } else if (Index == 14) {
                                    //ORGANISATION PROGRAMME
                                    if (MytempCell.getStringCellValue() != null) {
                                        rowForm.setAttribute("OrganisationProgramme", MytempCell.getStringCellValue());
                                        //System.out.println("TroncCommun : " + MytempCell.getStringCellValue());
                                    }
                                } else if (Index == 15) {
                                    //PROFIL ACADEMIQUE
                                    if (MytempCell.getStringCellValue() != null) {
                                        rowForm.setAttribute("ProfilAcademique", MytempCell.getStringCellValue());
                                    }
                                } else if (Index == 16) {
                                    //PROFIL PROFESSIONNEL
                                    if (MytempCell.getStringCellValue() != null) {
                                        rowForm.setAttribute("ProfilProfessionnel", MytempCell.getStringCellValue());
                                    }
                                } else if (Index == 17) {
                                    //OBSERVATIONS
                                    if (MytempCell.getStringCellValue() != null) {
                                        rowForm.setAttribute("Observations", MytempCell.getStringCellValue());
                                    }
                                } else if (Index == 18) {
                                    //PAYANTE
                                    if (MytempCell.getStringCellValue() != null) {
                                        if (MytempCell.getStringCellValue().equals("OUI")) {
                                            rowForm.setAttribute("Payante", 1);
                                        }
                                    }
                                } else if (Index == 19) {
                                    //VALIDE
                                    if (MytempCell.getStringCellValue() != null) {
                                        if (MytempCell.getStringCellValue().equals("OUI")) {
                                            rowForm.setAttribute("Valide", 1);
                                        }
                                    }
                                } else if (Index == 20) {
                                    //Presentielle
                                    if (MytempCell.getStringCellValue() != null) {
                                        if (MytempCell.getStringCellValue().equals("OUI")) {
                                            rowForm.setAttribute("Presentielle", 1);
                                        }
                                    }
                                } else if (Index == 21) {
                                    //FORMATION RECONNUE
                                    if (MytempCell.getStringCellValue() != null) {
                                        if (MytempCell.getStringCellValue().equals("OUI")) {
                                            rowForm.setAttribute("FormationReconnue", 1);
                                        }
                                    }
                                }
                            } else {
                                Index++;
                            }
                        }
                        //System.out.println("Is row Formation null : " + (rowForm.getAttribute("LibelleLong") == null));
                        if (rowForm.getAttribute("LibelleLong") == null ||
                            rowForm.getAttribute("LibelleCourt") == null || rowForm.getAttribute("IdMention") == null ||
                            rowForm.getAttribute("IdTypeFormation") == null ||
                            rowForm.getAttribute("IdCycle") == null ||
                            rowForm.getAttribute("IdGradesFormation") == null ||
                            rowForm.getAttribute("IdHistoriquesStructure") == null) {
                            //System.out.println("Ligne Mention vide");
                            rowForm.removeAndRetain();
                            OperationBinding op_rlbk = BindingContext.getCurrent()
                                                                     .getCurrentBindingsEntry()
                                                                     .getOperationBinding("Rollback");
                            op_rlbk.execute();
                        } else {
                            OperationBinding is_exist = BindingContext.getCurrent()
                                                                      .getCurrentBindingsEntry()
                                                                      .getOperationBinding("isFormationExist");
                            is_exist.getParamsMap().put("lib", rowForm.getAttribute("LibelleLong"));
                            is_exist.getParamsMap().put("hs_id", rowForm.getAttribute("IdHistoriquesStructure"));
                            is_exist.getParamsMap().put("mnt_id", rowForm.getAttribute("IdMention"));
                            is_exist.execute();
                            DCIteratorBinding iterExist =
                                (DCIteratorBinding) BindingContext.getCurrent()
                                                                                            .getCurrentBindingsEntry()
                                                                                            .get("isFormationExistROVO1Iterator");
                            if (iterExist.getEstimatedRowCount() > 0) {
                                System.out.println("Formation " + rowForm.getAttribute("LibelleLong") +
                                                   " Existant !!!");
                                rowForm.removeAndRetain();
                                OperationBinding op_rlbk = BindingContext.getCurrent()
                                                                         .getCurrentBindingsEntry()
                                                                         .getOperationBinding("Rollback");
                                op_rlbk.execute();
                            }
                        }
                        try {
                            OperationBinding op_commit_s = BindingContext.getCurrent()
                                                                         .getCurrentBindingsEntry()
                                                                         .getOperationBinding("Commit");
                            op_commit_s.execute();

                        } catch (Exception e) {
                            System.out.println(e.getMessage());
                        }
                    }
                    skipcnt++;
                }
            }
            //Import Niveau Formation
            if (sheetIndex == 9) {
                System.out.println("Titre feuille : " + WorkBook.getSheetAt(sheetIndex).getSheetName());
                //Iterate over excel rows
                for (org.apache.poi.ss.usermodel.Row tempRow : sheet) {
                    if (skipcnt > skipRw) { //skip first n row for labels.
                        //Create new row in table
                        OperationBinding op_new_nfr = BindingContext.getCurrent()
                                                                    .getCurrentBindingsEntry()
                                                                    .getOperationBinding("CreateNivFormation");
                        op_new_nfr.execute();
                        Row rowNivForm = iterNivFormation.getCurrentRow();
                        int Index = 0;
                        //Iterate over row's columns
                        for (int column = 0; column < tempRow.getLastCellNum(); column++) {
                            Cell MytempCell = tempRow.getCell(column);
                            if (MytempCell != null) {
                                Index = MytempCell.getColumnIndex();
                                if (Index == 1) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        //System.out.println("LibelleLong : " + MytempCell.getStringCellValue());
                                        rowNivForm.setAttribute("LibelleLong", MytempCell.getStringCellValue());
                                        //UtiCree
                                        rowNivForm.setAttribute("UtiCree", getUtilisateur());
                                    }
                                } else if (Index == 2) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        //System.out.println("LibelleCourt : " + MytempCell.getStringCellValue());
                                        rowNivForm.setAttribute("LibelleCourt", MytempCell.getStringCellValue());
                                    }
                                } else if (Index == 3) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        OperationBinding is_exist = BindingContext.getCurrent()
                                                                                  .getCurrentBindingsEntry()
                                                                                  .getOperationBinding("isNiveauExist");
                                        is_exist.getParamsMap().put("lib", MytempCell.getStringCellValue());
                                        is_exist.execute();
                                        DCIteratorBinding iterExist =
                                            (DCIteratorBinding) BindingContext.getCurrent()
                                                                                                        .getCurrentBindingsEntry()
                                                                                                        .get("isNiveauExist1Iterator");
                                        if (iterExist.getEstimatedRowCount() > 0) {
                                            rowNivForm.setAttribute("IdNiveau", Long.parseLong(iterExist.getCurrentRow()
                                                                                                        .getAttribute("IdNiveau")
                                                                                                        .toString()));
                                            /* System.out.println("Niveau " + iterExist.getCurrentRow()
                                                                                                                        .getAttribute("IdNiveau")
                                                                                                                        .toString()); */
                                        }
                                    }
                                } else if (Index == 4) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        OperationBinding is_exist = BindingContext.getCurrent()
                                                                                  .getCurrentBindingsEntry()
                                                                                  .getOperationBinding("getFromation");
                                        is_exist.getParamsMap().put("lib", MytempCell.getStringCellValue());
                                        is_exist.execute();
                                        DCIteratorBinding iterExist =
                                            (DCIteratorBinding) BindingContext.getCurrent()
                                                                                                        .getCurrentBindingsEntry()
                                                                                                        .get("getFormation1Iterator");
                                        if (iterExist.getEstimatedRowCount() > 0) {
                                            rowNivForm.setAttribute("IdFormation",
                                                                    Long.parseLong(iterExist.getCurrentRow()
                                                                                                           .getAttribute("IdFormation")
                                                                                                           .toString()));
                                            /* System.out.println("Formation " + iterExist.getCurrentRow()
                                                                                                                           .getAttribute("IdFormation")
                                                                                                                           .toString()); */
                                        }
                                    }
                                } else if (Index == 5) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        if (MytempCell.getStringCellValue().equals("OUI")) {
                                            rowNivForm.setAttribute("ASelection", 1);
                                        }
                                        //System.out.println("ASelection : " + MytempCell.getStringCellValue());
                                    }
                                } else if (Index == 6) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        if (MytempCell.getStringCellValue().equals("OUI")) {
                                            rowNivForm.setAttribute("AutorisationPermise", 1);
                                        }
                                        //System.out.println("AutorisationPermise : " + MytempCell.getStringCellValue());
                                    }
                                } else if (Index == 7) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        if (MytempCell.getStringCellValue().equals("OUI")) {
                                            rowNivForm.setAttribute("Presentielle", 1);
                                        }
                                        //System.out.println("Presentielle : " + MytempCell.getStringCellValue());
                                    }
                                } else if (Index == 8) {
                                    if ((int) MytempCell.getNumericCellValue() !=
                                        0) {
                                        //System.out.println("NbreInsPermise : " +
                                        // (int) MytempCell.getNumericCellValue());
                                        rowNivForm.setAttribute("NbreInsPermise",
                                                                (int) MytempCell.getNumericCellValue());
                                    }
                                } else if (Index == 9) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        if (MytempCell.getStringCellValue().equals("OUI")) {
                                            rowNivForm.setAttribute("Diplomante", 1);
                                        }
                                        //System.out.println("Diplomante : " + MytempCell.getStringCellValue());
                                    }
                                } else if (Index == 10) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        if (MytempCell.getStringCellValue().equals("OUI")) {
                                            rowNivForm.setAttribute("Ouvert", 1);
                                        }
                                        // System.out.println("Ouvert : " + MytempCell.getStringCellValue());
                                    }
                                }
                            } else {
                                Index++;
                            }
                        }

                        if (rowNivForm.getAttribute("LibelleLong") == null ||
                            rowNivForm.getAttribute("LibelleCourt") == null ||
                            rowNivForm.getAttribute("IdNiveau") == null ||
                            rowNivForm.getAttribute("IdFormation") == null) {
                            //System.out.println("Ligne Mention vide");
                            rowNivForm.removeAndRetain();
                            OperationBinding op_rlbk = BindingContext.getCurrent()
                                                                     .getCurrentBindingsEntry()
                                                                     .getOperationBinding("Rollback");
                            op_rlbk.execute();
                        } else {
                            OperationBinding is_exist = BindingContext.getCurrent()
                                                                      .getCurrentBindingsEntry()
                                                                      .getOperationBinding("isNivFormExist");
                            is_exist.getParamsMap().put("lib", rowNivForm.getAttribute("LibelleLong"));
                            is_exist.getParamsMap().put("form_id", rowNivForm.getAttribute("IdFormation"));
                            is_exist.getParamsMap().put("niv", rowNivForm.getAttribute("IdNiveau"));
                            is_exist.execute();
                            DCIteratorBinding iterExist =
                                (DCIteratorBinding) BindingContext.getCurrent()
                                                                                            .getCurrentBindingsEntry()
                                                                                            .get("isNivFormExistROVO1Iterator");
                            if (iterExist.getEstimatedRowCount() > 0) {
                                System.out.println("Niveau Formation " + rowNivForm.getAttribute("LibelleLong") +
                                                   " Existant !!!");
                                rowNivForm.removeAndRetain();
                                OperationBinding op_rlbk = BindingContext.getCurrent()
                                                                         .getCurrentBindingsEntry()
                                                                         .getOperationBinding("Rollback");
                                op_rlbk.execute();
                            }
                        }
                        try {
                            OperationBinding op_commit_s = BindingContext.getCurrent()
                                                                         .getCurrentBindingsEntry()
                                                                         .getOperationBinding("Commit");
                            op_commit_s.execute();

                        } catch (Exception e) {
                            System.out.println(e.getMessage());
                        }
                    }
                    skipcnt++;
                }
            }
            //Import UE
            if (sheetIndex == 10) {
                System.out.println("Titre feuille : " + WorkBook.getSheetAt(sheetIndex).getSheetName());
                //Section (LIBELLE_LONG,LIBELLE_COURT)
                //Iterate over excel rows
                for (org.apache.poi.ss.usermodel.Row tempRow : sheet) {
                    if (skipcnt > skipRw) { //skip first n row for labels.
                        //Create new row in table
                        OperationBinding op_new_ue = BindingContext.getCurrent()
                                                                   .getCurrentBindingsEntry()
                                                                   .getOperationBinding("CreateUe");
                        op_new_ue.execute();
                        Row rowUe = iterUe.getCurrentRow();
                        int Index = 0;
                        //Iterate over row's columns
                        for (int column = 0; column < tempRow.getLastCellNum(); column++) {
                            Cell MytempCell = tempRow.getCell(column);
                            if (MytempCell != null) {
                                Index = MytempCell.getColumnIndex();
                                if (Index == 1) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        //isSectionExist
                                        OperationBinding is_exist = BindingContext.getCurrent()
                                                                                  .getCurrentBindingsEntry()
                                                                                  .getOperationBinding("isUeExist");
                                        is_exist.getParamsMap().put("lib", MytempCell.getStringCellValue());
                                        is_exist.execute();
                                        DCIteratorBinding iterExist =
                                            (DCIteratorBinding) BindingContext.getCurrent()
                                                                                                        .getCurrentBindingsEntry()
                                                                                                        .get("IsUeExistROVO1Iterator");
                                        if (iterExist.getEstimatedRowCount() > 0) {
                                            //iter.getCurrentRow().remove();
                                            /*
                                                                    System.out.println("Ue " + MytempCell.getStringCellValue() +
                                                                                       " Existant !!!"); */
                                            rowUe.removeAndRetain();
                                            break;
                                        }
                                        //System.out.println("LibelleLong : " + MytempCell.getStringCellValue());
                                        rowUe.setAttribute("LibelleLong", MytempCell.getStringCellValue());
                                        //UtiCree
                                        rowUe.setAttribute("UtiCree", getUtilisateur());
                                    }
                                } else if (Index == 2) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        //System.out.println("LibelleCourt : " + MytempCell.getStringCellValue());
                                        rowUe.setAttribute("LibelleCourt", MytempCell.getStringCellValue());
                                    }
                                }
                            } else {
                                Index++;
                            }
                        }
                        //System.out.println("Is row Ue null : " + (rowUe.getAttribute("LibelleLong") == null));
                        if (rowUe.getAttribute("LibelleLong") == null || rowUe.getAttribute("LibelleCourt") == null) {
                            //System.out.println("Ligne Mention vide");
                            rowUe.removeAndRetain();
                            OperationBinding op_rlbk = BindingContext.getCurrent()
                                                                     .getCurrentBindingsEntry()
                                                                     .getOperationBinding("Rollback");
                            op_rlbk.execute();
                        }
                        try {
                            OperationBinding op_commit = BindingContext.getCurrent()
                                                                       .getCurrentBindingsEntry()
                                                                       .getOperationBinding("Commit");
                            op_commit.execute();

                        } catch (Exception e) {
                            System.out.println(e.getMessage());
                        }
                    }
                    skipcnt++;
                }
            }
            //Import Ec
            if (sheetIndex == 11) {
                System.out.println("Titre feuille : " + WorkBook.getSheetAt(sheetIndex).getSheetName());
                //Iterate over excel rows
                for (org.apache.poi.ss.usermodel.Row tempRow : sheet) {
                    if (skipcnt > skipRw) { //skip first n row for labels.
                        //Create new row in table
                        OperationBinding op_new_ec = BindingContext.getCurrent()
                                                                   .getCurrentBindingsEntry()
                                                                   .getOperationBinding("CreateEc");
                        op_new_ec.execute();
                        Row rowEc = iterEc.getCurrentRow();
                        int Index = 0;
                        //Iterate over row's columns
                        for (int column = 0; column < tempRow.getLastCellNum(); column++) {
                            Cell MytempCell = tempRow.getCell(column);
                            if (MytempCell != null) {
                                Index = MytempCell.getColumnIndex();
                                if (Index == 1) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        //isSectionExist
                                        OperationBinding is_exist = BindingContext.getCurrent()
                                                                                  .getCurrentBindingsEntry()
                                                                                  .getOperationBinding("isEcExist");
                                        is_exist.getParamsMap().put("lib", MytempCell.getStringCellValue());
                                        is_exist.execute();
                                        DCIteratorBinding iterExist =
                                            (DCIteratorBinding) BindingContext.getCurrent()
                                                                                                        .getCurrentBindingsEntry()
                                                                                                        .get("isEcExistROVO1Iterator");
                                        if (iterExist.getEstimatedRowCount() > 0) {
                                            //iter.getCurrentRow().remove();
                                            /*
                                                                    System.out.println("Ec " + MytempCell.getStringCellValue() +
                                                                                       " Existant !!!"); */
                                            rowEc.removeAndRetain();
                                            break;
                                        }
                                        //System.out.println("LibelleLong : " + MytempCell.getStringCellValue());
                                        rowEc.setAttribute("LibelleLong", MytempCell.getStringCellValue());
                                        //UtiCree
                                        rowEc.setAttribute("UtiCree", getUtilisateur());
                                    }
                                } else if (Index == 2) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        //System.out.println("LibelleCourt : " + MytempCell.getStringCellValue());
                                        rowEc.setAttribute("LibelleCourt", MytempCell.getStringCellValue());
                                    }
                                }
                            } else {
                                Index++;
                            }
                        }
                        //System.out.println("Is row Ec null : " + (rowEc.getAttribute("LibelleLong") == null));
                        if (rowEc.getAttribute("LibelleLong") == null || rowEc.getAttribute("LibelleCourt") == null) {
                            //System.out.println("Ligne Mention vide");
                            rowEc.removeAndRetain();
                            OperationBinding op_rlbk = BindingContext.getCurrent()
                                                                     .getCurrentBindingsEntry()
                                                                     .getOperationBinding("Rollback");
                            op_rlbk.execute();
                        }
                        try {
                            OperationBinding op_commit = BindingContext.getCurrent()
                                                                       .getCurrentBindingsEntry()
                                                                       .getOperationBinding("Commit");
                            op_commit.execute();

                        } catch (Exception e) {
                            System.out.println(e.getMessage());
                        }
                    }
                    skipcnt++;
                }
            }
            //Import Maquette
            if (sheetIndex == 12) {
                System.out.println("Titre feuille : " + WorkBook.getSheetAt(sheetIndex).getSheetName());
                //Section (LIBELLE_LONG,LIBELLE_COURT)
                //Iterate over excel rows
                for (org.apache.poi.ss.usermodel.Row tempRow : sheet) {
                    if (skipcnt > skipRw) { //skip first n row for labels.
                        //Create new row in table
                        OperationBinding op_new_mq = BindingContext.getCurrent()
                                                                   .getCurrentBindingsEntry()
                                                                   .getOperationBinding("CreateMaquette");
                        op_new_mq.execute();
                        Row rowMq = iterMaquette.getCurrentRow();
                        int Index = 0;
                        //Iterate over row's columns
                        for (int column = 0; column < tempRow.getLastCellNum(); column++) {
                            Cell MytempCell = tempRow.getCell(column);
                            if (MytempCell != null) {
                                Index = MytempCell.getColumnIndex();
                                if (Index == 1) {
                                    if (MytempCell.getStringCellValue() !=
                                        null) {
                                        //isSectionExist
                                        OperationBinding is_exist =
         BindingContext.getCurrent()
                                                                                  .getCurrentBindingsEntry()
                                                                                  .getOperationBinding("isMaquetteExist");
                                        is_exist.getParamsMap().put("lib", MytempCell.getStringCellValue());
                                        is_exist.execute();
                                        DCIteratorBinding iterExist =
                                            (DCIteratorBinding) BindingContext.getCurrent()
                                                                                                        .getCurrentBindingsEntry()
                                                                                                        .get("isMaquetteExist1Iterator");
                                        if (iterExist.getEstimatedRowCount() >
                                            0) {
                                            //iter.getCurrentRow().remove();
                                            System.out.println("Maquette " + MytempCell.getStringCellValue() +
                                                               " Existant !!!");
                                            rowMq.removeAndRetain();
                                            break;
                                        }
                                        //System.out.println("LibelleLong : " + MytempCell.getStringCellValue());
                                        rowMq.setAttribute("LibelleLong", MytempCell.getStringCellValue());
                                        //UtiCree
                                        rowMq.setAttribute("UtiCree", getUtilisateur());
                                    }
                                } else if (Index == 2) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        //System.out.println("LibelleCourt : " + MytempCell.getStringCellValue());
                                        rowMq.setAttribute("LibelleCourt", MytempCell.getStringCellValue());
                                    }
                                }
                            } else {
                                Index++;
                            }
                        }
                        //System.out.println("Is row Maquette null : " + (rowMq.getAttribute("LibelleLong") == null));
                        if (rowMq.getAttribute("LibelleLong") == null || rowMq.getAttribute("LibelleCourt") == null) {
                            //System.out.println("Ligne Mention vide");
                            rowMq.removeAndRetain();
                            OperationBinding op_rlbk = BindingContext.getCurrent()
                                                                     .getCurrentBindingsEntry()
                                                                     .getOperationBinding("Rollback");
                            op_rlbk.execute();
                        }
                        try {
                            OperationBinding op_commit = BindingContext.getCurrent()
                                                                       .getCurrentBindingsEntry()
                                                                       .getOperationBinding("Commit");
                            op_commit.execute();

                        } catch (Exception e) {
                            System.out.println(e.getMessage());
                        }
                    }
                    skipcnt++;
                }
            }
            //Import FiliereUeSemestre
            if (sheetIndex == 13) {
                System.out.println("Titre feuille : " + WorkBook.getSheetAt(sheetIndex).getSheetName());
                //Iterate over excel rows
                for (org.apache.poi.ss.usermodel.Row tempRow : sheet) {
                    if (skipcnt > skipRw) { //skip first n row for labels.
                        //Create new row in table
                        OperationBinding op_new_s = BindingContext.getCurrent()
                                                                  .getCurrentBindingsEntry()
                                                                  .getOperationBinding("CreateFiliereUeSemestre");
                        op_new_s.execute();
                        Row rowF = iterFilUe.getCurrentRow();
                        int Index = 0;
                        int ue = 0;
                        int sem = 0;
                        int maq = 0;
                        //Iterate over row's columns
                        for (int column = 0; column < tempRow.getLastCellNum(); column++) {
                            Cell MytempCell = tempRow.getCell(column);
                            if (MytempCell != null) {
                                Index = MytempCell.getColumnIndex();
                                if (Index == 0) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        //System.out.println("Codification : " + MytempCell.getStringCellValue());
                                        rowF.setAttribute("Codification", MytempCell.getStringCellValue());
                                        //UtiCree
                                        rowF.setAttribute("UtiCree", getUtilisateur());
                                    }
                                } else if (Index == 1) {
                                    if (MytempCell.getStringCellValue() !=
                                        null) {
                                        //isEtabExist
                                        OperationBinding is_exist =
         BindingContext.getCurrent()
                                                                                  .getCurrentBindingsEntry()
                                                                                  .getOperationBinding("isMaquetteExist");
                                        is_exist.getParamsMap().put("lib", MytempCell.getStringCellValue());
                                        is_exist.execute();
                                        DCIteratorBinding iterExist =
                                            (DCIteratorBinding) BindingContext.getCurrent()
                                                                                                        .getCurrentBindingsEntry()
                                                                                                        .get("isMaquetteExist1Iterator");
                                        if (iterExist.getEstimatedRowCount() > 0) {
                                            rowF.setAttribute("IdMaquette", Integer.parseInt(iterExist.getCurrentRow()
                                                                                                      .getAttribute("IdMaquette")
                                                                                                      .toString()));
                                            maq = Integer.parseInt(iterExist.getCurrentRow()
                                                                            .getAttribute("IdMaquette")
                                                                            .toString());
                                            //System.out.println("Maquette ; "+" id : "+maq+" libelle : " + MytempCell.getStringCellValue());
                                        }
                                    }
                                } else if (Index == 2) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        OperationBinding is_exist = BindingContext.getCurrent()
                                                                                  .getCurrentBindingsEntry()
                                                                                  .getOperationBinding("isUeExist");
                                        is_exist.getParamsMap().put("lib", MytempCell.getStringCellValue());
                                        is_exist.execute();
                                        DCIteratorBinding iterExist =
                                            (DCIteratorBinding) BindingContext.getCurrent()
                                                                                                        .getCurrentBindingsEntry()
                                                                                                        .get("IsUeExistROVO1Iterator");
                                        if (iterExist.getEstimatedRowCount() > 0) {
                                            rowF.setAttribute("IdUe", Integer.parseInt(iterExist.getCurrentRow()
                                                                                                .getAttribute("IdUe")
                                                                                                .toString()));
                                            ue = Integer.parseInt(iterExist.getCurrentRow()
                                                                           .getAttribute("IdUe")
                                                                           .toString());
                                            //System.out.println("Ue : "+" id : "+ue+" libelle : " + MytempCell.getStringCellValue());
                                        }
                                    }
                                } else if (Index == 3) {
                                    if ((int) MytempCell.getNumericCellValue() != 0) {
                                        rowF.setAttribute("IdSemestre", (int) MytempCell.getNumericCellValue());
                                        sem = (int) MytempCell.getNumericCellValue();
                                        //System.out.println("Semestre : "+" id : "+sem+" libelle : " + MytempCell.getNumericCellValue());
                                    }
                                } else if (Index == 4) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        OperationBinding is_exist =
                                            BindingContext.getCurrent()
                                                                                  .getCurrentBindingsEntry()
                                                                                  .getOperationBinding("getCategorieUe");
                                        is_exist.getParamsMap().put("lib", MytempCell.getStringCellValue());
                                        is_exist.execute();
                                        DCIteratorBinding iterCatExist =
                                            (DCIteratorBinding) BindingContext.getCurrent()
                                                                                                           .getCurrentBindingsEntry()
                                                                                                           .get("getCategorieUE1Iterator");

                                        if (iterCatExist.getEstimatedRowCount() > 0) {
                                            rowF.setAttribute("IdCategorieUe",
                                                              Integer.parseInt(iterCatExist.getCurrentRow()
                                                                                                            .getAttribute("IdCategorieUe")
                                                                                                            .toString()));
                                            /*  System.out.println(" Categorie ue , id : "+iterCatExist.getCurrentRow()
                                                                                                                                                .getAttribute("IdCategorieUe")
                                                                                                                                                .toString()+" libelle : "+MytempCell.getStringCellValue()); */
                                        }
                                    }
                                } else if (Index == 5) {
                                    if ((int) MytempCell.getNumericCellValue() != 0) {
                                        rowF.setAttribute("Credit", (int) MytempCell.getNumericCellValue());
                                        //System.out.println("Credit : "+(int) MytempCell.getNumericCellValue());
                                    }
                                } else if (Index == 6) {
                                    if ((int) MytempCell.getNumericCellValue() != 0) {
                                        //rowFilUe.setAttribute("Coefficient", (float)MytempCell.getNumericCellValue());
                                        rowF.setAttribute("Coefficient", (int) MytempCell.getNumericCellValue());
                                        //System.out.println("Coefficient : "+(int) MytempCell.getNumericCellValue());


                                    }
                                } else if (Index == 7) {
                                    rowF.setAttribute("MoyenneValidation", (int) MytempCell.getNumericCellValue());
                                    //System.out.println("MoyenneValidation : " +(int)MytempCell.getNumericCellValue());

                                } else if (Index == 8) {
                                    rowF.setAttribute("MoyenneEliminatoire", (int) MytempCell.getNumericCellValue());
                                    //System.out.println("MoyenneEliminatoire : "+(int) MytempCell.getNumericCellValue());
                                } else if (Index == 9) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        OperationBinding is_exist = BindingContext.getCurrent()
                                                                                  .getCurrentBindingsEntry()
                                                                                  .getOperationBinding("getNatureUe");
                                        is_exist.getParamsMap().put("lib", MytempCell.getStringCellValue());
                                        is_exist.execute();
                                        DCIteratorBinding iterExist =
                                            (DCIteratorBinding) BindingContext.getCurrent()
                                                                                                        .getCurrentBindingsEntry()
                                                                                                        .get("getNatureUe1Iterator");
                                        if (iterExist.getEstimatedRowCount() > 0) {
                                            rowF.setAttribute("IdNatureUe", Integer.parseInt(iterExist.getCurrentRow()
                                                                                                      .getAttribute("IdNatureUe")
                                                                                                      .toString()));
                                            /* System.out.println("NatureUe id : " + Integer.parseInt(iterExist.getCurrentRow().getAttribute("IdNatureUe").toString())+
                                                                                                   " libelle : "+MytempCell.getStringCellValue()); */
                                        }
                                    }
                                }
                                //Compensable
                                else if (Index == 10) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        if (MytempCell.getStringCellValue().equals("OUI")) {
                                            rowF.setAttribute("Compensable", 1);
                                        }
                                        //System.out.println("Compensable : " + MytempCell.getStringCellValue());
                                    }
                                }

                            } else {
                                Index++;
                            }
                        }
                        //if required_val missing
                        if (rowF.getAttribute("Codification") == null || rowF.getAttribute("IdMaquette") == null ||
                            rowF.getAttribute("IdUe") == null || rowF.getAttribute("IdSemestre") == null ||
                            rowF.getAttribute("IdCategorieUe") == null || rowF.getAttribute("Credit") == null ||
                            rowF.getAttribute("Coefficient") == null ||
                            rowF.getAttribute("MoyenneValidation").equals(null) ||
                            rowF.getAttribute("MoyenneEliminatoire").equals(null) ||
                            rowF.getAttribute("IdNatureUe") == null) {
                            rowF.removeAndRetain();
                            System.out.println("Des champs obligatoires manquantes dans Fil_ue");
                            OperationBinding op_commit_et = BindingContext.getCurrent()
                                                                          .getCurrentBindingsEntry()
                                                                          .getOperationBinding("Rollback");
                            op_commit_et.execute();
                        }
                        OperationBinding is_exist_fil_ue = BindingContext.getCurrent()
                                                                         .getCurrentBindingsEntry()
                                                                         .getOperationBinding("isFilUeExist");
                        is_exist_fil_ue.getParamsMap().put("ue", ue);
                        is_exist_fil_ue.getParamsMap().put("sem", sem);
                        is_exist_fil_ue.getParamsMap().put("mq", maq);
                        is_exist_fil_ue.execute();
                        DCIteratorBinding iterExist_f =
                            (DCIteratorBinding) BindingContext.getCurrent()
                                                                                          .getCurrentBindingsEntry()
                                                                                          .get("isFilUeExistROVO1Iterator");
                        if (iterExist_f.getEstimatedRowCount() >
                            0) {
                            //iter.getCurrentRow().remove();
                            System.out.println("FilUe Existant id : " +
                                               iterExist_f.getCurrentRow().getAttribute("IdFiliereUeSemstre"));
                            OperationBinding op_rlbk = BindingContext.getCurrent()
                                                                     .getCurrentBindingsEntry()
                                                                     .getOperationBinding("Rollback");
                            op_rlbk.execute();
                        }
                        try {
                            OperationBinding op_commit_et = BindingContext.getCurrent()
                                                                          .getCurrentBindingsEntry()
                                                                          .getOperationBinding("Commit");
                            op_commit_et.execute();
                        } catch (Exception e) {
                            System.out.println(e.getMessage());
                        }
                    }
                    skipcnt++;
                }
            }
            //Import FiliereUeSemestreEc
            if (sheetIndex == 14) {
                System.out.println("Titre feuille : " + WorkBook.getSheetAt(sheetIndex).getSheetName());
                //Iterate over excel rows
                for (org.apache.poi.ss.usermodel.Row tempRow : sheet) {
                    if (skipcnt > skipRw) { //skip first n row for labels.
                        //Create new row in table
                        OperationBinding op_new_s = BindingContext.getCurrent()
                                                                  .getCurrentBindingsEntry()
                                                                  .getOperationBinding("CreateFiliereUeSemestreEc");
                        op_new_s.execute();
                        Row rowFilEc = iterFilEc.getCurrentRow();
                        int Index = 0;
                        int ue = 0;
                        int ec = 0;
                        //Iterate over row's columns
                        for (int column = 0; column < tempRow.getLastCellNum(); column++) {
                            Cell MytempCell = tempRow.getCell(column);
                            if (MytempCell != null) {
                                Index = MytempCell.getColumnIndex();
                                if (Index == 0) {
                                    rowFilEc.setAttribute("Codification", MytempCell.getStringCellValue());
                                    //UtiCree
                                    rowFilEc.setAttribute("UtiCree", getUtilisateur());
                                } else if (Index == 1) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        OperationBinding is_exist = BindingContext.getCurrent()
                                                                                  .getCurrentBindingsEntry()
                                                                                  .getOperationBinding("getFilUe");
                                        is_exist.getParamsMap().put("cod", MytempCell.getStringCellValue());
                                        is_exist.execute();
                                        DCIteratorBinding iterExist =
                                            (DCIteratorBinding) BindingContext.getCurrent()
                                                                                                        .getCurrentBindingsEntry()
                                                                                                        .get("getFilUeROVO1Iterator");
                                        if (iterExist.getEstimatedRowCount() > 0) {
                                            rowFilEc.setAttribute("IdFiliereUeSemstre",
                                                                  Integer.parseInt(iterExist.getCurrentRow()
                                                                                                                  .getAttribute("IdFiliereUeSemstre")
                                                                                                                  .toString()));
                                            // System.out.println("FiliereUeSemstre : " + MytempCell.getStringCellValue());
                                            /* ue = Integer.parseInt(iterExist.getCurrentRow()
                                                                                                               .getAttribute("IdFiliereUeSemstre")
                                                                                                               .toString()); */
                                        }
                                    }
                                } else if (Index == 2) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        OperationBinding is_exist = BindingContext.getCurrent()
                                                                                  .getCurrentBindingsEntry()
                                                                                  .getOperationBinding("isEcExist");
                                        is_exist.getParamsMap().put("lib", MytempCell.getStringCellValue());
                                        is_exist.execute();
                                        DCIteratorBinding iterExist =
                                            (DCIteratorBinding) BindingContext.getCurrent()
                                                                                                        .getCurrentBindingsEntry()
                                                                                                        .get("isEcExistROVO1Iterator");
                                        if (iterExist.getEstimatedRowCount() > 0) {
                                            rowFilEc.setAttribute("IdEc", Integer.parseInt(iterExist.getCurrentRow()
                                                                                                    .getAttribute("IdEc")
                                                                                                    .toString()));
                                            //System.out.println("Ec : " + MytempCell.getStringCellValue());
                                            /* ec = Integer.parseInt(iterExist.getCurrentRow()
                                                                                                               .getAttribute("IdEc")
                                                                                                               .toString()); */
                                        }
                                    }
                                } else if (Index == 3) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        OperationBinding is_exist = BindingContext.getCurrent()
                                                                                  .getCurrentBindingsEntry()
                                                                                  .getOperationBinding("getNatureEc");
                                        is_exist.getParamsMap().put("lib", MytempCell.getStringCellValue());
                                        is_exist.execute();
                                        DCIteratorBinding iterExist =
                                            (DCIteratorBinding) BindingContext.getCurrent()
                                                                                                        .getCurrentBindingsEntry()
                                                                                                        .get("getNatureEc1Iterator");
                                        if (iterExist.getEstimatedRowCount() > 0) {
                                            rowFilEc.setAttribute("IdNatureEc", Integer.parseInt(iterExist.getCurrentRow()
                                                                                                          .getAttribute("IdNatureEc")
                                                                                                          .toString()));
                                        }
                                    }
                                } else if (Index == 4) {
                                    if ((int) MytempCell.getNumericCellValue() != 0) {
                                        rowFilEc.setAttribute("Coefficient", (int) MytempCell.getNumericCellValue());
                                    }

                                } else if (Index == 5) {
                                    rowFilEc.setAttribute("MoyenneValidation", (int) MytempCell.getNumericCellValue());

                                } else if (Index == 6) {
                                    rowFilEc.setAttribute("MoyenneEliminatoire",
                                                          (int) MytempCell.getNumericCellValue());
                                } else if (Index == 7) {
                                    rowFilEc.setAttribute("PourcentageCc", (int) MytempCell.getNumericCellValue());

                                } else if (Index == 8) {
                                    rowFilEc.setAttribute("PourcentageCt", (int) MytempCell.getNumericCellValue());

                                } else if (Index == 9) {
                                    rowFilEc.setAttribute("HeuresCm", (int) MytempCell.getNumericCellValue());

                                } else if (Index == 10) {
                                    rowFilEc.setAttribute("HeuresTd", (int) MytempCell.getNumericCellValue());

                                } else if (Index == 11) {
                                    rowFilEc.setAttribute("HeuresTp", (int) MytempCell.getNumericCellValue());

                                } else if (Index == 12) {
                                    rowFilEc.setAttribute("HeuresTpe", (int) MytempCell.getNumericCellValue());

                                } else if (Index == 13) {
                                    rowFilEc.setAttribute("HeuresStage", (int) MytempCell.getNumericCellValue());
                                }

                            } else {
                                Index++;
                            }
                        }
                        //if required_val missing
                        if ((rowFilEc.getAttribute("IdFiliereUeSemstre") == null) ||
                            (rowFilEc.getAttribute("IdEc") == null) || (rowFilEc.getAttribute("IdNatureEc") == null) ||
                            (rowFilEc.getAttribute("Coefficient") == null)) {
                            rowFilEc.removeAndRetain();
                            System.out.println("Des champs obligatoires manquantes dans Fil_ec");
                            OperationBinding op_r = BindingContext.getCurrent()
                                                                  .getCurrentBindingsEntry()
                                                                  .getOperationBinding("Rollback");
                            op_r.execute();
                        } else {
                            /* System.out.println("IdFiliereUeSemstre : " +
                                               rowFilEc.getAttribute("IdFiliereUeSemstre").toString() + " IdEc : " +
                                               rowFilEc.getAttribute("IdEc") + " IdNatureEc " +
                                               rowFilEc.getAttribute("IdNatureEc") + " Coefficient :" +
                                               rowFilEc.getAttribute("Coefficient") + " PourcentageCc : " +
                                               rowFilEc.getAttribute("PourcentageCc") + " PourcentageCt : " +
                                               rowFilEc.getAttribute("PourcentageCt") + " MoyenneValidation : " +
                                               rowFilEc.getAttribute("MoyenneValidation") + " MoyenneEliminatoire : " +
                                               rowFilEc.getAttribute("MoyenneEliminatoire")); */
                        }
                        OperationBinding is_exist_fil_ec = BindingContext.getCurrent()
                                                                         .getCurrentBindingsEntry()
                                                                         .getOperationBinding("isFilEcExist");
                        is_exist_fil_ec.getParamsMap().put("fs", rowFilEc.getAttribute("IdFiliereUeSemstre"));
                        is_exist_fil_ec.getParamsMap().put("ec", rowFilEc.getAttribute("IdEc"));
                        is_exist_fil_ec.execute();
                        DCIteratorBinding iterExist_f =
                            (DCIteratorBinding) BindingContext.getCurrent()
                                                                                          .getCurrentBindingsEntry()
                                                                                          .get("isFilEcExistROVO1Iterator");
                        if (iterExist_f.getEstimatedRowCount() >
                            0) {
                            //iter.getCurrentRow().remove();
                            System.out.println("FilEc Existant id : " +
                                               iterExist_f.getCurrentRow().getAttribute("IdFiliereUeSemstreEc"));
                            OperationBinding op_rlbk = BindingContext.getCurrent()
                                                                     .getCurrentBindingsEntry()
                                                                     .getOperationBinding("Rollback");
                            op_rlbk.execute();
                        }
                        try {
                            System.out.println("Commiting FilEc...");
                            OperationBinding op_commit_ = BindingContext.getCurrent()
                                                                        .getCurrentBindingsEntry()
                                                                        .getOperationBinding("Commit");
                            op_commit_.execute();
                            System.out.println("Commited !!!");
                        } catch (Exception e) {
                            System.out.println(e.getMessage());
                        }
                    }
                    skipcnt++;
                }
            }
            //Import MaquetteNiveau
            if (sheetIndex == 15) {
                System.out.println("Titre feuille : " + WorkBook.getSheetAt(sheetIndex).getSheetName());
                //Iterate over excel rows
                for (org.apache.poi.ss.usermodel.Row tempRow : sheet) {
                    if (skipcnt > skipRw) { //skip first n row for labels.
                        //Create new row in table
                        OperationBinding op_new_nfma = BindingContext.getCurrent()
                                                                     .getCurrentBindingsEntry()
                                                                     .getOperationBinding("CreateNivForm");
                        op_new_nfma.execute();
                        Row rowMA = iterNivFromMaqAnn.getCurrentRow();
                        int Index = 0;
                        /* int an = 0;
                                                            int maq = 0;
                                                            int niv_fr = 0; */
                        //Iterate over row's columns
                        for (int column = 0; column < tempRow.getLastCellNum(); column++) {
                            Cell MytempCell = tempRow.getCell(column);
                            if (MytempCell != null) {
                                Index = MytempCell.getColumnIndex();
                                if (Index == 0) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        OperationBinding is_exist = BindingContext.getCurrent()
                                                                                  .getCurrentBindingsEntry()
                                                                                  .getOperationBinding("getNivForm");
                                        is_exist.getParamsMap().put("lib", MytempCell.getStringCellValue());
                                        is_exist.execute();
                                        DCIteratorBinding iterExist =
                                            (DCIteratorBinding) BindingContext.getCurrent()
                                                                                                        .getCurrentBindingsEntry()
                                                                                                        .get("getNivForm1Iterator");
                                        if (iterExist.getEstimatedRowCount() > 0) {
                                            rowMA.setAttribute("IdNiveauFormation",
                                                               Integer.parseInt(iterExist.getCurrentRow()
                                                                                                              .getAttribute("IdNiveauFormation")
                                                                                                              .toString()));
                                            /* System.out.println("IdNiveauFormation : " + iterExist.getCurrentRow()
                                                                                                                                     .getAttribute("IdNiveauFormation")
                                                                                                                                     .toString()); */
                                        }
                                        //UtiCree
                                        rowMA.setAttribute("UtiCree", getUtilisateur());
                                    }
                                } else if (Index == 1) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        OperationBinding is_exist =
                                            BindingContext.getCurrent()
                                                                                  .getCurrentBindingsEntry()
                                                                                  .getOperationBinding("isMaquetteExist");
                                        is_exist.getParamsMap().put("lib", MytempCell.getStringCellValue());
                                        is_exist.execute();
                                        DCIteratorBinding iterExist =
                                            (DCIteratorBinding) BindingContext.getCurrent()
                                                                                                        .getCurrentBindingsEntry()
                                                                                                        .get("isMaquetteExist1Iterator");
                                        if (iterExist.getEstimatedRowCount() > 0) {
                                            rowMA.setAttribute("IdMaquette", Integer.parseInt(iterExist.getCurrentRow()
                                                                                                       .getAttribute("IdMaquette")
                                                                                                       .toString()));
                                        }
                                    }
                                } else if (Index == 2) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        OperationBinding is_exist = BindingContext.getCurrent()
                                                                                  .getCurrentBindingsEntry()
                                                                                  .getOperationBinding("getAnnee");
                                        is_exist.getParamsMap().put("lib", MytempCell.getStringCellValue());
                                        is_exist.execute();
                                        DCIteratorBinding iterExist =
                                            (DCIteratorBinding) BindingContext.getCurrent()
                                                                                                        .getCurrentBindingsEntry()
                                                                                                        .get("getAnneeUnivers1Iterator");
                                        if (iterExist.getEstimatedRowCount() > 0) {
                                            rowMA.setAttribute("IdAnneesUnivers",
                                                               Integer.parseInt(iterExist.getCurrentRow()
                                                                                                            .getAttribute("IdAnneesUnivers")
                                                                                                            .toString()));
                                        }
                                    }
                                }
                            } else {
                                Index++;
                            }
                        }
                        //isNivFormMaqAnExist
                        OperationBinding is_niv_exist = BindingContext.getCurrent()
                                                                      .getCurrentBindingsEntry()
                                                                      .getOperationBinding("isNivFormMaqAnneeExist");
                        is_niv_exist.getParamsMap().put("niv", rowMA.getAttribute("IdNiveauFormation"));
                        is_niv_exist.getParamsMap().put("anne", rowMA.getAttribute("IdAnneesUnivers"));
                        is_niv_exist.getParamsMap().put("maq", rowMA.getAttribute("IdMaquette"));
                        is_niv_exist.execute();
                        DCIteratorBinding iterExist =
                            (DCIteratorBinding) BindingContext.getCurrent()
                                                                                        .getCurrentBindingsEntry()
                                                                                        .get("isNivFormMaqAnneeExistROVO1Iterator");
                        if (iterExist.getEstimatedRowCount() > 0) {
                            System.out.println("Maquette Niveau Formation exist !!!");
                            OperationBinding op_rlb = BindingContext.getCurrent()
                                                                    .getCurrentBindingsEntry()
                                                                    .getOperationBinding("Rollback");
                            op_rlb.execute();
                        }

                        if (rowMA.getAttribute("IdAnneesUnivers") == null || rowMA.getAttribute("IdMaquette") == null ||
                            rowMA.getAttribute("IdNiveauFormation") == null) {
                            System.out.println("Des valeurs obligatoires manques");
                            OperationBinding op_rlb = BindingContext.getCurrent()
                                                                    .getCurrentBindingsEntry()
                                                                    .getOperationBinding("Rollback");
                            op_rlb.execute();
                        }
                        try {
                            OperationBinding op_commit_s = BindingContext.getCurrent()
                                                                         .getCurrentBindingsEntry()
                                                                         .getOperationBinding("Commit");
                            op_commit_s.execute();

                        } catch (Exception e) {
                            System.out.println(e.getMessage());
                        }
                    }
                    skipcnt++;
                }
            }
            //Import Personnes(Membres)
            //Tarifs
            if (sheetIndex == 17) {
                System.out.println("Titre feuille : " + WorkBook.getSheetAt(sheetIndex).getSheetName());
                //Iterate over excel rows
                for (org.apache.poi.ss.usermodel.Row tempRow : sheet) {
                    if (skipcnt > skipRw) { //skip first n row for labels.
                        //Create new row in table
                        //CreateDroitNiveauPays
                        OperationBinding op_new_ = BindingContext.getCurrent()
                                                                 .getCurrentBindingsEntry()
                                                                 .getOperationBinding("CreateDroitNiveauPays");
                        op_new_.execute();
                        Row rowDNF = iterDroitNivPays.getCurrentRow();
                        int Index = 0;
                        /* int pay = 0;
                                                            int diaetr = 0;
                                                            int dipetr = 0;
                                                            int niv_ = 0; */
                        //Iterate over row's columns
                        for (int column = 0; column < tempRow.getLastCellNum(); column++) {
                            Cell MytempCell = tempRow.getCell(column);
                            if (MytempCell != null) {
                                Index = MytempCell.getColumnIndex();
                                if (Index == 0) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        OperationBinding is_exist = BindingContext.getCurrent()
                                                                                  .getCurrentBindingsEntry()
                                                                                  .getOperationBinding("isNiveauExist");
                                        is_exist.getParamsMap().put("lib", MytempCell.getStringCellValue());
                                        is_exist.execute();
                                        DCIteratorBinding iterExist =
                                            (DCIteratorBinding) BindingContext.getCurrent()
                                                                                                        .getCurrentBindingsEntry()
                                                                                                        .get("isNiveauExist1Iterator");
                                        if (iterExist.getEstimatedRowCount() > 0) {
                                            /*
                                                                                niv_ = Integer.parseInt(iterExist.getCurrentRow()
                                                                                                                 .getAttribute("IdNiveau")
                                                                                                                 .toString()); */
                                            rowDNF.setAttribute("IdNiveau", Long.parseLong(iterExist.getCurrentRow()
                                                                                                    .getAttribute("IdNiveau")
                                                                                                    .toString()));
                                            rowDNF.setAttribute("UtiCree", getUtilisateur());
                                        }
                                    }
                                } else if (Index == 1) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        OperationBinding is_exist = BindingContext.getCurrent()
                                                                                  .getCurrentBindingsEntry()
                                                                                  .getOperationBinding("getPays");
                                        is_exist.getParamsMap().put("lib", MytempCell.getStringCellValue());
                                        is_exist.execute();
                                        DCIteratorBinding iterExist =
                                            (DCIteratorBinding) BindingContext.getCurrent()
                                                                                                        .getCurrentBindingsEntry()
                                                                                                        .get("getPays1Iterator");
                                        if (iterExist.getEstimatedRowCount() > 0) {
                                            rowDNF.setAttribute("IdPays", Long.parseLong(iterExist.getCurrentRow()
                                                                                                  .getAttribute("IdPays")
                                                                                                  .toString()));
                                            /*  pay = Integer.parseInt(iterExist.getCurrentRow()
                                                                                                                .getAttribute("IdPays")
                                                                                                                .toString()); */
                                        }
                                    }
                                } else if (Index == 2) {
                                    rowDNF.setAttribute("DroitInsAdm", (int) MytempCell.getNumericCellValue());

                                } else if (Index == 3) {
                                    rowDNF.setAttribute("DroitInsPed", (int) MytempCell.getNumericCellValue());

                                } else if (Index == 4) {
                                    rowDNF.setAttribute("CoutFormation", (int) MytempCell.getNumericCellValue());

                                }
                            } else {
                                Index++;
                            }
                        }
                        //isDroitNivPaysExist
                        OperationBinding is_niv_exist = BindingContext.getCurrent()
                                                                      .getCurrentBindingsEntry()
                                                                      .getOperationBinding("isDroitNivPaysExist");
                        is_niv_exist.getParamsMap().put("niv_id", rowDNF.getAttribute("IdNiveau"));
                        is_niv_exist.getParamsMap().put("pays_id", rowDNF.getAttribute("IdPays"));
                        is_niv_exist.execute();
                        DCIteratorBinding iterExist =
                            (DCIteratorBinding) BindingContext.getCurrent()
                                                                                        .getCurrentBindingsEntry()
                                                                                        .get("isDroitNiveauPaysExist1Iterator");
                        if (iterExist.getEstimatedRowCount() > 0) {
                            System.out.println("Droit niveau pays exist !!!");
                            OperationBinding op_rlb = BindingContext.getCurrent()
                                                                    .getCurrentBindingsEntry()
                                                                    .getOperationBinding("Rollback");
                            op_rlb.execute();
                        }

                        if ((rowDNF.getAttribute("IdNiveau") == null) || (rowDNF.getAttribute("IdPays") == null)) {
                            System.out.println("Des valeurs obligatoires manques");
                            OperationBinding op_rlb = BindingContext.getCurrent()
                                                                    .getCurrentBindingsEntry()
                                                                    .getOperationBinding("Rollback");
                            op_rlb.execute();
                        }
                        try {
                            OperationBinding op_commit_s = BindingContext.getCurrent()
                                                                         .getCurrentBindingsEntry()
                                                                         .getOperationBinding("Commit");
                            op_commit_s.execute();

                        } catch (Exception e) {
                            System.out.println(e.getMessage());
                        }
                    }
                    skipcnt++;
                }
            }
            //Import Formation_specialite
            if (sheetIndex == 18) {
                System.out.println("Titre feuille : " + WorkBook.getSheetAt(sheetIndex).getSheetName());
                //Iterate over excel rows
                for (org.apache.poi.ss.usermodel.Row tempRow : sheet) {
                    if (skipcnt > skipRw) { //skip first n row for labels.
                        //Create new row in table
                        OperationBinding op_new_fr_sp = BindingContext.getCurrent()
                                                                      .getCurrentBindingsEntry()
                                                                      .getOperationBinding("CreateFormSpec");
                        op_new_fr_sp.execute();
                        Row rowFormSpec = iterFormSpec.getCurrentRow();
                        int Index = 0;
                        //Iterate over row's columns
                        for (int column = 0; column < tempRow.getLastCellNum(); column++) {
                            Cell MytempCell = tempRow.getCell(column);
                            if (MytempCell != null) {
                                Index = MytempCell.getColumnIndex();
                                if (Index == 0) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        OperationBinding is_exist = BindingContext.getCurrent()
                                                                                  .getCurrentBindingsEntry()
                                                                                  .getOperationBinding("getFromation");
                                        is_exist.getParamsMap().put("lib", MytempCell.getStringCellValue());
                                        is_exist.execute();
                                        DCIteratorBinding iterExist =
                                            (DCIteratorBinding) BindingContext.getCurrent()
                                                                                                        .getCurrentBindingsEntry()
                                                                                                        .get("getFormation1Iterator");
                                        if (iterExist.getEstimatedRowCount() > 0) {
                                            rowFormSpec.setAttribute("IdFormation",
                                                                     Long.parseLong(iterExist.getCurrentRow()
                                                                                                            .getAttribute("IdFormation")
                                                                                                            .toString()));
                                        }
                                    }
                                    rowFormSpec.setAttribute("UtiCree", this.getUtilisateur());
                                } else if (Index == 1) {
                                    if (MytempCell.getStringCellValue() != null) {
                                        OperationBinding is_spec_exist =
                                            BindingContext.getCurrent()
                                                                                       .getCurrentBindingsEntry()
                                                                                       .getOperationBinding("getSpecialite");
                                        is_spec_exist.getParamsMap().put("lib", MytempCell.getStringCellValue());
                                        is_spec_exist.execute();
                                        DCIteratorBinding iterExistSpec =
                                            (DCIteratorBinding) BindingContext.getCurrent()
                                                                                                            .getCurrentBindingsEntry()
                                                                                                            .get("GetSpecialiteROVO1Iterator");
                                        //System.out.println("Mention size : " + iterExistM.getEstimatedRowCount());
                                        if (iterExistSpec.getEstimatedRowCount() > 0) {
                                            rowFormSpec.setAttribute("IdSpecialite",
                                                                     Long.parseLong(iterExistSpec.getCurrentRow()
                                                                                                                 .getAttribute("IdSpecialite")
                                                                                                                 .toString()));
                                        }
                                    }
                                }
                            } else {
                                Index++;
                            }
                        }
                        if (rowFormSpec.getAttribute("IdFormation") == null ||
                            rowFormSpec.getAttribute("IdSpecialite") == null) {
                            //System.out.println("Ligne Mention vide");
                            rowFormSpec.removeAndRetain();
                            OperationBinding op_rlbk = BindingContext.getCurrent()
                                                                     .getCurrentBindingsEntry()
                                                                     .getOperationBinding("Rollback");
                            op_rlbk.execute();
                        }
                        System.out.println("IdFormation : " + rowFormSpec.getAttribute("IdFormation"));
                        System.out.println("IdSpecialite : " + rowFormSpec.getAttribute("IdSpecialite"));
                        System.out.println("User : " + rowFormSpec.getAttribute("UtiCree"));
                        OperationBinding is_exist = BindingContext.getCurrent()
                                                                  .getCurrentBindingsEntry()
                                                                  .getOperationBinding("isFormSpecExist");
                        is_exist.getParamsMap().put("form_id", rowFormSpec.getAttribute("IdFormation"));
                        is_exist.getParamsMap().put("spec_id", rowFormSpec.getAttribute("IdSpecialite"));
                        is_exist.execute();
                        DCIteratorBinding iterExist =
                            (DCIteratorBinding) BindingContext.getCurrent()
                                                                                        .getCurrentBindingsEntry()
                                                                                        .get("isFormSpecExist1Iterator");
                        if (iterExist.getEstimatedRowCount() > 0) {
                            rowFormSpec.removeAndRetain();
                            System.out.println("Formation Spcialit existant : " +
                                               rowFormSpec.getAttribute("IdFormation") + " - " + "" +
                                               rowFormSpec.getAttribute("IdSpecialite"));
                            OperationBinding op_rlbk = BindingContext.getCurrent()
                                                                     .getCurrentBindingsEntry()
                                                                     .getOperationBinding("Rollback");
                            op_rlbk.execute();
                        }
                        try {
                            OperationBinding op_commit_sp = BindingContext.getCurrent()
                                                                          .getCurrentBindingsEntry()
                                                                          .getOperationBinding("Commit");
                            op_commit_sp.execute();

                        } catch (Exception e) {
                            //System.out.println(e.getMessage());
                        }
                    }
                    skipcnt++;
                }
            }
        }
        this.getPopupImport().hide();
    }

    public void setMaqpage(RichPanelGroupLayout maqpage) {
        this.maqpage = maqpage;
    }

    public RichPanelGroupLayout getMaqpage() {
        return maqpage;
    }

    public void OnImportEtudiantAction(ActionEvent actionEvent) {
        // Add event code here...
    }

    public void setPopupImportEtu(RichPopup popupImportEtu) {
        this.popupImportEtu = popupImportEtu;
    }

    public RichPopup getPopupImportEtu() {
        return popupImportEtu;
    }

    public void onImportEtuValueChanged(ValueChangeEvent valueChangeEvent) {
        // Add event code here...
    }

    public void OnImportEtuValideAction(ActionEvent actionEvent) {
        // Add event code here...
        UploadedFile file = uploadEtuFile;

        try {
            //Check if file is XLSX
            if (file.getContentType()
                .equalsIgnoreCase("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet") ||
                file.getContentType().equalsIgnoreCase("application/xlsx")) {
                System.out.println("File type : " + file.getContentType());
                readNProcessEtuExcelx(file.getInputStream()); //for xlsx
            }
            //Check if file is XLS
            else if (file.getContentType().equalsIgnoreCase("application/vnd.ms-excel")) {
                if (file.getFilename()
                        .toUpperCase()
                        .endsWith(".XLS")) {
                    System.out.println("File type : " + file.getContentType());
                    //readNProcessExcel(file.getInputStream()); //for xls
                }

            } else {
                FacesMessage msg = new FacesMessage("File format not supported.-- Upload XLS or XLSX file");
                msg.setSeverity(FacesMessage.SEVERITY_WARN);
                FacesContext.getCurrentInstance().addMessage(null, msg);
            }
            file.getInputStream().close();
            AdfFacesContext.getCurrentInstance().addPartialTarget(getMaqpage());

        } catch (IOException e) {
            // TODO
        }
        // finally{
        this.getPopupImport().hide();
        this.getPopupImport().clearInitialState();
        AdfFacesContext.getCurrentInstance().addPartialTarget(getPanimport());
        //  }
    }

    public void setUploadEtuFile(UploadedFile uploadEtuFile) {
        this.uploadEtuFile = uploadEtuFile;
    }

    public UploadedFile getUploadEtuFile() {
        return uploadEtuFile;
    }

    public void setAnnee(Integer annee) {
        this.annee = annee;
    }

    public Integer getAnnee() {
        return annee;
    }

    public void setParcours(Integer parcours) {
        this.parcours = parcours;
    }

    public Integer getParcours() {
        return parcours;
    }

    public void setSemestre(Integer semestre) {
        this.semestre = semestre;
    }

    public Integer getSemestre() {
        return semestre;
    }

    public void setPanimport(RichPanelGroupLayout panimport) {
        this.panimport = panimport;
    }

    public RichPanelGroupLayout getPanimport() {
        return panimport;
    }

    public void setPopupFilUeExist(RichPopup popupFilUeExist) {
        this.popupFilUeExist = popupFilUeExist;
    }

    public RichPopup getPopupFilUeExist() {
        return popupFilUeExist;
    }

    public void setPopupFilEcExist(RichPopup popupFilEcExist) {
        this.popupFilEcExist = popupFilEcExist;
    }

    public RichPopup getPopupFilEcExist() {
        return popupFilEcExist;
    }

    public void setPopupNivFormMaqAnMaquetteExist(RichPopup popupNivFormMaqAnMaquetteExist) {
        this.popupNivFormMaqAnMaquetteExist = popupNivFormMaqAnMaquetteExist;
    }

    public RichPopup getPopupNivFormMaqAnMaquetteExist() {
        return popupNivFormMaqAnMaquetteExist;
    }

    public void setPopupParcMaqAnMaquetteExist(RichPopup popupParcMaqAnMaquetteExist) {
        this.popupParcMaqAnMaquetteExist = popupParcMaqAnMaquetteExist;
    }

    public RichPopup getPopupParcMaqAnMaquetteExist() {
        return popupParcMaqAnMaquetteExist;
    }

    public void setPopupFilUeMaquetteExist(RichPopup popupFilUeMaquetteExist) {
        this.popupFilUeMaquetteExist = popupFilUeMaquetteExist;
    }

    public RichPopup getPopupFilUeMaquetteExist() {
        return popupFilUeMaquetteExist;
    }


    public void setPopupValideFilUeExist(RichPopup popupValideFilUeExist) {
        this.popupValideFilUeExist = popupValideFilUeExist;
    }

    public RichPopup getPopupValideFilUeExist() {
        return popupValideFilUeExist;
    }

    public void setPopupResFilUeExist(RichPopup popupResFilUeExist) {
        this.popupResFilUeExist = popupResFilUeExist;
    }

    public RichPopup getPopupResFilUeExist() {
        return popupResFilUeExist;
    }

    public void setPopupInsPedFilUeExist(RichPopup popupInsPedFilUeExist) {
        this.popupInsPedFilUeExist = popupInsPedFilUeExist;
    }

    public RichPopup getPopupInsPedFilUeExist() {
        return popupInsPedFilUeExist;
    }

    public void setPopupFilEcFilUeExist(RichPopup popupFilEcFilUeExist) {
        this.popupFilEcFilUeExist = popupFilEcFilUeExist;
    }

    public RichPopup getPopupFilEcFilUeExist() {
        return popupFilEcFilUeExist;
    }

    public void setPopupValideFilEcExist(RichPopup popupValideFilEcExist) {
        this.popupValideFilEcExist = popupValideFilEcExist;
    }

    public RichPopup getPopupValideFilEcExist() {
        return popupValideFilEcExist;
    }

    public void setPopupResFilEcExist(RichPopup popupResFilEcExist) {
        this.popupResFilEcExist = popupResFilEcExist;
    }

    public RichPopup getPopupResFilEcExist() {
        return popupResFilEcExist;
    }

    public void setPopupModeCntrlFilEcExist(RichPopup popupModeCntrlFilEcExist) {
        this.popupModeCntrlFilEcExist = popupModeCntrlFilEcExist;
    }

    public RichPopup getPopupModeCntrlFilEcExist() {
        return popupModeCntrlFilEcExist;
    }

    public void setPopupAccessFilUeExist(RichPopup popupAccessFilUeExist) {
        this.popupAccessFilUeExist = popupAccessFilUeExist;
    }

    public RichPopup getPopupAccessFilUeExist() {
        return popupAccessFilUeExist;
    }

    public void setPopupAccessFilEcExist(RichPopup popupAccessFilEcExist) {
        this.popupAccessFilEcExist = popupAccessFilEcExist;
    }

    public RichPopup getPopupAccessFilEcExist() {
        return popupAccessFilEcExist;
    }

    @SuppressWarnings("unchecked")
    public void OnSaveParcoursMaqAnn(ActionEvent actionEvent) {
        // Add event code here...
        BindingContainer bindings = getBindings();
        //get current row and save its rowKey in view scope for later use
        AttributeBinding an_id = (AttributeBinding) bindings.getControlBinding("IdAnneesUnivers3");
        AttributeBinding mq_id = (AttributeBinding) bindings.getControlBinding("IdMaquette5");
        DCIteratorBinding dciterP = (DCIteratorBinding) bindings.get("NivFormParcoursROIterator");
        Row currentP = dciterP.getCurrentRow();
        try {
            OperationBinding prcrsSelected = bindings.getOperationBinding("getSelectedParcours");
            @SuppressWarnings("unchecked")
            ArrayList<Long> prcrs = (ArrayList<Long>) prcrsSelected.execute();
            System.out.println("Parcours selected count : " + prcrs.size());
            if (prcrs.size() != 0) {
                for (int prcrcounter = 0; prcrcounter < prcrs.size(); prcrcounter++) {
                    OperationBinding isMaquetteParcoursExist = bindings.getOperationBinding("isMaquetteParcoursExist");
                    isMaquetteParcoursExist.getParamsMap().put("id_an", Integer.parseInt(an_id.toString()));
                    //isMaquetteParcoursExist.getParamsMap().put("id_mq", Integer.parseInt(mq_id.toString()));
                    isMaquetteParcoursExist.getParamsMap().put("id_prcrs", prcrs.get(prcrcounter));
                    Object resul = isMaquetteParcoursExist.execute();
                    DCIteratorBinding iterused =
                        (DCIteratorBinding) BindingContext.getCurrent()
                                                                                   .getCurrentBindingsEntry()
                                                                                   .get("isMaquetteParcoursExistIterator");
                    Row crnt = iterused.getCurrentRow();
                    if (crnt == null) {
                        System.out.println("Anne : " + an_id + " Maquette : " + mq_id + " NiveauParcours : " +
                                           prcrs.get(prcrcounter));
                        OperationBinding createPrcrsMaqAnn = bindings.getOperationBinding("createParcoursMaquetteAnn");
                        createPrcrsMaqAnn.getParamsMap().put("IdAnneesUnivers", Integer.parseInt(an_id.toString()));
                        createPrcrsMaqAnn.getParamsMap().put("IdMaquette", Integer.parseInt(mq_id.toString()));
                        createPrcrsMaqAnn.getParamsMap().put("UtiCree", getUtilisateur());
                        createPrcrsMaqAnn.getParamsMap().put("IdNiveauFormationParcours", prcrs.get(prcrcounter));
                        createPrcrsMaqAnn.execute();
                    } else {
                        System.out.println("Parcours maquette anne existe");
                    }
                }
                OperationBinding operationBinding = bindings.getOperationBinding("Commit");
                Object result = operationBinding.execute();
                OperationBinding maqparcrs = bindings.getOperationBinding("MaquettesParcours");
                maqparcrs.getParamsMap()
                    .put("id_prcrs", Integer.parseInt(currentP.getAttribute("IdNiveauFormationParcours").toString()));
                maqparcrs.execute();
                
                AdfFacesContext.getCurrentInstance().addPartialTarget(this.getMaqPrcrsTable());
            } else {
                System.out.println("No Parcours Selected");
                RichPopup popup = this.getPopupNoParcours();
                RichPopup.PopupHints hints = new RichPopup.PopupHints();
                popup.show(hints);
            }
        } catch (Exception e) {
            System.out.println(e.getMessage());
        }
    }

    public void setPopupNoParcours(RichPopup popupNoParcours) {
        this.popupNoParcours = popupNoParcours;
    }

    public RichPopup getPopupNoParcours() {
        return popupNoParcours;
    }

    @SuppressWarnings("unchecked")
    public void OnParcoursChanged(SelectionEvent selectionEvent) {
        // Add event code here...
        BindingContainer bindings = getBindings();
        
        RichTable _table = (RichTable) selectionEvent.getSource();
        CollectionModel _tableModel = (CollectionModel) _table.getValue();
        JUCtrlHierBinding _adfTableBinding = (JUCtrlHierBinding) _tableModel.getWrappedData();
        DCIteratorBinding _tableIteratorBinding = _adfTableBinding.getDCIteratorBinding();
        Object _selectedRowData = _table.getSelectedRowData();
        JUCtrlHierNodeBinding _nodeBinding = (JUCtrlHierNodeBinding) _selectedRowData;
        Key _rwKey = _nodeBinding.getRowKey();
        _tableIteratorBinding.setCurrentRowWithKey(_rwKey.toStringFormat(true));

        DCIteratorBinding dciterP = (DCIteratorBinding) bindings.get("NivFormParcoursROIterator");
        Row currentP = dciterP.getCurrentRow();
        System.out.println("Parcours Selected : " + currentP.getAttribute("IdNiveauFormationParcours").toString());
        OperationBinding maqparcrs = bindings.getOperationBinding("MaquettesParcours");
        maqparcrs.getParamsMap()
            .put("id_prcrs", Integer.parseInt(currentP.getAttribute("IdNiveauFormationParcours").toString()));
        maqparcrs.execute();
        
        AdfFacesContext.getCurrentInstance().addPartialTarget(this.getMaqPrcrsTable());
    }

    public void setMaqPrcrsTable(RichTable maqPrcrsTable) {
        this.maqPrcrsTable = maqPrcrsTable;
    }

    public RichTable getMaqPrcrsTable() {
        return maqPrcrsTable;
    }

    @SuppressWarnings("unchecked")
    public void OnNivFormationChanged(ValueChangeEvent valueChangeEvent) {
        // Add event code here...
        BindingContainer bindings = getBindings();
        BindingContainer container = BindingContext.getCurrent().getCurrentBindingsEntry();
        valueChangeEvent.getComponent().processUpdates(FacesContext.getCurrentInstance());
        AttributeBinding attrIdBinding = (AttributeBinding) container.getControlBinding("IdNiveauFormationParcours");
        System.out.println("IdNiveauFormationParcours : " +attrIdBinding.getInputValue().toString());
        DCIteratorBinding dciterP = (DCIteratorBinding) bindings.get("NivFormParcoursROIterator");
        Row currentP = dciterP.getCurrentRow();
        System.out.println("Parcours Selected : " + currentP.getAttribute("IdNiveauFormationParcours").toString());
        OperationBinding maqparcrs = bindings.getOperationBinding("MaquettesParcours");
        maqparcrs.getParamsMap()
            .put("id_prcrs", Integer.parseInt(currentP.getAttribute("IdNiveauFormationParcours").toString()));
        maqparcrs.execute();
        AdfFacesContext.getCurrentInstance().addPartialTarget(this.getMaqPrcrsTable());
    }

    public void OnNewNivFormMaqAnnClicked(ActionEvent actionEvent) {
        // Add event code here...
        RichPopup popup = this.getPopupNewNivFormMaqAnn();
        RichPopup.PopupHints hints = new RichPopup.PopupHints();
        popup.show(hints);
    }

    public void setPopupNewNivFormMaqAnn(RichPopup popupNewNivFormMaqAnn) {
        this.popupNewNivFormMaqAnn = popupNewNivFormMaqAnn;
    }

    public RichPopup getPopupNewNivFormMaqAnn() {
        return popupNewNivFormMaqAnn;
    }

    @SuppressWarnings("unchecked")
    public void OnNewNivFormMaqAnnAction(DialogEvent dialogEvent) {
        // Add event code here...
        if (dialogEvent.getOutcome().equals(Outcome.yes)) {
            BindingContainer bindings = getBindings();
            AttributeBinding mq_id = (AttributeBinding) bindings.getControlBinding("IdMaquette1");
            AttributeBinding an_id = (AttributeBinding) bindings.getControlBinding("IdAnneesUnivers3");
            AttributeBinding nf_id = (AttributeBinding) bindings.getControlBinding("IdNiveauFormation2");
            AttributeBinding nfp_id = (AttributeBinding) bindings.getControlBinding("IdNiveauFormationParcours1");

            //AttributeBinding nfp_id = (AttributeBinding) bindings.getControlBinding("IdNiveauFormation3");
            //Integer mq_id = (Integer.parseInt(ueIdBinding.getInputValue().toString()));
            OperationBinding isNivFormMaqAnnExist = bindings.getOperationBinding("isNivFormMaqAnnExist");
            isNivFormMaqAnnExist.getParamsMap().put("mq_id", Integer.parseInt(mq_id.toString()));
            isNivFormMaqAnnExist.getParamsMap().put("an_id", Integer.parseInt(an_id.toString()));
            isNivFormMaqAnnExist.getParamsMap().put("nivform_id", Integer.parseInt(nf_id.toString()));
            isNivFormMaqAnnExist.execute();
            DCIteratorBinding iterFilUe = (DCIteratorBinding) bindings.get("isNivFormMaqAnnExistIterator");
            Row crntnivformaqan = iterFilUe.getCurrentRow();
            if(crntnivformaqan == null){
                OperationBinding createNivFormmaqAn = bindings.getOperationBinding("createNivFormMaqAnn");
                createNivFormmaqAn.getParamsMap().put("IdMaquette", Integer.parseInt(mq_id.toString()));
                createNivFormmaqAn.getParamsMap().put("IdAnneesUnivers", Integer.parseInt(an_id.toString()));
                createNivFormmaqAn.getParamsMap().put("IdNiveauFormation", Integer.parseInt(nf_id.toString()));
                createNivFormmaqAn.getParamsMap().put("UtiCree", getUtilisateur());
                createNivFormmaqAn.execute();
            }else{
                RichPopup popup = this.getPopupNivFormMaqAnnExist();
                RichPopup.PopupHints hints = new RichPopup.PopupHints();
                popup.show(hints);
            }
            OperationBinding operationBinding = bindings.getOperationBinding("Commit");
            Object result = operationBinding.execute();
            System.out.println("Parcours Selected : " + nfp_id.toString());
            OperationBinding maqparcrs = bindings.getOperationBinding("MaquettesParcours");
            maqparcrs.getParamsMap()
                .put("id_prcrs", Integer.parseInt(nfp_id.toString()));
            maqparcrs.execute();
            AdfFacesContext.getCurrentInstance().addPartialTarget(this.getMaqPrcrsTable());
        }

        AdfFacesContext.getCurrentInstance().addPartialTarget(this.getMaqNivPan());
    }

    public void setPopupNivFormMaqAnnExist(RichPopup popupNivFormMaqAnnExist) {
        this.popupNivFormMaqAnnExist = popupNivFormMaqAnnExist;
    }

    public RichPopup getPopupNivFormMaqAnnExist() {
        return popupNivFormMaqAnnExist;
    }

    public void setMaqNivPan(RichPanelHeader maqNivPan) {
        this.maqNivPan = maqNivPan;
    }

    public RichPanelHeader getMaqNivPan() {
        return maqNivPan;
    }
}
